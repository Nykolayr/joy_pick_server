# API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Joy Pick

## –ë–∞–∑–æ–≤—ã–π URL

```
https://danilagames.ru/api
```

**–ò–ª–∏ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
```
http://localhost:3000/api
```

## –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–í—Å–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization`:

```
Authorization: Bearer <jwt_token>
```

### –°–ø–æ—Å–æ–±—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:

1. **Email/Password** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ email –∏ –ø–∞—Ä–æ–ª—å
   - `POST /api/auth/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
   - `POST /api/auth/login` - –≤—Ö–æ–¥

2. **Firebase (Google, Apple, GitHub, Phone)** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Firebase
   - `POST /api/auth/firebase` - –æ–±–º–µ–Ω Firebase —Ç–æ–∫–µ–Ω–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω—ã–π JWT

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Firebase –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å Firebase ID Token –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ JWT —Ç–æ–∫–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Email –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

–î–ª—è —Ä–∞–±–æ—Ç—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ email –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É email. –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–º. –≤ —Ä–∞–∑–¥–µ–ª–µ [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Email](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-email) –Ω–∏–∂–µ.

---

## ‚è∞ –§–æ—Ä–º–∞—Ç –¥–∞—Ç –∏ –≤—Ä–µ–º–µ–Ω–∏

**–í–∞–∂–Ω–æ:** –í—Å–µ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º—è –≤ API –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ **UTC (Coordinated Universal Time)** –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ **ISO 8601**.

### –§–æ—Ä–º–∞—Ç –¥–∞—Ç

–í—Å–µ –ø–æ–ª—è —Å –¥–∞—Ç–∞–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–µ–º –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º —Ñ–æ—Ä–º–∞—Ç–µ:
```
YYYY-MM-DDTHH:mm:ss.sssZ
```

**–ü—Ä–∏–º–µ—Ä—ã:**
- `2025-12-01T15:54:00.000Z` - 1 –¥–µ–∫–∞–±—Ä—è 2025 –≥–æ–¥–∞, 15:54:00 UTC
- `2025-12-01T22:54:00.000Z` - 1 –¥–µ–∫–∞–±—Ä—è 2025 –≥–æ–¥–∞, 22:54:00 UTC

### –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä

–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—Ç –∂–µ —Ñ–æ—Ä–º–∞—Ç ISO 8601 –≤ UTC:
```json
{
  "start_date": "2025-12-01T15:54:00.000Z",
  "end_date": "2025-12-01T17:54:00.000Z"
}
```

**–í–∞–∂–Ω–æ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞:**
- –í—Å–µ –¥–∞—Ç—ã, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞, —É–∂–µ –≤ UTC - –Ω–µ –Ω—É–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å
- –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –≤ UTC –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- –°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –≤—Å–µ –¥–∞—Ç—ã –≤ UTC –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –¥–∞–Ω–Ω—ã—Ö

### –ü–æ–ª—è —Å –¥–∞—Ç–∞–º–∏ –≤ –º–æ–¥–µ–ª—è—Ö

–°–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è –≤–æ –≤—Å–µ—Ö –º–æ–¥–µ–ª—è—Ö —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–∞—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ UTC:
- `created_at` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è
- `updated_at` - –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `start_date` - –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ (–¥–ª—è –∑–∞—è–≤–æ–∫)
- `end_date` - –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è (–¥–ª—è –∑–∞—è–≤–æ–∫)
- `join_date` - –¥–∞—Ç–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–¥–ª—è –∑–∞—è–≤–æ–∫)
- `created_time` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è (–¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- `executed_at` - –¥–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–¥–ª—è cron –¥–µ–π—Å—Ç–≤–∏–π)
- `scheduled_at` - –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∞—Ç–∞ (–¥–ª—è cron –¥–µ–π—Å—Ç–≤–∏–π)

---

## üí∞ –§–æ—Ä–º–∞—Ç –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—É–º–º (–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!)

**–í–ê–ñ–ù–û:** –í—Å–µ –¥–µ–Ω–µ–∂–Ω—ã–µ —Å—É–º–º—ã –≤ API —Ä–∞–±–æ—Ç–∞—é—Ç –û–î–ò–ù–ê–ö–û–í–û - –≤—Å–µ–≥–¥–∞ –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö (decimal/float)!

### –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã —Å —Å—É–º–º–∞–º–∏:

1. **–í—Å–µ —Å—É–º–º—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö:**
   - `amount` (–¥–ª—è –¥–æ–Ω–∞—Ç–æ–≤) - –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö (decimal/float). –ü—Ä–∏–º–µ—Ä—ã: `2.50`, `10.00`, `1.25`
   - `total_contributed` - –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö (decimal/float) - —Å—É–º–º–∞ –≤—Å–µ—Ö –¥–æ–Ω–∞—Ç–æ–≤
   - `target_amount` - –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö (decimal/float)
   
   **–í–ê–ñ–ù–û:** –ü–æ–ª–µ `cost` —É–¥–∞–ª–µ–Ω–æ. –¢–µ–ø–µ—Ä—å –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –∏–¥—É—Ç —á–µ—Ä–µ–∑ –¥–æ–Ω–∞—Ç—ã, –≤–∫–ª—é—á–∞—è –ø–ª–∞—Ç–µ–∂ —Å–æ–∑–¥–∞—Ç–µ–ª—è.

2. **–í –ë–î —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:**
   - –í—Å–µ —Å—É–º–º—ã –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ `decimal(10,2)`
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥—Ä–æ–±–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, $2.50)

3. **–í–Ω—É—Ç—Ä–∏ –±—ç–∫–µ–Ω–¥–∞:**
   - –ë—ç–∫–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –¥–æ–ª–ª–∞—Ä—ã –≤ —Ü–µ–Ω—Ç—ã –¥–ª—è Stripe API
   - Stripe —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ü–µ–Ω—Ç–∞–º–∏, –Ω–æ —ç—Ç–æ —Å–∫—Ä—ã—Ç–æ –æ—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

4. **–ú–∏–Ω–∏–º—É–º:**
   - –ú–∏–Ω–∏–º—É–º 0.50 –¥–æ–ª–ª–∞—Ä–∞ (50 —Ü–µ–Ω—Ç–æ–≤) - —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ Stripe

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

**–°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–Ω–∞—Ç–∞ (–≤–∫–ª—é—á–∞—è –¥–æ–Ω–∞—Ç –æ—Ç —Å–æ–∑–¥–∞—Ç–µ–ª—è):**
```json
{
  "amount": 1.25
}
```
‚Üí –ë—ç–∫–µ–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ —Ü–µ–Ω—Ç—ã (125) –¥–ª—è Stripe, –≤ –ë–î —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è `1.25`

**–ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏:**
```json
{
  "total_contributed": 5.75
}
```
‚Üí –í—Å–µ —Å—É–º–º—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö

**–í–ê–ñ–ù–û:** –ü–æ–ª–µ `cost` —É–¥–∞–ª–µ–Ω–æ. –¢–µ–ø–µ—Ä—å –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –∏–¥—É—Ç —á–µ—Ä–µ–∑ –¥–æ–Ω–∞—Ç—ã. –°–æ–∑–¥–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –¥–æ–Ω–∞—Ç —Å–≤–æ–µ–π –∑–∞—è–≤–∫–µ —á–µ—Ä–µ–∑ `POST /api/donations` —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ –∏–ª–∏ –ø–æ–∑–∂–µ.

---

## üìã –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### ‚ö†Ô∏è –í–∞–∂–Ω–æ: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–í—Å–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ API –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å UUID –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** (–ø–æ–ª–µ `id` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `users`), –∞ –Ω–µ Firebase UID.

- **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:** UUID —Ñ–æ—Ä–º–∞—Ç–∞ `xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx` (36 —Å–∏–º–≤–æ–ª–æ–≤ —Å –¥–µ—Ñ–∏—Å–∞–º–∏)
- **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:** Firebase UID (–Ω–∞–ø—Ä–∏–º–µ—Ä, `M9HmfMMAMRejNc40GyMAoUT8Bk02`)
- **–ì–¥–µ —ç—Ç–æ –≤–∞–∂–Ω–æ:** `joined_user_id`, `created_by`, `taken_by`, —ç–ª–µ–º–µ–Ω—Ç—ã –≤ `actual_participants`, —ç–ª–µ–º–µ–Ω—Ç—ã –≤ `registered_participants`

–°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç UUID –∏ –≤–µ—Ä–Ω–µ—Ç –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω Firebase UID –∏–ª–∏ –¥—Ä—É–≥–æ–π –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç.

---

### –ú–æ–¥–µ–ª—å User (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

**–í–∞–∂–Ω–æ:** –í—Å–µ –ø–æ–ª—è –≤ API –∏—Å–ø–æ–ª—å–∑—É—é—Ç **snake_case** (–∫–∞–∫ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö). –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `snake_case` —Ñ–æ—Ä–º–∞—Ç.

#### –ü–æ–ª—è –º–æ–¥–µ–ª–∏:

| –ü–æ–ª–µ (snake_case) | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------------|-----|--------------|----------|
| `id` | string (UUID) | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `email` | string | –î–∞ (–ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏) | Email –∞–¥—Ä–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `password` | string | –î–∞ (–ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏) | –ü–∞—Ä–æ–ª—å (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è) |
| `display_name` | string | –ù–µ—Ç | –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `first_name` | string | –ù–µ—Ç | –ò–º—è |
| `second_name` | string | –ù–µ—Ç | –§–∞–º–∏–ª–∏—è |
| `phone_number` | string | –ù–µ—Ç | –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ |
| `city` | string | –ù–µ—Ç | –ì–æ—Ä–æ–¥ |
| `country` | string | –ù–µ—Ç | –°—Ç—Ä–∞–Ω–∞ |
| `gender` | string | –ù–µ—Ç | –ü–æ–ª (male/female/other) |
| `photo_url` | string | –ù–µ—Ç | URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è |
| `latitude` | float | –ù–µ—Ç | –®–∏—Ä–æ—Ç–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è |
| `longitude` | float | –ù–µ—Ç | –î–æ–ª–≥–æ—Ç–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è |
| `fcm_token` | string | –ù–µ—Ç | FCM —Ç–æ–∫–µ–Ω –¥–ª—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π |
| `uid` | string | –ù–µ—Ç | Firebase UID (–¥–ª—è Firebase –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏) |
| `auth_type` | string | –ù–µ—Ç | –¢–∏–ø –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (email/google/apple/github/phone) |
| `email_verified` | boolean | –ù–µ—Ç | –°—Ç–∞—Ç—É—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ email (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `count_performed` | integer | –ù–µ—Ç | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `count_orders` | integer | –ù–µ—Ç | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `jcoins` | integer | –ù–µ—Ç | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ Joycoins (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç) |
| `coins_from_created` | integer | –ù–µ—Ç | –ú–æ–Ω–µ—Ç—ã –∑–∞ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `coins_from_participation` | integer | –ù–µ—Ç | –ú–æ–Ω–µ—Ç—ã –∑–∞ —É—á–∞—Å—Ç–∏–µ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `stripe_id` | string | –ù–µ—Ç | Stripe ID (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `score` | integer | –ù–µ—Ç | –†–µ–π—Ç–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `admin` | boolean | –ù–µ—Ç | –°—Ç–∞—Ç—É—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `created_time` | datetime | –ù–µ—Ç | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |

#### –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–π –º–æ–¥–µ–ª–∏ User (–æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞):

```json
{
  "id": "353f958d-8796-44c7-a877-3e376eca6784",
  "email": "user@example.com",
  "display_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "first_name": "–ò–≤–∞–Ω",
  "second_name": "–ò–≤–∞–Ω–æ–≤",
  "phone_number": "+1234567890",
  "city": "–ú–æ—Å–∫–≤–∞",
  "country": "–†–æ—Å—Å–∏—è",
  "gender": "male",
  "photo_url": "https://danilagames.ru/uploads/avatars/uuid.jpg",
  "latitude": 55.7558,
  "longitude": 37.6173,
  "fcm_token": "cqMv5gx6SKWXpMxFdRX8_3:APA91b...",
  "uid": "firebase_uid_here",
  "auth_type": "google",
  "email_verified": true,
  "count_performed": 5,
  "count_orders": 10,
  "jcoins": 150,
  "coins_from_created": 50,
  "coins_from_participation": 100,
  "stripe_id": null,
  "score": 85,
  "admin": false,
  "created_time": "2024-01-01T00:00:00.000Z"
}
```

---

### –ú–æ–¥–µ–ª—å Request (–ó–∞—è–≤–∫–∞)

**–í–∞–∂–Ω–æ:** –í—Å–µ –ø–æ–ª—è –≤ API –∏—Å–ø–æ–ª—å–∑—É—é—Ç **snake_case** (–∫–∞–∫ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö). –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `snake_case` —Ñ–æ—Ä–º–∞—Ç.

#### –ü–æ–ª—è –º–æ–¥–µ–ª–∏:

| –ü–æ–ª–µ (snake_case) | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------------|-----|--------------|----------|
| `id` | string (UUID) | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞—è–≤–∫–∏ |
| `user_id` | string | –ù–µ—Ç (–∏–∑ —Ç–æ–∫–µ–Ω–∞) | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ —Ç–æ–∫–µ–Ω–∞) |
| `category` | string | –î–∞ | –¢–∏–ø –∑–∞—è–≤–∫–∏: `wasteLocation`, `speedCleanup`, `event` |
| `name` | string | –î–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏ |
| `description` | string | –ù–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏ |
| `latitude` | float | –ù–µ—Ç | –®–∏—Ä–æ—Ç–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è |
| `longitude` | float | –ù–µ—Ç | –î–æ–ª–≥–æ—Ç–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è |
| `city` | string | –ù–µ—Ç | –ì–æ—Ä–æ–¥ |
| `photos_before` | array[string] | –ù–µ—Ç | –ú–∞—Å—Å–∏–≤ URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π "–¥–æ" —É–±–æ—Ä–∫–∏ (–¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∑–∞—è–≤–æ–∫) |
| `photos_after` | array[string] | –ù–µ—Ç | –ú–∞—Å—Å–∏–≤ URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π "–ø–æ—Å–ª–µ" —É–±–æ—Ä–∫–∏ (–¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –∑–∞—è–≤–æ–∫) |
| `garbage_size` | integer | –ù–µ—Ç | –†–∞–∑–º–µ—Ä –º—É—Å–æ—Ä–∞: `1` (bag), `2` (cart), `3` (car) |
| `waste_types` | array[string] | –ù–µ—Ç | –ú–∞—Å—Å–∏–≤ –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–∏–ø–æ–≤ –æ—Ç—Ö–æ–¥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `["plastic", "glass"]`) |
| `only_foot` | boolean | –ù–µ—Ç | –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –ø–µ—à–∫–æ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `false`) |
| `possible_by_car` | boolean | –ù–µ—Ç | –î–æ—Å—Ç—É–ø –Ω–∞ –º–∞—à–∏–Ω–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `false`) |
| ~~`cost`~~ | ~~integer~~ | ~~–ù–µ—Ç~~ | ~~–£–î–ê–õ–ï–ù–û: –¢–µ–ø–µ—Ä—å –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ –¥–æ–Ω–∞—Ç—ã~~ |
| `reward_amount` | integer | –ù–µ—Ç | –ù–∞–≥—Ä–∞–¥–∞ –≤ Joycoin (–¥–ª—è Speed Clean-up) |
| `start_date` | datetime | **–î–∞ (–¥–ª—è speedCleanup)** | –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è `speedCleanup`**, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è `event` |
| `end_date` | datetime | **–î–∞ (–¥–ª—è speedCleanup)** | –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è `speedCleanup`**, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è `event` |
| `status` | string | –ù–µ—Ç | –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏. **–í–∞–∂–Ω–æ:** –°—Ç–∞—Ç—É—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ –∑–∞—è–≤–∫–∏:<br>- `wasteLocation`: `new` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)<br>- `speedCleanup`: `new` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏–ª–∏ `inProgress` (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–æ —è–≤–Ω–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏)<br>- `event`: `inProgress` (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏)<br><br>**–í–æ–∑–º–æ–∂–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã:**<br>- `new` - —Å–æ–∑–¥–∞–Ω–∞, –æ–∂–∏–¥–∞–µ—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è<br>- `inProgress` - –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è<br>- `pending` - –æ–∂–∏–¥–∞–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º<br>- `approved` - –æ–¥–æ–±—Ä–µ–Ω–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º<br>- `rejected` - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º<br>- `completed` - –∑–∞–≤–µ—Ä—à–µ–Ω–∞<br>- `archived` - –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ –≤—Ä—É—á–Ω—É—é)<br><br>**–õ–æ–≥–∏–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤:**<br>- –î–ª—è `wasteLocation`: –ø—Ä–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è —Å—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `inProgress`<br>- –î–ª—è `speedCleanup`: –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ (`approved`) –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `start_date` –∏ `end_date`. –ï—Å–ª–∏ >= 20 –º–∏–Ω—É—Ç, –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è –∫–æ–∏–Ω —Å–æ–∑–¥–∞—Ç–µ–ª—é. –ß–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –∑–∞—è–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –≤ `completed`<br>- –î–ª—è `event`: –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å —Å—Ä–∞–∑—É `inProgress`, —Å–æ–∑–¥–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —É—á–∞—Å—Ç–Ω–∏–∫–∏<br><br>**–í–ê–ñ–ù–û:** –°—Ç–∞—Ç—É—Å `pending_payment` —É–¥–∞–ª–µ–Ω. –¢–µ–ø–µ—Ä—å –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –∏–¥—É—Ç —á–µ—Ä–µ–∑ –¥–æ–Ω–∞—Ç—ã, –∑–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º —Å—Ç–∞—Ç—É—Å–æ–º |
| `priority` | string | –ù–µ—Ç | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: `low`, `medium`, `high`, `urgent` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `medium`) |
| `target_amount` | integer | –ù–µ—Ç | –¶–µ–ª–µ–≤–∞—è —Å—É–º–º–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞—è–≤–∫–∏ |
| `plant_tree` | boolean | –ù–µ—Ç | –§–ª–∞–≥ "–ø–æ—Å–∞–¥–∏—Ç—å –¥–µ—Ä–µ–≤–æ" (–¥–ª—è Event, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `false`) |
| `trash_pickup_only` | boolean | –ù–µ—Ç | –§–ª–∞–≥ "—Ç–æ–ª—å–∫–æ –≤—ã–≤–æ–∑ –º—É—Å–æ—Ä–∞" (–¥–ª—è Waste Location, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `false`) |
| `rejection_reason` | string | –ù–µ—Ç | –ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∑–∞—è–≤–∫–∏ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –∏–ª–∏ –∫–∞—Å—Ç–æ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `rejection_message` | string | –ù–µ—Ç | –ö–∞—Å—Ç–æ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤) |
| `actual_participants` | array[string] | –ù–µ—Ç | –ú–∞—Å—Å–∏–≤ ID —Ä–µ–∞–ª—å–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è `event`, –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–∫–∞–∑—á–∏–∫–æ–º –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–æ–±—ã—Ç–∏—è). **–í–∞–∂–Ω–æ:** –í—Å–µ ID –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å UUID –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ª–µ `id` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `users`), –Ω–µ Firebase UID. |
| `registered_participants` | array[string] | –ù–µ—Ç | –ú–∞—Å—Å–∏–≤ ID –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è `event`, –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —É—á–∞—Å—Ç–∏–∏). **–í–∞–∂–Ω–æ:** –í—Å–µ ID –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å UUID –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ª–µ `id` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `users`), –Ω–µ Firebase UID. |
| `is_open` | boolean | –ù–µ—Ç | –û—Ç–∫—Ä—ã—Ç–∞ –ª–∏ –∑–∞—è–≤–∫–∞ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `true`) |
| `created_by` | string | –ù–µ—Ç | ID —Å–æ–∑–¥–∞—Ç–µ–ª—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ). **–í–∞–∂–Ω–æ:** UUID –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ª–µ `id` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `users`), –Ω–µ Firebase UID. |
| `taken_by` | string | –ù–µ—Ç | ID –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ). **–í–∞–∂–Ω–æ:** UUID –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ª–µ `id` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `users`), –Ω–µ Firebase UID. |
| `total_contributed` | integer | –ù–µ—Ç | –û–±—â–∞—è —Å—É–º–º–∞ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ, –∏–∑ —Ç–∞–±–ª–∏—Ü—ã donations) |
| `joined_user_id` | string | –ù–µ—Ç | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–≤—à–µ–≥–æ—Å—è –∫ –∑–∞—è–≤–∫–µ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ). **–í–∞–∂–Ω–æ:** UUID –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ª–µ `id` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `users`), –Ω–µ Firebase UID. –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞—è–≤–∫–∏ –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `null` –¥–ª—è –æ—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. |
| `join_date` | datetime | –ù–µ—Ç | –î–∞—Ç–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `expires_at` | datetime | –ù–µ—Ç | –î–∞—Ç–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è –∑–∞—è–≤–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è `wasteLocation`, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏: `created_at + 7 –¥–Ω–µ–π`, —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `extended_count` | integer | –ù–µ—Ç | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–ª–µ–Ω–∏–π –∑–∞—è–≤–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è `wasteLocation`, –º–∞–∫—Å–∏–º—É–º 1, —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `completion_comment` | string | –ù–µ—Ç | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `participant_completions` | object | –ù–µ—Ç | JSON –æ–±—ä–µ–∫—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–∞–∫—Ä—ã—Ç–∏—è —Ä–∞–±–æ—Ç—ã —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è `wasteLocation` –∏ `event`, —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ). –ö–ª—é—á - `userId` (UUID), –∑–Ω–∞—á–µ–Ω–∏–µ - –æ–±—ä–µ–∫—Ç —Å –ø–æ–ª—è–º–∏:<br>- `status`: `"inProgress"` | `"pending"` | `"rejected"` | `"approved"`<br>- `photos_after`: array[string] - –º–∞—Å—Å–∏–≤ URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π "–ø–æ—Å–ª–µ" —Ä–∞–±–æ—Ç—ã<br>- `completion_comment`: string - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É—á–∞—Å—Ç–Ω–∏–∫–∞<br>- `completion_latitude`: number - —à–∏—Ä–æ—Ç–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏<br>- `completion_longitude`: number - –¥–æ–ª–≥–æ—Ç–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏<br>- `rejection_reason`: string - –ø—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–∞–∑–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è `rejected`)<br>- `completed_at`: datetime - –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è —Ä–∞–±–æ—Ç—ã |
| `group_chat_id` | string (UUID) | –ù–µ—Ç | ID –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞ –∑–∞—è–≤–∫–∏ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏, —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ). –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏, –≤ –Ω–µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç–µ–ª—å. |
| `private_chats` | array[object] | –ù–µ—Ç | –ú–∞—Å—Å–∏–≤ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —á–∞—Ç–æ–≤ –¥–ª—è event –∑–∞—è–≤–æ–∫ (—Ç–æ–ª—å–∫–æ –¥–ª—è `event`, —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ). –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:<br>- `chat_id`: string (UUID) - ID –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ —á–∞—Ç–∞<br>- `user_id`: string (UUID) - ID —É—á–∞—Å—Ç–Ω–∏–∫–∞, —Å –∫–æ—Ç–æ—Ä—ã–º —Å–æ–∑–¥–∞–Ω –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç (–º–µ–∂–¥—É —É—á–∞—Å—Ç–Ω–∏–∫–æ–º –∏ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º –∑–∞—è–≤–∫–∏)<br><br>**–í–∞–∂–Ω–æ:** –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ —á–∞—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —É—á–∞—Å—Ç–∏–∏ –≤ event –∑–∞—è–≤–∫–µ (POST /api/requests/:id/participate) –∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ —É—á–∞—Å—Ç–∏—è (DELETE /api/requests/:id/participate). |
| `created_at` | datetime | –ù–µ—Ç | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `updated_at` | datetime | –ù–µ—Ç | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |

#### –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–π –º–æ–¥–µ–ª–∏ Request (–æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞):

```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "user_id": "353f958d-8796-44c7-a877-3e376eca6784",
  "category": "wasteLocation",
  "name": "–ú—É—Å–æ—Ä –≤ –ø–∞—Ä–∫–µ",
  "description": "–ë–æ–ª—å—à–∞—è –∫—É—á–∞ –º—É—Å–æ—Ä–∞ –≤–æ–∑–ª–µ –≤—Ö–æ–¥–∞ –≤ –ø–∞—Ä–∫",
  "latitude": 55.7558,
  "longitude": 37.6173,
  "city": "–ú–æ—Å–∫–≤–∞",
  "photos_before": [
    "https://danilagames.ru/uploads/photos/uuid1.jpg",
    "https://danilagames.ru/uploads/photos/uuid2.jpg"
  ],
  "photos_after": [],
  "garbage_size": 2,
  "waste_types": ["plastic", "paper"],
  "only_foot": false,
  "possible_by_car": true,
  "cost": 500,
  "reward_amount": null,
  "start_date": null,
  "end_date": null,
  "status": "pending",
  "priority": "medium",
  "target_amount": null,
  "plant_tree": false,
  "trash_pickup_only": false,
  "is_open": true,
  "created_by": "353f958d-8796-44c7-a877-3e376eca6784",
  "taken_by": null,
  "total_contributed": 0,
  "registered_participants": [],
  "actual_participants": [],
  "joined_user_id": null,
  "join_date": null,
  "completion_comment": null,
  "participant_completions": {},
  "created_at": "2024-01-01T00:00:00.000Z",
  "updated_at": "2024-01-01T00:00:00.000Z"
}
```

---

### –ú–æ–¥–µ–ª—å Partner (–ü–∞—Ä—Ç–Ω–µ—Ä)

**–í–∞–∂–Ω–æ:** –í—Å–µ –ø–æ–ª—è –≤ API –∏—Å–ø–æ–ª—å–∑—É—é—Ç **snake_case** (–∫–∞–∫ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö). –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `snake_case` —Ñ–æ—Ä–º–∞—Ç.

#### –ü–æ–ª—è –º–æ–¥–µ–ª–∏:

| –ü–æ–ª–µ (snake_case) | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------------|-----|--------------|----------|
| `id` | string (UUID) | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–∞—Ä—Ç–Ω–µ—Ä–∞ |
| `name` | string | –î–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ |
| `photo_urls` | array[string] | –ù–µ—Ç | –ú–∞—Å—Å–∏–≤ URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –ø–∞—Ä—Ç–Ω–µ—Ä–∞ (JSON) |
| `latitude` | float | –ù–µ—Ç | –®–∏—Ä–æ—Ç–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è |
| `longitude` | float | –ù–µ—Ç | –î–æ–ª–≥–æ—Ç–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è |
| `address` | string | –ù–µ—Ç | –ê–¥—Ä–µ—Å –ø–∞—Ä—Ç–Ω–µ—Ä–∞ |
| `activity` | string | –ù–µ—Ç | –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä–∞ |
| `website_url` | string (URL) | –ù–µ—Ç | URL —Å–∞–π—Ç–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ |
| `created_at` | datetime | –ù–µ—Ç | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |
| `updated_at` | datetime | –ù–µ—Ç | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ) |

#### –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–π –º–æ–¥–µ–ª–∏ Partner (–æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞):

```json
{
  "id": "660e8400-e29b-41d4-a716-446655440000",
  "name": "–≠–∫–æ-–ú–∞–≥–∞–∑–∏–Ω",
  "photo_urls": ["https://danilagames.ru/uploads/photos/uuid1.jpg"],
  "latitude": 55.7558,
  "longitude": 37.6173,
  "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è, –¥. 1",
  "activity": "–ü—Ä–æ–¥–∞–∂–∞ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤",
  "website_url": "https://ecoshop.ru",
  "created_at": "2024-01-01T00:00:00.000Z",
  "updated_at": "2024-01-01T00:00:00.000Z"
}
```

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

**POST** `/auth/register`

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ email. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ `/auth/verify-email`.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "email": "user@example.com",
  "password": "password123",
  "display_name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
  "first_name": "–ò–º—è",
  "second_name": "–§–∞–º–∏–ª–∏—è",
  "phone_number": "+1234567890",
  "city": "–ú–æ—Å–∫–≤–∞",
  "country": "–†–æ—Å—Å–∏—è",
  "gender": "male"
}
```

**–û—Ç–≤–µ—Ç (200) - —É—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞:**
```json
{
  "success": true,
  "message": "–ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ email",
  "data": {
    "message": "–ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ email",
    "email": "user@example.com",
    "verificationExpiresAt": "2024-01-01T00:10:00.000Z"
  }
}
```

**–û—Ç–≤–µ—Ç (500) - –æ—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ email:**
```json
{
  "success": false,
  "message": "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ email",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "errorDetails": {
    "emailError": {
      "message": "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Gmail...",
      "code": "EAUTH_GMAIL_PASSWORD",
      "response": "...",
      "details": "..."
    }
  }
}
```

**–í–∞–∂–Ω–æ:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ
- –ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ (6 —Ü–∏—Ñ—Ä) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ email
- –ö–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –≤ —Ç–µ—á–µ–Ω–∏–µ 10 –º–∏–Ω—É—Ç
- –î–∞–Ω–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω–æ –¥–æ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ `/auth/verify-email` —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ç–æ–∫–µ–Ω
- –ï—Å–ª–∏ –∫–æ–¥ –Ω–µ –ø—Ä–∏—à–µ–ª, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `POST /auth/resend-verification` –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Flutter:**
```dart
// –®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –Ω–∞ email
final registerResponse = await http.post(
  Uri.parse('$baseUrl/auth/register'),
  headers: {'Content-Type': 'application/json'},
  body: jsonEncode({
    'email': email,
    'password': password,
    'display_name': displayName,
    'first_name': firstName,
    'second_name': secondName,
  }),
);

if (registerResponse.statusCode == 200) {
  // –ö–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω, –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
  // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∫–æ–¥ –∏–∑ email
  final code = '123456'; // –ö–æ–¥, –≤–≤–µ–¥–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
  
  // –®–∞–≥ 2: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–¥–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  final verifyResponse = await http.post(
    Uri.parse('$baseUrl/auth/verify-email'),
    headers: {'Content-Type': 'application/json'},
    body: jsonEncode({
      'email': email,
      'code': code,
    }),
  );
  
  final verifyData = jsonDecode(verifyResponse.body);
  if (verifyResponse.statusCode == 200) {
    final token = verifyData['data']['token'];
    final user = verifyData['data']['user'];
    // –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  }
}
```

---

### –í—Ö–æ–¥

**POST** `/auth/login`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ",
  "data": {
    "user": {
      "id": "uuid",
      "email": "user@example.com",
      "display_name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
      "photo_url": null,
      "uid": "uuid",
      "phone_number": "+1234567890",
      "city": "–ú–æ—Å–∫–≤–∞",
      "first_name": "–ò–º—è",
      "second_name": "–§–∞–º–∏–ª–∏—è",
      "country": "–†–æ—Å—Å–∏—è",
      "gender": "male",
      "count_performed": 0,
      "count_orders": 0,
      "jcoins": 0,
      "coins_from_created": 0,
      "coins_from_participation": 0,
      "stripe_id": null,
      "score": 0,
      "admin": false,
      "fcm_token": null,
      "auth_type": "email",
      "latitude": null,
      "longitude": null,
      "created_time": "2024-01-01T00:00:00.000Z"
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

**–û—à–∏–±–∫–∞ (401):**
```json
{
  "success": false,
  "message": "–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å"
}
```

---

### –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è email

**POST** `/auth/verify-email`

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ç–æ–∫–µ–Ω –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "email": "user@example.com",
  "code": "123456"
}
```

**–û—Ç–≤–µ—Ç (200) - –¥–ª—è –Ω–æ–≤–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:**
```json
{
  "success": true,
  "message": "Email —É—Å–ø–µ—à–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω.",
  "data": {
    "user": {
      "id": "uuid",
      "email": "user@example.com",
      "display_name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
      "uid": "uuid",
      "email_verified": true,
      "created_time": "2024-01-01T00:00:00.000Z"
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "verified": true
  }
}
```

**–û—Ç–≤–µ—Ç (200) - –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```json
{
  "success": true,
  "message": "Email —É—Å–ø–µ—à–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω",
  "data": {
    "user": {
      "id": "uuid",
      "email": "user@example.com",
      "email_verified": true
    },
    "verified": true
  }
}
```

**–û—à–∏–±–∫–∞ (400):**
```json
{
  "success": false,
  "message": "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏"
}
```

**–û—à–∏–±–∫–∞ (400):**
```json
{
  "success": false,
  "message": "–ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏—Å—Ç–µ–∫. –ó–∞–ø—Ä–æ—Å–∏—Ç–µ –Ω–æ–≤—ã–π –∫–æ–¥."
}
```

---

### –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

**POST** `/auth/resend-verification`

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ email. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ, –µ—Å–ª–∏ –∫–æ–¥ –Ω–µ –ø—Ä–∏—à–µ–ª –∏–ª–∏ –∏—Å—Ç–µ–∫. –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –¥–ª—è –Ω–æ–≤—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π (–∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω), —Ç–∞–∫ –∏ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "email": "user@example.com"
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω",
  "data": {
    "message": "–ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ email",
    "verificationExpiresAt": "2024-01-01T00:10:00.000Z"
  }
}
```

**–û—à–∏–±–∫–∞ (400):**
```json
{
  "success": false,
  "message": "Email —É–∂–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω"
}
```

**–û—à–∏–±–∫–∞ (404):**
```json
{
  "success": false,
  "message": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω"
}
```

---

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**GET** `/auth/me`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–£—Å–ø–µ—à–Ω–æ",
  "data": {
    "user": {
      "id": "uuid",
      "email": "user@example.com",
      "display_name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
      // ... –≤—Å–µ –ø–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    }
  }
}
```

---

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞

**POST** `/auth/refresh`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–¢–æ–∫–µ–Ω –æ–±–Ω–æ–≤–ª–µ–Ω",
  "data": {
    "token": "–Ω–æ–≤—ã–π_jwt_token"
  }
}
```

---

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Firebase (Google Sign In, Apple Sign In –∏ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã)

**POST** `/auth/firebase`

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–≠—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Firebase —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏:
- **Google Sign In** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Google –∞–∫–∫–∞—É–Ω—Ç
- **Apple Sign In** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Apple ID
- **GitHub Sign In** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ GitHub
- **Phone Authentication** - –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- **Email/Password** - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ email –∏ –ø–∞—Ä–æ–ª—å

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Firebase –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ Firebase ID Token –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –∏ –ø–æ–ª—É—á–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä–Ω—ã–π JWT —Ç–æ–∫–µ–Ω –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã —Å API.

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (`auth_type`):**
- `google` - Google Sign In
- `apple` - Apple Sign In
- `github` - GitHub Sign In
- `phone` - Phone Authentication
- `email` - Email/Password

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**  
–ü–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —ç—Ç–æ–≥–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Firebase Admin SDK –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.  
–ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–º. –≤ —Ñ–∞–π–ª–µ [FIREBASE_SETUP.md](./FIREBASE_SETUP.md)

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "idToken": "firebase_id_token_here",
  "first_name": "–ò–≤–∞–Ω",      // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è Apple Sign In –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
  "second_name": "–ò–≤–∞–Ω–æ–≤"    // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è Apple Sign In –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
}
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**  
–ü–æ–ª—è `first_name` –∏ `second_name` –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω—ã –¥–ª—è Apple Sign In, —Ç–∞–∫ –∫–∞–∫ Apple –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `givenName` –∏ `familyName` —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ –∏ –æ–Ω–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Firebase User. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏—Ö —Å —Ñ—Ä–æ–Ω—Ç–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Apple.

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Firebase –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ",
  "data": {
    "user": {
      "id": "uuid",
      "email": "user@example.com",
      "display_name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
      "photo_url": "https://example.com/photo.jpg",
      "uid": "firebase_uid",
      "auth_type": "google",
      // ... –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

**–û—à–∏–±–∫–∞ (401):**
```json
{
  "success": false,
  "message": "–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π Firebase —Ç–æ–∫–µ–Ω"
}
```

**–û—à–∏–±–∫–∞ (400):**
```json
{
  "success": false,
  "message": "–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏",
  "errors": [
    {
      "msg": "Firebase ID Token –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω",
      "param": "idToken"
    }
  ]
}
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Flutter:**

```dart
import 'package:firebase_auth/firebase_auth.dart';
import 'package:http/http.dart' as http;
import 'dart:convert';
import 'package:flutter_secure_storage/flutter_secure_storage.dart';

class AuthService {
  final String baseUrl = 'https://danilagames.ru/api';
  final FlutterSecureStorage _storage = FlutterSecureStorage();

  /// –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Firebase (Google Sign In, Apple Sign In –∏ –¥—Ä.)
  /// –í—ã–∑—ã–≤–∞–π—Ç–µ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Firebase
  /// 
  /// [first_name] –∏ [second_name] - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è Apple Sign In
  /// –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ, —Ç–∞–∫ –∫–∞–∫ Apple –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
  Future<Map<String, dynamic>?> signInWithFirebase({
    String? first_name,
    String? second_name,
  }) async {
    try {
      // –ü–æ–ª—É—á–∞–µ–º Firebase ID Token
      final user = FirebaseAuth.instance.currentUser;
      if (user == null) {
        throw Exception('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω –≤ Firebase');
      }

      // –ü–æ–ª—É—á–∞–µ–º —Å–≤–µ–∂–∏–π —Ç–æ–∫–µ–Ω (forceRefresh: true –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞)
      final idToken = await user.getIdToken(true);
      
      // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞
      final requestBody = {'idToken': idToken};
      if (first_name != null && first_name.isNotEmpty) {
        requestBody['first_name'] = first_name;
      }
      if (second_name != null && second_name.isNotEmpty) {
        requestBody['second_name'] = second_name;
      }
      
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä
      final response = await http.post(
        Uri.parse('$baseUrl/auth/firebase'),
        headers: {'Content-Type': 'application/json'},
        body: jsonEncode(requestBody),
      );

      final data = jsonDecode(response.body);

      if (data['success'] == true) {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–µ—Ä–≤–µ—Ä–Ω—ã–π JWT —Ç–æ–∫–µ–Ω
        final serverToken = data['data']['token'];
        await _storage.write(key: 'auth_token', value: serverToken);
        
        return data['data'];
      } else {
        throw Exception(data['message'] ?? '–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');
      }
    } catch (e) {
      print('–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Firebase: $e');
      return null;
    }
  }

  /// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
  Future<String?> getToken() async {
    return await _storage.read(key: 'auth_token');
  }

  /// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ API –∑–∞–ø—Ä–æ—Å–∞—Ö
  Future<Map<String, dynamic>> makeAuthenticatedRequest(
    String method,
    String endpoint, {
    Map<String, dynamic>? body,
  }) async {
    final token = await getToken();
    if (token == null) {
      throw Exception('–¢–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω. –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è.');
    }

    final headers = {
      'Content-Type': 'application/json',
      'Authorization': 'Bearer $token',
    };

    final uri = Uri.parse('$baseUrl$endpoint');
    http.Response response;

    switch (method.toUpperCase()) {
      case 'GET':
        response = await http.get(uri, headers: headers);
        break;
      case 'POST':
        response = await http.post(
          uri,
          headers: headers,
          body: body != null ? jsonEncode(body) : null,
        );
        break;
      case 'PUT':
        response = await http.put(
          uri,
          headers: headers,
          body: body != null ? jsonEncode(body) : null,
        );
        break;
      case 'DELETE':
        response = await http.delete(uri, headers: headers);
        break;
      default:
        throw Exception('–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π –º–µ—Ç–æ–¥: $method');
    }

    return jsonDecode(response.body);
  }
}
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**

**–î–ª—è Google Sign In:**
```dart
// –í –≤–∞—à–µ–º –∫–æ–¥–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Google (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ authorization_widget.dart)
// –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Firebase:

final user = await authManager.signInWithGoogle(context);
if (user != null) {
  // –ñ–¥–µ–º –ø–æ–∫–∞ currentUserDocument –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω
  int attempts = 0;
  while (currentUserDocument == null && attempts < 20) {
    await Future.delayed(const Duration(milliseconds: 100));
    attempts++;
  }

  // –í–ê–ñ–ù–û: –¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º Firebase —Ç–æ–∫–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä
  // –î–ª—è Google first_name –∏ second_name –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã - –æ–Ω–∏ –±—É–¥—É—Ç —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω—ã –∏–∑ display_name
  final authService = AuthService();
  final serverAuthResult = await authService.signInWithFirebase();
  
  if (serverAuthResult != null) {
    // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞, —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω
    // auth_type –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ 'google'
    // first_name –∏ second_name –±—É–¥—É—Ç —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω—ã –∏–∑ display_name
    print('‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
    print('üì± Auth type: ${serverAuthResult['user']['auth_type']}'); // 'google'
  } else {
    print('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ');
  }
}
```

**–î–ª—è Apple Sign In:**
```dart
import 'package:sign_in_with_apple/sign_in_with_apple.dart';

// –í –≤–∞—à–µ–º –∫–æ–¥–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Apple (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ authorization_widget.dart)
// –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Firebase:

// –í–ê–ñ–ù–û: –î–ª—è Apple –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å givenName –∏ familyName –î–û –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Firebase,
// —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
String? appleFirstName;
String? appleSecondName;

// –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º nonce –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
final rawNonce = generateNonce();
final nonce = sha256ofString(rawNonce);

// –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º credential –æ—Ç Apple
final appleCredential = await SignInWithApple.getAppleIDCredential(
  scopes: [
    AppleIDAuthorizationScopes.email,
    AppleIDAuthorizationScopes.fullName, // –í–ê–ñ–ù–û: –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º fullName
  ],
  nonce: nonce,
);

// –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é –î–û –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Firebase
// (–æ–Ω–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ!)
appleFirstName = appleCredential.givenName;
appleSecondName = appleCredential.familyName;

// –°–æ–∑–¥–∞–µ–º OAuth credential –¥–ª—è Firebase
final oauthCredential = OAuthProvider("apple.com").credential(
  idToken: appleCredential.identityToken,
  rawNonce: rawNonce,
  accessToken: appleCredential.authorizationCode,
);

// –ê–≤—Ç–æ—Ä–∏–∑—É–µ–º—Å—è –≤ Firebase
final userCredential = await FirebaseAuth.instance.signInWithCredential(oauthCredential);

// –û–±–Ω–æ–≤–ª—è–µ–º displayName –≤ Firebase (–µ—Å–ª–∏ –µ—Å—Ç—å)
if (appleFirstName != null || appleSecondName != null) {
  final displayName = [appleFirstName, appleSecondName]
      .where((name) => name != null && name.isNotEmpty)
      .join(' ');
  if (displayName.isNotEmpty) {
    await userCredential.user?.updateDisplayName(displayName);
  }
}

// –ñ–¥–µ–º –ø–æ–∫–∞ currentUserDocument –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω
int attempts = 0;
while (currentUserDocument == null && attempts < 20) {
  await Future.delayed(const Duration(milliseconds: 100));
  attempts++;
}

// –í–ê–ñ–ù–û: –û—Ç–ø—Ä–∞–≤–ª—è–µ–º Firebase —Ç–æ–∫–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä –° –∏–º–µ–Ω–∞–º–∏ –∏–∑ Apple
final authService = AuthService();
final serverAuthResult = await authService.signInWithFirebase(
  first_name: appleFirstName,  // –ü–µ—Ä–µ–¥–∞–µ–º –∏–º—è –∏–∑ Apple
  second_name: appleSecondName, // –ü–µ—Ä–µ–¥–∞–µ–º —Ñ–∞–º–∏–ª–∏—é –∏–∑ Apple
);

if (serverAuthResult != null) {
  // –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞, —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω
  // auth_type –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ 'apple'
  // first_name –∏ second_name –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
  print('‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Apple –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
  print('üì± Auth type: ${serverAuthResult['user']['auth_type']}'); // 'apple'
  print('üë§ –ò–º—è: ${serverAuthResult['user']['first_name']}');
  print('üë§ –§–∞–º–∏–ª–∏—è: ${serverAuthResult['user']['second_name']}');
} else {
  print('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ');
}
```

**–í–∞–∂–Ω–æ –¥–ª—è Apple Sign In:**
- `givenName` –∏ `familyName` –¥–æ—Å—Ç—É–ø–Ω—ã **—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ** —á–µ—Ä–µ–∑ Apple
- –ò—Ö –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å **–î–û** –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Firebase
- –ü–µ—Ä–µ–¥–∞–π—Ç–µ –∏—Ö –≤ `signInWithFirebase(first_name: ..., second_name: ...)`
- –ï—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—Ç—å, —Å–µ—Ä–≤–µ—Ä –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å `display_name`, –Ω–æ —ç—Ç–æ –º–µ–Ω–µ–µ –Ω–∞–¥–µ–∂–Ω–æ

**–í–∞–∂–Ω–æ –¥–ª—è Apple Sign In:**
- Apple –º–æ–∂–µ—Ç –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å email –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–∫—Ä—ã—Ç—å email)
- –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Å–µ—Ä–≤–µ—Ä —Å–æ–∑–¥–∞—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å `email = null` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∫—Ä—ã—Ç—ã–π email –æ—Ç Apple
- –ü—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –≤—Ö–æ–¥–∞—Ö email –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω
- –°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç email, –µ—Å–ª–∏ –æ–Ω —Å—Ç–∞–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω
- **`givenName` –∏ `familyName` –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ** - –ø–µ—Ä–µ–¥–∞–π—Ç–µ –∏—Ö –≤ `first_name` –∏ `second_name` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

**–ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**

–ü—Ä–∏ –ø–µ—Ä–≤–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ:

**–ò–∑ Firebase ID Token:**
- ‚úÖ `uid` - Firebase UID (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ `uid` –≤ –±–∞–∑–µ)
- ‚úÖ `email` - Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–º–æ–∂–µ—Ç –±—ã—Ç—å null –¥–ª—è Apple)
- ‚úÖ `name` - –ü–æ–ª–Ω–æ–µ –∏–º—è (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ `display_name`)
- ‚úÖ `picture` - URL —Ñ–æ—Ç–æ (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ `photo_url`)
- ‚úÖ `email_verified` - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω –ª–∏ email

**–ß–µ—Ä–µ–∑ Firebase Admin SDK (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ):**
- ‚úÖ `phone_number` - –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ `phone_number`)

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥:**
- ‚úÖ `first_name` - –ü–µ—Ä–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ `display_name` (–µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–æ —Å —Ñ—Ä–æ–Ω—Ç–∞)
- ‚úÖ `second_name` - –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞ –∏–∑ `display_name` (–µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–æ —Å —Ñ—Ä–æ–Ω—Ç–∞)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Å —Ñ—Ä–æ–Ω—Ç–∞ (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è Apple):**
- ‚úÖ `first_name` - –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è Apple - –∏–∑ `appleCredential.givenName`)
- ‚úÖ `second_name` - –§–∞–º–∏–ª–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è Apple - –∏–∑ `appleCredential.familyName`)

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è:**
- ‚úÖ `auth_type` - –¢–∏–ø –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (`google`, `apple`, `github`, `phone`, `email`)

**–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:**

1. **Firebase ID Token** –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `FirebaseAuth.instance.currentUser?.getIdToken(true)`
   - –ü–∞—Ä–∞–º–µ—Ç—Ä `true` –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
   - Firebase —Ç–æ–∫–µ–Ω—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ —á–∞—Å

2. **–°–µ—Ä–≤–µ—Ä–Ω—ã–π JWT —Ç–æ–∫–µ–Ω** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤
   - –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –µ–≥–æ –≤ `flutter_secure_storage`
   - –î–æ–±–∞–≤–ª—è–π—Ç–µ –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Bearer <token>`

3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –±–∞–∑–µ (–ø–æ `uid` –∏–ª–∏ `email`), –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–æ–≤—ã–π, —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
   - –ü–æ–ª–µ `uid` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç Firebase UID

4. **–¢–∏–ø—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (`auth_type`):**
   - `google` - Google Sign In
   - `apple` - Apple Sign In
   - `github` - GitHub Sign In
   - `phone` - Phone Authentication
   - `email` - Email/Password (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)

5. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
   - –ï—Å–ª–∏ Firebase —Ç–æ–∫–µ–Ω –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω, –≤–µ—Ä–Ω–µ—Ç—Å—è 401
   - –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫, –ø–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–π —á–µ—Ä–µ–∑ `getIdToken(true)`
   - –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Å–µ—Ç–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è

---

## üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

**GET** `/users`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page` (integer, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1)
- `limit` (integer, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 20, –º–∞–∫—Å–∏–º—É–º: 100)
- `search` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –ø–æ–∏—Å–∫ –ø–æ email, display_name, first_name, second_name

---

### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–ø–∏—Å–∫–æ–º

**GET** `/users/all`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å—Ä–∞–∑—É —Å–ø–∏—Å–∫–æ–º –±–µ–∑ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏.

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `search` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –ø–æ–∏—Å–∫ –ø–æ email, display_name, first_name, second_name

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "users": [
      {
        "id": "uuid",
        "email": "user@example.com",
        "display_name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "photo_url": "https://...",
        "uid": "firebase-uid",
        "phone_number": "+79001234567",
        "city": "–ú–æ—Å–∫–≤–∞",
        "first_name": "–ò–º—è",
        "second_name": "–§–∞–º–∏–ª–∏—è",
        "country": "–†–æ—Å—Å–∏—è",
        "gender": "male",
        "count_performed": 5,
        "count_orders": 3,
        "jcoins": 1000,
        "coins_from_created": 500,
        "coins_from_participation": 500,
        "stripe_id": null,
        "score": 4.5,
        "admin": 0,
        "fcm_token": "token",
        "auth_type": "email",
        "latitude": 55.7558,
        "longitude": 37.6173,
        "created_time": "2025-01-01T00:00:00.000Z",
        "about": "–û —Å–µ–±–µ",
        "social_links": [
          "https://twitter.com/username",
          "https://instagram.com/username"
        ]
      }
    ],
    "total": 150
  }
}
```

**–û—à–∏–±–∫–∏:**
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `500` - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (—Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ—à–∏–±–∫–µ)

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ Flutter:**
```dart
Future<Map<String, dynamic>> getAllUsers({
  required String token,
  String? search,
}) async {
  final queryParams = <String, String>{};
  
  if (search != null && search.isNotEmpty) {
    queryParams['search'] = search;
  }
  
  final uri = Uri.parse('https://danilagames.ru/api/users/all')
      .replace(queryParameters: queryParams);
  
  final response = await http.get(
    uri,
    headers: {
      'Authorization': 'Bearer $token',
      'Content-Type': 'application/json',
      'Accept': 'application/json',
    },
  );
  
  if (response.statusCode == 200) {
    return json.decode(response.body);
  } else {
    throw Exception('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${response.body}');
  }
}
```

---

**–û—Ç–≤–µ—Ç –¥–ª—è GET /users (—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π) (200):**
```json
{
  "success": true,
  "data": {
    "users": [
      {
        "id": "uuid",
        "email": "user@example.com",
        "display_name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "photo_url": "https://...",
        "uid": "firebase-uid",
        "phone_number": "+79001234567",
        "city": "–ú–æ—Å–∫–≤–∞",
        "first_name": "–ò–º—è",
        "second_name": "–§–∞–º–∏–ª–∏—è",
        "country": "–†–æ—Å—Å–∏—è",
        "gender": "male",
        "count_performed": 5,
        "count_orders": 3,
        "jcoins": 1000,
        "coins_from_created": 500,
        "coins_from_participation": 500,
        "stripe_id": null,
        "score": 4.5,
        "admin": 0,
        "fcm_token": "token",
        "auth_type": "email",
        "latitude": 55.7558,
        "longitude": 37.6173,
        "created_time": "2025-01-01T00:00:00.000Z",
        "about": "–û —Å–µ–±–µ",
        "social_links": [
          "https://twitter.com/username",
          "https://instagram.com/username"
        ]
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 100,
      "totalPages": 5
    }
  }
}
```

**–û—à–∏–±–∫–∏:**
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `500` - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (—Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ—à–∏–±–∫–µ)

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ Flutter (—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π):**
```dart
Future<Map<String, dynamic>> getUsersList({
  required String token,
  int page = 1,
  int limit = 20,
  String? search,
}) async {
  final queryParams = <String, String>{
    'page': page.toString(),
    'limit': limit.toString(),
  };
  
  if (search != null && search.isNotEmpty) {
    queryParams['search'] = search;
  }
  
  final uri = Uri.parse('https://danilagames.ru/api/users')
      .replace(queryParameters: queryParams);
  
  final response = await http.get(
    uri,
    headers: {
      'Authorization': 'Bearer $token',
      'Content-Type': 'application/json',
      'Accept': 'application/json',
    },
  );
  
  if (response.statusCode == 200) {
    return json.decode(response.body);
  } else {
    throw Exception('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${response.body}');
  }
}
```

---

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID

**GET** `/users/:id`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** (–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –∞–¥–º–∏–Ω)

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "user": {
      "id": "uuid",
      "email": "user@example.com",
      "display_name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
      // ... –≤—Å–µ –ø–æ–ª—è
    }
  }
}
```

---

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**PUT** `/users/:id`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:**

1. **JSON —Å URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏** (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
2. **multipart/form-data —Å —Ñ–∞–π–ª–æ–º** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–°–ø–æ—Å–æ–± 1: JSON —Å URL**

**Content-Type:** `application/json`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "display_name": "–ù–æ–≤–æ–µ –∏–º—è",
  "first_name": "–ò–º—è",
  "second_name": "–§–∞–º–∏–ª–∏—è",
  "phone_number": "+1234567890",
  "city": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
  "country": "–†–æ—Å—Å–∏—è",
  "gender": "female",
  "photo_url": "https://example.com/photo.jpg",
  "latitude": 59.9343,
  "longitude": 30.3351,
  "fcm_token": "fcm_token_here",
  "about": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ–±–µ",
  "social_links": [
    "https://twitter.com/username",
    "https://instagram.com/username",
    "https://facebook.com/username"
  ]
}
```

**–°–ø–æ—Å–æ–± 2: multipart/form-data —Å —Ñ–∞–π–ª–æ–º**

**Content-Type:** `multipart/form-data`

**–ü–æ–ª—è —Ñ–æ—Ä–º—ã:**
- `display_name` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `first_name` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `second_name` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `phone_number` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `city` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `country` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `gender` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `photo` (file, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ñ–∞–π–ª –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `latitude` (float, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `longitude` (float, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `fcm_token` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `about` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ–±–µ
- `social_links` (array[string], –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –º–∞—Å—Å–∏–≤ —Å—Å—ã–ª–æ–∫ –Ω–∞ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è —Ñ–∞–π–ª–∞:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 10MB
- –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: JPEG, PNG, GIF, WebP

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Flutter:**

```dart
Future<void> updateUserAvatar({
  required String token,
  required String userId,
  required File avatarFile,
}) async {
  final uri = Uri.parse('https://danilagames.ru/api/users/$userId');
  final request = http.MultipartRequest('PUT', uri);
  
  request.headers['Authorization'] = 'Bearer $token';
  
  // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∞–π–ª
  final fileStream = http.ByteStream(avatarFile.openRead());
  final length = await avatarFile.length();
  final multipartFile = http.MultipartFile(
    'photo',
    fileStream,
    length,
    filename: path.basename(avatarFile.path),
  );
  request.files.add(multipartFile);
  
  // –û—Ç–ø—Ä–∞–≤–∫–∞
  final streamedResponse = await request.send();
  final response = await http.Response.fromStream(streamedResponse);
  
  if (response.statusCode == 200) {
    final data = jsonDecode(response.body);
    print('–ê–≤–∞—Ç–∞—Ä –æ–±–Ω–æ–≤–ª–µ–Ω: ${data['data']['user']['photo_url']}');
  }
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω—ã",
  "data": {
    "user": { /* –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ */ }
  }
}
```

---

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Joycoins (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)

**PUT** `/users/:id/jcoins`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "jcoins": 100,
  "operation": "add"  // "set", "add", "subtract"
}
```

---

## üìã –ó–∞—è–≤–∫–∏ (Requests)

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞—è–≤–æ–∫

**GET** `/requests`

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page` (int, default: 1) - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `limit` (int, default: 20) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- `category` (string) - —Ñ–∏–ª—å—Ç—Ä: `wasteLocation`, `speedCleanup`, `event`
- `status` (string) - —Ñ–∏–ª—å—Ç—Ä: `new`, `inProgress`, `pending`, `approved`, `rejected`, `completed`, `archived`
- `city` (string) - —Ñ–∏–ª—å—Ç—Ä –ø–æ –≥–æ—Ä–æ–¥—É
- `latitude` (float) - —à–∏—Ä–æ—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Ä–∞–¥–∏—É—Å—É
- `longitude` (float) - –¥–æ–ª–≥–æ—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Ä–∞–¥–∏—É—Å—É
- `radius` (int, default: 10000) - —Ä–∞–¥–∏—É—Å –≤ –º–µ—Ç—Ä–∞—Ö
- `is_open` (boolean) - —Ñ–∏–ª—å—Ç—Ä –ø–æ –æ—Ç–∫—Ä—ã—Ç–æ—Å—Ç–∏
- `user_id` (string) - —Ñ–∏–ª—å—Ç—Ä –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- `created_by` (string) - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å–æ–∑–¥–∞—Ç–µ–ª—é
- `taken_by` (string) - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
```
GET /api/requests?category=wasteLocation&city=–ú–æ—Å–∫–≤–∞&page=1&limit=20
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "requests": [
      {
        "id": "uuid",
        "user_id": "uuid",
        "category": "wasteLocation",
        "name": "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏",
        "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
        "latitude": 55.7558,
        "longitude": 37.6173,
        "city": "–ú–æ—Å–∫–≤–∞",
        "garbage_size": 1,
        "only_foot": false,
        "possible_by_car": true,
        "cost": 1000,
        "reward_amount": null,
        "is_open": true,
        "start_date": null,
        "end_date": null,
        "status": "new",
        "priority": "medium",
        "assigned_to": null,
        "created_by": "uuid",
        "taken_by": null,
        "total_contributed": 0,
        "target_amount": null,
        "joined_user_id": null,
        "join_date": null,
        "payment_intent_id": null,
        "completion_comment": null,
        "plant_tree": false,
        "trash_pickup_only": false,
        "created_at": "2024-01-01T00:00:00.000Z",
        "updated_at": "2024-01-01T00:00:00.000Z",
        "photos_before": ["url1", "url2"],
        "photos_after": [],
        "waste_types": ["plastic", "glass"]
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 100,
      "totalPages": 5
    }
  }
}
```

---

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ –ø–æ ID

**GET** `/requests/:id`

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "request": {
      "id": "uuid",
      // ... –≤—Å–µ –ø–æ–ª—è –∑–∞—è–≤–∫–∏
      "registered_participants": ["user_id1", "user_id2"],
      "actual_participants": [],
      "donations": [
        {
          "id": "uuid",
          "request_id": "uuid",
          "user_id": "uuid",
          "amount": 1000,
          "payment_intent_id": "pi_xxx",
          "created_at": "2024-01-01T00:00:00.000Z"
        }
      ]
    }
  }
}
```

---

### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏

**POST** `/requests`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–í–∞–∂–Ω–æ:** –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–∏–¥–µ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ `multipart/form-data`. URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è.

**Content-Type:** `multipart/form-data`

**–ü–æ–ª—è —Ñ–æ—Ä–º—ã:**
- –í—Å–µ –ø–æ–ª—è –∑–∞—è–≤–∫–∏ (–∫–∞–∫ –≤ JSON –Ω–∏–∂–µ) –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ –ø–æ–ª—è —Ñ–æ—Ä–º—ã
- `photos_before` (file[]) - –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π "–¥–æ" —É–±–æ—Ä–∫–∏
- `photos_after` (file[]) - –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π "–ø–æ—Å–ª–µ" —É–±–æ—Ä–∫–∏

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ (JSON –ø–æ–ª—è):**
```json
{
  "category": "wasteLocation",
  "name": "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏",
  "latitude": 55.7558,
  "longitude": 37.6173,
  "city": "–ú–æ—Å–∫–≤–∞",
  "garbage_size": 1,
  "only_foot": false,
  "possible_by_car": true,
  "cost": 1000,
  "reward_amount": null,
  "start_date": null,
  "end_date": null,
  "status": "new",
  "priority": "medium",
  "waste_types": ["plastic", "glass"]
  "target_amount": null,
  "plant_tree": false,
  "trash_pickup_only": false
}
```

**–î–ª—è Speed Cleanup:**
```json
{
  "category": "speedCleanup",
  "name": "–ë—ã—Å—Ç—Ä–∞—è —É–±–æ—Ä–∫–∞",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
  "latitude": 55.7558,
  "longitude": 37.6173,
  "city": "–ú–æ—Å–∫–≤–∞",
  "garbage_size": 2,
  "reward_amount": 50,
  "start_date": "2024-02-01T10:00:00.000Z",
  "end_date": "2024-02-01T10:25:00.000Z",
  // photos_before –∏ photos_after –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ multipart/form-data
  "waste_types": ["plastic"]
}
```

**–í–∞–∂–Ω–æ –¥–ª—è Speed Cleanup:**
- –ü–æ–ª—è `start_date` –∏ `end_date` **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã** –¥–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `speedCleanup`
- –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `start_date` –∏ `end_date` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 20 –º–∏–Ω—É—Ç –¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∫–æ–∏–Ω–∞ —Å–æ–∑–¥–∞—Ç–µ–ª—é –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏
- –§–æ—Ä–º–∞—Ç –¥–∞—Ç: ISO 8601 (–Ω–∞–ø—Ä–∏–º–µ—Ä: `"2024-02-01T10:00:00.000Z"`)

**–î–ª—è Event:**
```json
{
  "category": "event",
  "name": "–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
  "latitude": 55.7558,
  "longitude": 37.6173,
  "city": "–ú–æ—Å–∫–≤–∞",
  "start_date": "2024-02-01T10:00:00.000Z",
  "end_date": "2024-02-01T18:00:00.000Z",
  "plant_tree": true
  // photos_before –∏ photos_after –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∫ —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ multipart/form-data
}
```

**–í–∞–∂–Ω–æ –¥–ª—è Event:**
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ `inProgress`
- –°–æ–∑–¥–∞—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `registered_participants`
- –î—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ —Å–æ–±—ã—Ç–∏—é —á–µ—Ä–µ–∑ `POST /api/requests/:id/participate`
- –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–æ–±—ã—Ç–∏—è –∑–∞–∫–∞–∑—á–∏–∫ —É–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ `actual_participants`

**–ü–æ–ª—è —Ñ–æ—Ä–º—ã:**
- `category` (string, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ) - –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∑–∞—è–≤–∫–∏
- `name` (string, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ) - –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
- `description` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –æ–ø–∏—Å–∞–Ω–∏–µ
- `latitude` (float, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —à–∏—Ä–æ—Ç–∞
- `longitude` (float, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¥–æ–ª–≥–æ—Ç–∞
- `city` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –≥–æ—Ä–æ–¥
- `garbage_size` (integer, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ä–∞–∑–º–µ—Ä –º—É—Å–æ—Ä–∞
- `only_foot` (boolean, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ç–æ–ª—å–∫–æ –ø–µ—à–∫–æ–º
- `possible_by_car` (boolean, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ –º–∞—à–∏–Ω–µ
- `cost` (integer, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Å—Ç–æ–∏–º–æ—Å—Ç—å
- `reward_amount` (integer, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ä–∞–∑–º–µ—Ä –Ω–∞–≥—Ä–∞–¥—ã
- `start_date` (string, **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è speedCleanup**, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è event) - –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã
- `end_date` (string, **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è speedCleanup**, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è event) - –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã
- `status` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Å—Ç–∞—Ç—É—Å. **–í–∞–∂–Ω–æ:** –°—Ç–∞—Ç—É—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ –∑–∞—è–≤–∫–∏:<br>- `wasteLocation`: `new` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)<br>- `speedCleanup`: `new` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏–ª–∏ `inProgress` (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–æ —è–≤–Ω–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏)<br>- `event`: `inProgress` (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏, —Å–æ–∑–¥–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —É—á–∞—Å—Ç–Ω–∏–∫–∏)
- `priority` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "medium")
- `waste_types` (array[string], –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –º–∞—Å—Å–∏–≤ –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–∏–ø–æ–≤ –æ—Ç—Ö–æ–¥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `["plastic", "glass"]`)
- `target_amount` (integer, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ü–µ–ª–µ–≤–∞—è —Å—É–º–º–∞
- `plant_tree` (boolean, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –ø–æ—Å–∞–¥–∏—Ç—å –¥–µ—Ä–µ–≤–æ
- `trash_pickup_only` (boolean, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ç–æ–ª—å–∫–æ —Å–±–æ—Ä –º—É—Å–æ—Ä–∞
- `photos_before` (file[], –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Ñ–æ—Ç–æ "–¥–æ" —É–±–æ—Ä–∫–∏
- `photos_after` (file[], –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Ñ–æ—Ç–æ "–ø–æ—Å–ª–µ" —É–±–æ—Ä–∫–∏

**–í–∞–∂–Ω–æ:**
- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ –≤ –≤–∏–¥–µ —Ñ–∞–π–ª–æ–≤** —á–µ—Ä–µ–∑ `multipart/form-data`
- URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π **–Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è**

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏:**
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç** (`group`) –¥–ª—è –∑–∞—è–≤–∫–∏ –ª—é–±–æ–≥–æ —Ç–∏–ø–∞ (wasteLocation, speedCleanup, event)
- ‚úÖ –°–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞
- ‚úÖ –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏
- ‚úÖ –£—á–∞—Å—Ç–Ω–∏–∫–∏ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç –ø—Ä–∏:
  - –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ –∫ –∑–∞—è–≤–∫–µ (waste) —á–µ—Ä–µ–∑ `POST /api/requests/:id/join`
  - –£—á–∞—Å—Ç–∏–∏ –≤ —Å–æ–±—ã—Ç–∏–∏ (event) —á–µ—Ä–µ–∑ `POST /api/requests/:id/participate`
  - –î–æ–Ω–∞—Ç–µ —á–µ—Ä–µ–∑ `POST /api/donations`
- –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∏ –≤ –æ—Ç–≤–µ—Ç–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∏—Ö URL

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 10MB
- –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: JPEG, PNG, GIF, WebP
- –ú–∞–∫—Å–∏–º—É–º 10 —Ñ–∞–π–ª–æ–≤ –≤ –∫–∞–∂–¥–æ–º –ø–æ–ª–µ (photos_before, photos_after)

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Flutter (multipart/form-data):**

```dart
import 'package:http/http.dart' as http;
import 'dart:io';
import 'package:path/path.dart' as path;

Future<void> createRequestWithPhotos({
  required String token,
  required String name,
  required String category,
  List<File>? photos_before,
  List<File>? photos_after,
}) async {
  final uri = Uri.parse('https://danilagames.ru/api/requests');
  final request = http.MultipartRequest('POST', uri);
  
  // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
  request.headers['Authorization'] = 'Bearer $token';
  
  // –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è
  request.fields['name'] = name;
  request.fields['category'] = category;
  request.fields['description'] = '–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏';
  request.fields['city'] = '–ú–æ—Å–∫–≤–∞';
  request.fields['latitude'] = '55.7558';
  request.fields['longitude'] = '37.6173';
  
  // –§–∞–π–ª—ã - —Ñ–æ—Ç–æ "–¥–æ"
  if (photos_before != null) {
    for (var photo in photos_before) {
      final fileStream = http.ByteStream(photo.openRead());
      final length = await photo.length();
      final multipartFile = http.MultipartFile(
        'photos_before',
        fileStream,
        length,
        filename: path.basename(photo.path),
      );
      request.files.add(multipartFile);
    }
  }
  
  // –§–∞–π–ª—ã - —Ñ–æ—Ç–æ "–ø–æ—Å–ª–µ"
  if (photos_after != null) {
    for (var photo in photos_after) {
      final fileStream = http.ByteStream(photo.openRead());
      final length = await photo.length();
      final multipartFile = http.MultipartFile(
        'photos_after',
        fileStream,
        length,
        filename: path.basename(photo.path),
      );
      request.files.add(multipartFile);
    }
  }
  
  // –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
  final streamedResponse = await request.send();
  final response = await http.Response.fromStream(streamedResponse);
  
  if (response.statusCode == 201) {
    final data = jsonDecode(response.body);
    print('–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞: ${data['data']['request']['id']}');
  }
}
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "success": true,
  "message": "–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞",
  "data": {
    "request": {
      "id": "uuid",
      "name": "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏",
      "photos": ["https://danilagames.ru/uploads/photos/uuid1.jpg", "https://danilagames.ru/uploads/photos/uuid2.jpg"],
      "photos_before": ["https://danilagames.ru/uploads/photos/uuid3.jpg"],
      "photos_after": ["https://danilagames.ru/uploads/photos/uuid4.jpg"],
      // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è
    },
    "group_chat": {
      "id": "uuid",
      "type": "group",
      "request_id": "uuid",
      "created_by": "uuid",
      "created_at": "2025-12-16T10:12:58.000Z",
      "participants": ["353f958d-8796-44c7-a877-3e376eca6784"],
      "participants_count": 1
    }
  }
}
```

**–ü–æ–ª—è –æ—Ç–≤–µ—Ç–∞:**
- `request` - –æ–±—ä–µ–∫—Ç —Å–æ–∑–¥–∞–Ω–Ω–æ–π –∑–∞—è–≤–∫–∏
- `group_chat` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ–∑–¥–∞–Ω–Ω–æ–º –≥—Ä—É–ø–ø–æ–≤–æ–º —á–∞—Ç–µ:
  - `id` - ID –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞
  - `type` - —Ç–∏–ø —á–∞—Ç–∞ (–≤—Å–µ–≥–¥–∞ `"group"`)
  - `request_id` - ID –∑–∞—è–≤–∫–∏, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π —Å–æ–∑–¥–∞–Ω —á–∞—Ç
  - `created_by` - ID —Å–æ–∑–¥–∞—Ç–µ–ª—è —á–∞—Ç–∞ (—Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º –∑–∞—è–≤–∫–∏)
  - `created_at` - –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–∞
  - `participants` - –º–∞—Å—Å–∏–≤ ID —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–∞—Ç–∞ (–≤–∫–ª—é—á–∞—è —Å–æ–∑–¥–∞—Ç–µ–ª—è)
  - `participants_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ —á–∞—Ç–µ

**–í–∞–∂–Ω–æ:**
- –§–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ –ø–∞–ø–∫–µ `uploads/photos/`
- –°–µ—Ä–≤–µ—Ä –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤
- URL —Ñ–∞–π–ª–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è –∑–∞—è–≤–∫–∏
- –§–∞–π–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ URL: `https://danilagames.ru/uploads/photos/{filename}`

---

### –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–Ω–∞—Ç–∞ –æ—Ç —Å–æ–∑–¥–∞—Ç–µ–ª—è

**–í–ê–ñ–ù–û:** Endpoint `POST /api/requests/create-with-payment` —É–¥–∞–ª–µ–Ω. –¢–µ–ø–µ—Ä—å –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –∏–¥—É—Ç —á–µ—Ä–µ–∑ –¥–æ–Ω–∞—Ç—ã.

**–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥:**
1. –°–æ–∑–¥–∞–π—Ç–µ –∑–∞—è–≤–∫—É —á–µ—Ä–µ–∑ `POST /api/requests` (–±–µ–∑ –ø–ª–∞—Ç–µ–∂–∞)
2. –°—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è (–∏–ª–∏ –ø–æ–∑–∂–µ) —Å–æ–∑–¥–∞–π—Ç–µ –¥–æ–Ω–∞—Ç –æ—Ç —Å–æ–∑–¥–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ `POST /api/donations`

**–ü—Ä–∏–º–µ—Ä:**
```dart
// 1. –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É
final request = await createRequest(...);

// 2. –°–æ–∑–¥–∞—Ç—å –¥–æ–Ω–∞—Ç –æ—Ç —Å–æ–∑–¥–∞—Ç–µ–ª—è (–º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –∏–ª–∏ –ø–æ–∑–∂–µ)
final donation = await createDonation(
  requestId: request.id,
  amount: 10.00, // –≤ –¥–æ–ª–ª–∞—Ä–∞—Ö
  paymentIntentId: paymentIntent.id
);
```

**–õ–æ–≥–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è event –∑–∞—è–≤–æ–∫:**

–ü–æ—Å–ª–µ –¥–∞—Ç—ã –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è (`start_date`) –¥–ª—è –≤—Å–µ—Ö event –∑–∞—è–≤–æ–∫ (–∫—Ä–æ–º–µ —Ç–µ—Ö, —á—Ç–æ —É–∂–µ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∏–ª–∏ –≤ –∞—Ä—Ö–∏–≤–µ):

1. **–ß–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ `start_date`:**
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é—â–µ–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—é
   - –°–æ–æ–±—â–µ–Ω–∏–µ: "–í–∞—à–µ —Å–æ–±—ã—Ç–∏–µ —Å–æ—Å—Ç–æ—è–ª–æ—Å—å –±–æ–ª–µ–µ 24 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥. –£ –≤–∞—Å –µ—Å—Ç—å 24 —á–∞—Å–∞, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –µ–≥–æ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é, –∏–Ω–∞—á–µ –∑–∞—è–≤–∫–∞ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞, –∞ —Å—Ä–µ–¥—Å—Ç–≤–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã."
   - –ó–∞—è–≤–∫–∞ –ù–ï —É–¥–∞–ª—è–µ—Ç—Å—è, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –≤—Ä–µ–º—è –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é

2. **–ß–µ—Ä–µ–∑ 48 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ `start_date`:**
   - –ï—Å–ª–∏ –∑–∞—è–≤–∫–∞ –ù–ï –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é –∏ –ù–ï –≤ –∞—Ä—Ö–∏–≤–µ
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ —Å—Ç–∞—Ç—É—Å—ã: –∑–∞—è–≤–∫–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å != `pendingApproval`, `approved`, `rejected`, `completed`
   - –ó–∞—è–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è
   - –í—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –∏ –¥–æ–Ω–∞—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è (refund –∏–ª–∏ cancel –≤ Stripe)
   - –°–æ–∑–¥–∞—Ç–µ–ª—é –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "–í–∞—à–µ —Å–æ–±—ã—Ç–∏–µ –±—ã–ª–æ —É–¥–∞–ª–µ–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –Ω–µ –±—ã–ª–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤ –ø–æ—Å–ª–µ –¥–∞—Ç—ã –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è. –°—Ä–µ–¥—Å—Ç–≤–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã."

**–°—Ç–∞—Ç—É—Å—ã, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö event –ù–ï —É–¥–∞–ª—è–µ—Ç—Å—è:**
- `pendingApproval` - –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- `approved` - –æ–¥–æ–±—Ä–µ–Ω–∞ (–≤ –∞—Ä—Ö–∏–≤–µ)
- `rejected` - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ (–≤ –∞—Ä—Ö–∏–≤–µ)
- `completed` - –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (–≤ –∞—Ä—Ö–∏–≤–µ)

**–ü–æ—á–µ–º—É 48 —á–∞—Å–æ–≤, –∞ –Ω–µ 24:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–∞–º –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Å—é —Ä–∞–±–æ—Ç—É –±–µ–∑ –ø–æ–º–æ—â–Ω–∏–∫–æ–≤
- –ü–æ—Å–ª–µ —Å–æ–±—ã—Ç–∏—è –Ω—É–∂–Ω–æ –≤—Ä–µ–º—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ "–ø–æ—Å–ª–µ" –∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∑–∞ 24 —á–∞—Å–∞ –¥–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞—è–≤–∫—É –≤–æ–≤—Ä–µ–º—è
- –≠—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è –í–°–ï–• event –∑–∞—è–≤–æ–∫ (–ø–ª–∞—Ç–Ω—ã—Ö –∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö)

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PaymentIntent:**

1. **–û—à–∏–±–∫–∞ 500: "Stripe –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ"**
   ```json
   {
     "success": false,
     "message": "Stripe –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ",
     "errorDetails": {
       "requestId": "uuid-–∑–∞—è–≤–∫–∏",
       "userId": "uuid-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
       "amountCents": 100,
       "note": "STRIPE_SECRET_KEY –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è"
     }
   }
   ```
   **–ü—Ä–∏—á–∏–Ω–∞:** API –∫–ª—é—á Stripe –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.

2. **–û—à–∏–±–∫–∞ 500: "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PaymentIntent –≤ Stripe"**
   ```json
   {
     "success": false,
     "message": "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PaymentIntent –≤ Stripe",
     "errorDetails": {
       "errorMessage": "Your card was declined",
       "errorType": "card_error",
       "errorCode": "card_declined",
       "statusCode": 402,
       "requestId": "uuid-–∑–∞—è–≤–∫–∏",
       "userId": "uuid-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
       "amountCents": 100,
       "amountDollars": 1.0,
       "category": "event",
       "requestCategory": "event",
       "stripeDeclineCode": "insufficient_funds"
     }
   }
   ```
   **–ü—Ä–∏—á–∏–Ω—ã:**
   - –ü—Ä–æ–±–ª–µ–º—ã —Å Stripe –∞–∫–∫–∞—É–Ω—Ç–æ–º (–Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)
   - –ü—Ä–æ–±–ª–µ–º—ã —Å API –∫–ª—é—á–æ–º (test/live —Ä–µ–∂–∏–º)
   - –°–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å Stripe API
   - –ù–µ–≤–µ—Ä–Ω–∞—è —Å—É–º–º–∞ (–º–µ–Ω—å—à–µ –º–∏–Ω–∏–º—É–º–∞ Stripe - 50 —Ü–µ–Ω—Ç–æ–≤)
   
   **–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å—É–º–º–∞ >= 50 —Ü–µ–Ω—Ç–æ–≤
   - –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É
   - –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã Stripe (rate limits, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)

3. **–û—à–∏–±–∫–∞ 500: "Stripe –≤–µ—Ä–Ω—É–ª –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç"**
   ```json
   {
     "success": false,
     "message": "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PaymentIntent –≤ Stripe",
     "errorDetails": {
       "errorMessage": "Stripe –Ω–µ –≤–µ—Ä–Ω—É–ª client_secret –≤ –æ—Ç–≤–µ—Ç–µ. PaymentIntent ID: pi_xxxxx",
       "errorType": "StripeError",
       "errorCode": "STRIPE_ERROR",
       "requestId": "uuid-–∑–∞—è–≤–∫–∏",
       "userId": "uuid-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
       "amountCents": 100
     }
   }
   ```
   **–ü—Ä–∏—á–∏–Ω–∞:** Stripe API –≤–µ—Ä–Ω—É–ª PaymentIntent –±–µ–∑ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è `client_secret`. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å Stripe API –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.

4. **–û—à–∏–±–∫–∞ 500: –¢–∞–π–º–∞—É—Ç Stripe API (> 15 —Å–µ–∫—É–Ω–¥)**
   ```json
   {
     "success": false,
     "message": "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PaymentIntent –≤ Stripe",
     "errorDetails": {
       "errorMessage": "Stripe API timeout: —Å–æ–∑–¥–∞–Ω–∏–µ PaymentIntent –∑–∞–Ω—è–ª–æ –±–æ–ª—å—à–µ 15 —Å–µ–∫—É–Ω–¥",
       "errorType": "StripeError",
       "errorCode": "STRIPE_ERROR",
       "requestId": "uuid-–∑–∞—è–≤–∫–∏",
       "userId": "uuid-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
       "amountCents": 100
     }
   }
   ```
   **–ü—Ä–∏—á–∏–Ω–∞:** Stripe API –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –≤ —Ç–µ—á–µ–Ω–∏–µ 15 —Å–µ–∫—É–Ω–¥. –í–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é –∏–ª–∏ —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã Stripe. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å –ø–æ–∑–∂–µ.

5. **–û—à–∏–±–∫–∞ 500: "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: –∑–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞, –Ω–æ client_secret –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"**
   ```json
   {
     "success": false,
     "message": "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: –∑–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞, –Ω–æ client_secret –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç",
     "errorDetails": {
       "requestId": "uuid-–∑–∞—è–≤–∫–∏",
       "userId": "uuid-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
       "paymentIntentId": "pi_xxxxx",
       "amountCents": 100,
       "paymentIntentObject": {...},
       "note": "Stripe –≤–µ—Ä–Ω—É–ª PaymentIntent, –Ω–æ –±–µ–∑ client_secret. –í–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞ —Å –∞–∫–∫–∞—É–Ω—Ç–æ–º Stripe –∏–ª–∏ API –∫–ª—é—á–æ–º."
     }
   }
   ```
   **–ü—Ä–∏—á–∏–Ω–∞:** –ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ –≤ –ë–î, –Ω–æ Stripe –Ω–µ –≤–µ—Ä–Ω—É–ª `client_secret`. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∑–∞—è–≤–∫—É —á–µ—Ä–µ–∑ `DELETE /api/requests/:id` –∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞, –ª–∏–±–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞:**
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –≤—Å–µ –æ—à–∏–±–∫–∏ —Å –∫–æ–¥–æ–º 500 –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–ª–∞—Ç–Ω—ã—Ö –∑–∞—è–≤–æ–∫
- –ü–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ—à–∏–±–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (–∏–∑ `errorDetails.errorMessage`)
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º `client_secret` –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ - –ø—Ä–µ–¥–ª–æ–∂–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∑–∞—è–≤–∫—É –∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
- –î–ª—è —Ç–∞–π–º–∞—É—Ç–æ–≤ - –ø—Ä–µ–¥–ª–æ–∂–∏—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Flutter (—Å –æ–ø–ª–∞—Ç–æ–π):**
```dart
import 'package:http/http.dart' as http;
import 'dart:io';

Future<void> createRequestWithPayment({
  required String token,
  required String name,
  required String category,
  required int amountCents,
  List<File>? photos_before,
}) async {
  // –í–ê–ñ–ù–û: Endpoint /requests/create-with-payment —É–¥–∞–ª–µ–Ω
  // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ POST /api/requests –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏, –∑–∞—Ç–µ–º POST /api/donations –¥–ª—è –¥–æ–Ω–∞—Ç–∞
  final uri = Uri.parse('https://danilagames.ru/api/requests');
  final request = http.MultipartRequest('POST', uri);
  
  request.headers['Authorization'] = 'Bearer $token';
  
  // –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è
  request.fields['name'] = name;
  request.fields['category'] = category;
  request.fields['description'] = '–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏';
  request.fields['city'] = '–ú–æ—Å–∫–≤–∞';
  request.fields['latitude'] = '55.7558';
  request.fields['longitude'] = '37.6173';
  // require_payment —É–¥–∞–ª–µ–Ω - —Å–æ–∑–¥–∞–π—Ç–µ –∑–∞—è–≤–∫—É, –∑–∞—Ç–µ–º –¥–æ–Ω–∞—Ç —á–µ—Ä–µ–∑ POST /api/donations
  request.fields['amount_cents'] = amountCents.toString();
  request.fields['request_category'] = 'waste_location';
  
  // –§–∞–π–ª—ã
  if (photos_before != null) {
    for (var photo in photos_before) {
      final fileStream = http.ByteStream(photo.openRead());
      final length = await photo.length();
      final multipartFile = http.MultipartFile(
        'photos_before',
        fileStream,
        length,
        filename: photo.path.split('/').last,
      );
      request.files.add(multipartFile);
    }
  }
  
  final streamedResponse = await request.send();
  final response = await http.Response.fromStream(streamedResponse);
  
  if (response.statusCode == 201) {
    final data = jsonDecode(response.body);
    final paymentIntentId = data['data']['payment']['payment_intent_id'];
    final clientSecret = data['data']['payment']['client_secret'];
    // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ client_secret –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ Stripe SDK
  }
}
```

---

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏

**PUT** `/requests/:id`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** (—Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å –∏–ª–∏ –∞–¥–º–∏–Ω)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è (–Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–∏–Ω–æ–≤, –ø–µ—Ä–µ–≤–æ–¥ –¥–µ–Ω–µ–≥, –æ—Ç–ø—Ä–∞–≤–∫–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π).

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** (–≤—Å–µ –ø–æ–ª—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã)
```json
{
  "name": "–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ",
  "description": "–û–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ",
  "status": "pending",
  "completion_comment": "–ó–∞—è–≤–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞",
  "rejection_reason": "–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è",
  "rejection_message": "–ö–∞—Å—Ç–æ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞",
  "actual_participants": ["550e8400-e29b-41d4-a716-446655440000", "660e8400-e29b-41d4-a716-446655440001"],
  "joined_user_id": "550e8400-e29b-41d4-a716-446655440000",
  "join_date": "2024-01-01T10:00:00.000Z",
  "waste_types": ["plastic", "glass"]
}
```

**–í–∞–∂–Ω–æ - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- –í—Å–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (`joined_user_id`, —ç–ª–µ–º–µ–Ω—Ç—ã –≤ `actual_participants`) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **UUID –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö** (–ø–æ–ª–µ `id` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `users`)
- **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Firebase UID** - —Å–µ—Ä–≤–µ—Ä –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç Firebase UID, —Ç–æ–ª—å–∫–æ UUID –∏–∑ –ë–î
- –î–ª—è –æ—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –æ—Ç –∑–∞—è–≤–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `joined_user_id: null` –∏ `join_date: null`
- –§–æ—Ä–º–∞—Ç UUID: `xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx` (36 —Å–∏–º–≤–æ–ª–æ–≤ —Å –¥–µ—Ñ–∏—Å–∞–º–∏)

**–ü–æ–ª—è –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏:**
- `rejection_reason` (string) - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
- `rejection_message` (string) - –∫–∞—Å—Ç–æ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ)
- `status` (string) - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ (`pending`, `approved`, `rejected`, `completed`)

**–í–∞–∂–Ω–æ:**
- **–î–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `event` –∏ `wasteLocation`:** –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ `pending` —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç **–ó–ê–ü–†–ï–©–ï–ù–û**. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `POST /api/requests/:requestId/close-by-creator` –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –∑–∞—è–≤–∫–∏ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ `pending` (–¥–ª—è –¥—Ä—É–≥–∏—Ö —Ç–∏–ø–æ–≤ –∑–∞—è–≤–æ–∫) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—é
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ `approved` (–æ–¥–æ–±—Ä–µ–Ω–∏–µ) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ —Ç–∏–ø—É –∑–∞—è–≤–∫–∏ (—Å–º. —Ä–∞–∑–¥–µ–ª "–í–∞–∂–Ω–æ –æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ –∫–æ–∏–Ω–æ–≤")
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ `rejected` (–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ) –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –¥–µ–Ω—å–≥–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–í–∞–∂–Ω–æ –æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ –∫–æ–∏–Ω–æ–≤ –∏ –ª–æ–≥–∏–∫–µ —Å—Ç–∞—Ç—É—Å–æ–≤:**

### –õ–æ–≥–∏–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞—è–≤–æ–∫

**–°—Ç–∞—Ç—É—Å—ã:**
- `new` - —Å–æ–∑–¥–∞–Ω–∞, –æ–∂–∏–¥–∞–µ—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- ~~`pending_payment`~~ - **–£–î–ê–õ–ï–ù:** –¢–µ–ø–µ—Ä—å –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ –¥–æ–Ω–∞—Ç—ã
- `inProgress` - –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `pending` - –æ–∂–∏–¥–∞–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º
- `approved` - –æ–¥–æ–±—Ä–µ–Ω–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º
- `rejected` - –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º
- `completed` - –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- `archived` - –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ –≤—Ä—É—á–Ω—É—é)

**–õ–æ–≥–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º –∑–∞—è–≤–æ–∫:**

1. **–î–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `wasteLocation`:**
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏: —Å—Ç–∞—Ç—É—Å `new`
   - –ü—Ä–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è (`POST /api/requests/:id/join`): 
     - –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `inProgress`
     - –í `participant_completions` —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –¥–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `"inProgress"`
   - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ `POST /api/requests/:requestId/participant-completion`:
     - –°—Ç–∞—Ç—É—Å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ `participant_completions` –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `"pending"`
     - **–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ —Å—Ä–∞–∑—É –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `pending`** (–æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é)
     - **–ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—é** (—Å–æ–∑–¥–∞—Ç–µ–ª—å –Ω–µ –¥–æ–ª–∂–µ–Ω –Ω–∏—á–µ–≥–æ –¥–µ–ª–∞—Ç—å)
     - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º –æ –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–µ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
   - **–°–æ–∑–¥–∞—Ç–µ–ª—å –ù–ï –º–æ–∂–µ—Ç –æ–¥–æ–±—Ä—è—Ç—å/–æ—Ç–∫–ª–æ–Ω—è—Ç—å –∑–∞–∫—Ä—ã—Ç–∏–µ** - —ç–Ω–¥–ø–æ–∏–Ω—Ç `PATCH /api/requests/:requestId/participant-completion/:userId` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è `wasteLocation`
   - **–°–æ–∑–¥–∞—Ç–µ–ª—å –ù–ï –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å –∑–∞—è–≤–∫—É** - —ç–Ω–¥–ø–æ–∏–Ω—Ç `POST /api/requests/:requestId/close-by-creator` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è `wasteLocation`
   - –ü—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º (`PUT /api/requests/:id` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `approved`):
     - **–ù–∞—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ 1 –∫–æ–∏–Ω—É:** —Å–æ–∑–¥–∞—Ç–µ–ª—é, **–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é (joined_user_id)**, –≤—Å–µ–º –¥–æ–Ω–∞—Ç–µ—Ä–∞–º
     - –î–µ–Ω—å–≥–∏ (—Ç–æ–ª—å–∫–æ donations - –∫–æ–º–∏—Å—Å–∏—è) –ø–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é
     - –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `archived`
     - –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º
   - –ü—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ (`rejected`):
     - –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –¥–µ–Ω—å–≥–∏ —Å–æ–∑–¥–∞—Ç–µ–ª—é –∏ –¥–æ–Ω–∞—Ç–µ—Ä–∞–º
     - –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –ø—Ä–∏—á–∏–Ω–æ–π –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è

2. **–î–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `speedCleanup`:**
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏: —Å—Ç–∞—Ç—É—Å `new` –∏–ª–∏ `inProgress` (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–æ —è–≤–Ω–æ)
   - –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ: —Å—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `pending`
   - –ü—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ (`approved`):
     - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `start_date` –∏ `end_date`
     - –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ >= 20 –º–∏–Ω—É—Ç:
       - –ù–∞—á–∏—Å–ª—è–µ—Ç—Å—è 1 –∫–æ–∏–Ω **—Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—é** –∑–∞—è–≤–∫–∏
       - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—é: "Thank you! You've earned a coin for your cleanup work!"
     - –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ < 20 –º–∏–Ω—É—Ç:
       - –ö–æ–∏–Ω –Ω–µ –Ω–∞—á–∏—Å–ª—è–µ—Ç—Å—è
       - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—é: "Thank you! Try to work a bit longer next time to earn a coin."
     - –ó–∞—è–≤–∫–∞ **–ù–ï –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è** –≤ —Å—Ç–∞—Ç—É—Å `completed` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –æ—Å—Ç–∞–µ—Ç—Å—è –≤ `approved`
   - **–ß–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è (updated_at):**
     - –ó–∞—è–≤–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –≤ —Å—Ç–∞—Ç—É—Å `completed` (—á–µ—Ä–µ–∑ cron job)
     - –ù–∞—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ 1 –∫–æ–∏–Ω—É **–≤—Å–µ–º –¥–æ–Ω–∞—Ç–µ—Ä–∞–º** (–∏–∑ —Ç–∞–±–ª–∏—Ü—ã `donations`, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å)
     - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –¥–æ–Ω–∞—Ç–µ—Ä–∞–º
     - –í—Å–µ –¥–æ–Ω–∞—Ç—ã (–∑–∞ –≤—ã—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–∏) –ø–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é
   - –ü—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ (`rejected`):
     - –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –¥–µ–Ω—å–≥–∏ –¥–æ–Ω–∞—Ç–µ—Ä–∞–º (–µ—Å–ª–∏ –±—ã–ª–∏)
     - –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –ø—Ä–∏—á–∏–Ω–æ–π –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è

3. **–î–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `event`:**
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏: 
     - –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ `inProgress`
     - –°–æ–∑–¥–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `registered_participants`
     - –í `participant_completions` —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –¥–ª—è —Å–æ–∑–¥–∞—Ç–µ–ª—è —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `"inProgress"`
   - –î—Ä—É–≥–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ `POST /api/requests/:id/participate`:
     - –î–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `registered_participants`
     - –í `participant_completions` —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `"inProgress"`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤—Å–µ–º –∏–∑ `registered_participants` (24—á, 2—á –¥–æ —Å–æ–±—ã—Ç–∏—è, –Ω–∞—á–∞–ª–æ —Å–æ–±—ã—Ç–∏—è)
   - –ö–∞–∂–¥—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å —Å–≤–æ—é —Ä–∞–±–æ—Ç—É —á–µ—Ä–µ–∑ `POST /api/requests/:requestId/participant-completion` (–ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ —Å–æ–±—ã—Ç–∏—è):
     - –°—Ç–∞—Ç—É—Å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ `participant_completions` –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `"pending"`
     - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—é
   - –°–æ–∑–¥–∞—Ç–µ–ª—å –æ–¥–æ–±—Ä—è–µ—Ç/–æ—Ç–∫–ª–æ–Ω—è–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ —á–µ—Ä–µ–∑ `PATCH /api/requests/:requestId/participant-completion/:userId`:
     - –°—Ç–∞—Ç—É—Å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `"approved"` –∏–ª–∏ `"rejected"`
   - –°–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –∑–∞—è–≤–∫—É —á–µ—Ä–µ–∑ `POST /api/requests/:requestId/close-by-creator`:
     - –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `pending` (–æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ)
     - **–ö–æ–∏–Ω—ã –ù–ï –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è**
   - –ü—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º (`PUT /api/requests/:id` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `approved`):
     - **–ù–∞—á–∏—Å–ª—è–µ—Ç—Å—è –ø–æ 1 –∫–æ–∏–Ω—É:** –∑–∞–∫–∞–∑—á–∏–∫—É, **—Ç–æ–ª—å–∫–æ approved —É—á–∞—Å—Ç–Ω–∏–∫–∞–º** (–∏–∑ `participant_completions`), –≤—Å–µ–º –¥–æ–Ω–∞—Ç–µ—Ä–∞–º
     - –î–µ–Ω—å–≥–∏ (cost + donations - –∫–æ–º–∏—Å—Å–∏—è) –ø–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è –∑–∞–∫–∞–∑—á–∏–∫—É
     - –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `completed`
     - –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º
   - –ü—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ (`rejected`):
     - –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –¥–µ–Ω—å–≥–∏ –∑–∞–∫–∞–∑—á–∏–∫—É –∏ –¥–æ–Ω–∞—Ç–µ—Ä–∞–º
     - –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –ø—Ä–∏—á–∏–Ω–æ–π –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (Cron Jobs):**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –¥–ª—è waste (–∑–∞ 2 —á–∞—Å–∞ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å—Ä–æ–∫–∞) - –∫–∞–∂–¥—ã–µ 5-10 –º–∏–Ω—É—Ç
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è waste (24 —á–∞—Å–∞) - –∫–∞–∂–¥—ã–µ 5-10 –º–∏–Ω—É—Ç
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–∫–æ—Ä–æ–º —É–¥–∞–ª–µ–Ω–∏–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö waste –∑–∞—è–≤–æ–∫ (—á–µ—Ä–µ–∑ 7 –¥–Ω–µ–π) - –∫–∞–∂–¥—ã–µ 5-10 –º–∏–Ω—É—Ç
- –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö waste –∑–∞—è–≤–æ–∫ (—á–µ—Ä–µ–∑ 8 –¥–Ω–µ–π, –µ—Å–ª–∏ –Ω–µ –ø—Ä–æ–¥–ª–µ–Ω—ã) - –∫–∞–∂–¥—ã–µ 24 —á–∞—Å–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ —Å–æ–±—ã—Ç–∏—è –¥–ª—è event (24 —á–∞—Å–∞, 2 —á–∞—Å–∞, –Ω–∞—á–∞–ª–æ) - –∫–∞–∂–¥—ã–µ 5-10 –º–∏–Ω—É—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥ speedCleanup –≤ completed (24 —á–∞—Å–∞ –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è) - –∫–∞–∂–¥—ã–µ 5-10 –º–∏–Ω—É—Ç

---

### –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏

**DELETE** `/requests/:id`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** (—Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å –∏–ª–∏ –∞–¥–º–∏–Ω)

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–ó–∞—è–≤–∫–∞ —É–¥–∞–ª–µ–Ω–∞"
}
```

---

### –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∑–∞—è–≤–∫–µ (wasteLocation)

**POST** `/requests/:id/join`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∑–∞—è–≤–∫–µ —Ç–∏–ø–∞ `wasteLocation`. –ü—Ä–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏:
- –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `inProgress`
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è `joined_user_id` –∏ `join_date`
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—é –∑–∞—è–≤–∫–∏

**–í–∞–∂–Ω–æ:**
- –ö –∑–∞—è–≤–∫–µ –º–æ–∂–Ω–æ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å `new`
- –ö –∑–∞—è–≤–∫–µ –º–æ–∂–µ—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —á–µ–ª–æ–≤–µ–∫
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª –∑–∞—è–≤–∫—É –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤, –∑–∞—è–≤–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Å—Ç–∞—Ç—É—Å `new` –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω–æ–π –¥–ª—è –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å–Ω–æ–≤–∞

**–î–ª—è –ø–ª–∞—Ç–Ω—ã—Ö –∑–∞—è–≤–æ–∫:**
**–í–ê–ñ–ù–û:** –°—Ç–∞—Ç—É—Å `pending_payment` —É–¥–∞–ª–µ–Ω. –¢–µ–ø–µ—Ä—å –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –∏–¥—É—Ç —á–µ—Ä–µ–∑ –¥–æ–Ω–∞—Ç—ã, –∑–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º —Å—Ç–∞—Ç—É—Å–æ–º.
- –ï—Å–ª–∏ –æ–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞ (`succeeded`), —Å—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `new` –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è
- –ï—Å–ª–∏ –æ–ø–ª–∞—Ç–∞ –Ω–µ –ø—Ä–æ—à–ª–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ 400 —Å –¥–µ—Ç–∞–ª—è–º–∏
- –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã, –Ω–µ –¥–æ–∂–∏–¥–∞—è—Å—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ webhook

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ –∑–∞—è–≤–∫–µ"
}
```

**–û—à–∏–±–∫–∞ (400) - –ù–µ–≤–µ—Ä–Ω—ã–π —Å—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏:**
```json
{
  "success": false,
  "message": "–ö —ç—Ç–æ–π –∑–∞—è–≤–∫–µ –Ω–µ–ª—å–∑—è –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è"
}
```

**–û—à–∏–±–∫–∞ (400) - –ó–∞—è–≤–∫–∞ –æ–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã:**
```json
{
  "success": false,
  "message": "–ó–∞—è–≤–∫–∞ –æ–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≤–µ—Ä—à–∏—Ç–µ –æ–ø–ª–∞—Ç—É.",
  "timestamp": "2026-01-13T10:00:00.000Z",
  "errorDetails": {
    "paymentStatus": "requires_payment_method",
    "paymentIntentId": "pi_xxx",
    "note": "–û–ø–ª–∞—Ç–∞ –µ—â–µ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –≤ Stripe"
  }
}
```

**–û—à–∏–±–∫–∞ (409):**
```json
{
  "success": false,
  "message": "–ö –∑–∞—è–≤–∫–µ —É–∂–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –¥—Ä—É–≥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å"
}
```

**–û—à–∏–±–∫–∞ (500) - –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–ø–ª–∞—Ç—ã:**
```json
{
  "success": false,
  "message": "–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–ø–ª–∞—Ç—ã",
  "timestamp": "2026-01-13T10:00:00.000Z",
  "errorDetails": {
    "errorMessage": "No such payment_intent: 'pi_xxx'",
    "paymentIntentId": "pi_xxx",
    "note": "–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã –≤ Stripe"
  }
}
```

---

### –£—á–∞—Å—Ç–∏–µ –≤ —Å–æ–±—ã—Ç–∏–∏ (event)

**POST** `/requests/:id/participate`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ —Å–æ–±—ã—Ç–∏—é —Ç–∏–ø–∞ `event`. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (`registered_participants`). –°–æ–∑–¥–∞—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è.

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —É—á–∞—Å—Ç–∏–∏:**
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `registered_participants`
- ‚úÖ –í `participant_completions` —Å–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `"inProgress"`
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç –∑–∞—è–≤–∫–∏ (`group_chat_id`)
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç** –º–µ–∂–¥—É —É—á–∞—Å—Ç–Ω–∏–∫–æ–º –∏ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º –∑–∞—è–≤–∫–∏
- ‚úÖ –ü—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤ `private_chats` –∑–∞—è–≤–∫–∏
- ‚úÖ –ü—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —É—á–∞—Å—Ç–∏—è

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ —Å–æ–±—ã—Ç–∏—é"
}
```

**–û—Ç–º–µ–Ω–∞ —É—á–∞—Å—Ç–∏—è:**

**DELETE** `/requests/:id/participate`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–û—Ç–º–µ–Ω–∞ —É—á–∞—Å—Ç–∏—è –≤ —Å–æ–±—ã—Ç–∏–∏ —Ç–∏–ø–∞ `event`. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ —Å–ø–∏—Å–∫–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (`registered_participants`). –°–æ–∑–¥–∞—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏—è –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å —É—á–∞—Å—Ç–∏–µ.

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ —É—á–∞—Å—Ç–∏—è:**
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ `registered_participants`
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞ –∑–∞—è–≤–∫–∏
- ‚úÖ **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –º–∞—Å—Å–∏–≤–∞ `private_chats` –∑–∞—è–≤–∫–∏**
- ‚úÖ –ó–∞–ø–∏—Å—å –≤ `participant_completions` –¥–ª—è —ç—Ç–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è (–¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏)

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–£—á–∞—Å—Ç–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ"
}
```

---

### –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ waste

**POST** `/requests/:id/extend`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** (—Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü—Ä–æ–¥–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ —Ç–∏–ø–∞ `wasteLocation` –µ—â–µ –Ω–∞ –Ω–µ–¥–µ–ª—é. –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞—è–≤–æ–∫ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `new`, –∫–æ—Ç–æ—Ä—ã–µ –µ—â–µ –Ω–µ –∏—Å—Ç–µ–∫–ª–∏ –∏ –Ω–µ –±—ã–ª–∏ –ø—Ä–æ–¥–ª–µ–Ω—ã —Ä–∞–Ω–µ–µ (–º–∞–∫—Å–∏–º—É–º –æ–¥–Ω–æ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ).

**–õ–æ–≥–∏–∫–∞:**
- –ß–µ—Ä–µ–∑ 7 –¥–Ω–µ–π –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ —Å–æ–∑–¥–∞—Ç–µ–ª—é –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –∑–∞—è–≤–∫–∞ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞, –∏ –æ–Ω –º–æ–∂–µ—Ç –ø—Ä–æ–¥–ª–∏—Ç—å –µ–µ
- –°–æ–∑–¥–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ–¥–ª–∏—Ç—å –∑–∞—è–≤–∫—É –µ—â–µ –Ω–∞ –Ω–µ–¥–µ–ª—é, –≤—ã–∑–≤–∞–≤ —ç—Ç–æ—Ç endpoint
- –ï—Å–ª–∏ –∑–∞—è–≤–∫–∞ –Ω–µ –±—ã–ª–∞ –ø—Ä–æ–¥–ª–µ–Ω–∞, —á–µ—Ä–µ–∑ 8 –¥–Ω–µ–π (7 –¥–Ω–µ–π + 1 –¥–µ–Ω—å –æ–∂–∏–¥–∞–Ω–∏—è) –æ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –¢–æ–ª—å–∫–æ –¥–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `wasteLocation`
- –¢–æ–ª—å–∫–æ –¥–ª—è –∑–∞—è–≤–æ–∫ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `new`
- –¢–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ –º–æ–∂–µ—Ç –ø—Ä–æ–¥–ª–∏—Ç—å –µ–µ
- –ú–∞–∫—Å–∏–º—É–º –æ–¥–Ω–æ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ (`extended_count` –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å >= 1)
- –ó–∞—è–≤–∫–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∏—Å—Ç–µ–∫—à–µ–π (`expires_at` > —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è)

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "–£–±–æ—Ä–∫–∞ –ø–∞—Ä–∫–∞",
    "category": "wasteLocation",
    "status": "new",
    "expires_at": "2025-12-10T12:00:00.000Z",
    "extended_count": 1,
    ...
  }
}
```

**–û—à–∏–±–∫–∏:**
- `404` - –ó–∞—è–≤–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- `400` - –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ wasteLocation
- `400` - –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞—è–≤–æ–∫ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º new
- `400` - –ó–∞—è–≤–∫–∞ —É–∂–µ –±—ã–ª–∞ –ø—Ä–æ–¥–ª–µ–Ω–∞. –ú–∞–∫—Å–∏–º—É–º –æ–¥–Ω–æ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ.
- `400` - –ó–∞—è–≤–∫–∞ —É–∂–µ –∏—Å—Ç–µ–∫–ª–∞ –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–¥–ª–µ–Ω–∞
- `403` - –¢–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ –º–æ–∂–µ—Ç –ø—Ä–æ–¥–ª–∏—Ç—å –µ–µ

---

### –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–±—ã—Ç–∏—è (event)

**‚ö†Ô∏è DEPRECATED:** –≠—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –æ—Ç–∫–ª—é—á–µ–Ω.

**PUT** `/requests/:id/close-event` - **–ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø**

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ:** `POST /api/requests/:requestId/close-by-creator`

–î–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `event` –∏ `wasteLocation` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç `POST /api/requests/:requestId/close-by-creator`, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Å–∏—Å—Ç–µ–º–æ–π `participant_completions`.

---

### –ó–∞–∫—Ä—ã—Ç–∏–µ —Ä–∞–±–æ—Ç—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–º

**POST** `/requests/:requestId/participant-completion`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–£—á–∞—Å—Ç–Ω–∏–∫ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–≤–æ—é —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç—ã. –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `wasteLocation` –∏ `event`. 

**‚ö†Ô∏è –†–ê–ó–õ–ò–ß–ò–Ø –ü–û –¢–ò–ü–ê–ú –ó–ê–Ø–í–û–ö:**

**–î–ª—è `wasteLocation`:**
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ñ–æ—Ç–æ –ø–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã (`photos_after`)
- –£–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –º–µ—Å—Ç–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è `participant_completions[userId].status` –Ω–∞ `"pending"`
- **–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ (`request.status`) —Å—Ä–∞–∑—É –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `"pending"`** - –∑–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é
- **–ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—é** (—Å–æ–∑–¥–∞—Ç–µ–ª—å –Ω–µ –¥–æ–ª–∂–µ–Ω –Ω–∏—á–µ–≥–æ –¥–µ–ª–∞—Ç—å)
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º –æ –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–µ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏

**–î–ª—è `event`:**
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ñ–æ—Ç–æ –ø–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã (`photos_after`)
- –£–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –º–µ—Å—Ç–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
- –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û `participant_completions[userId].status` –Ω–∞ `"pending"`
- **–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ (`request.status`) –ù–ï –º–µ–Ω—è–µ—Ç—Å—è** - –æ—Å—Ç–∞–µ—Ç—Å—è `"inProgress"`
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª—é –∑–∞—è–≤–∫–∏

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–º –∑–∞—è–≤–∫–∏:
  - –î–ª—è `event`: –≤ `registered_participants`
  - –î–ª—è `wasteLocation`: –≤ `joined_user_id`
- –î–ª—è `event`: —Å–æ–±—ã—Ç–∏–µ –¥–æ–ª–∂–Ω–æ –Ω–∞—á–∞—Ç—å—Å—è (`start_date <= now()`)
- –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `"inProgress"`

**–í–∞–∂–Ω–æ:** –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –≤–∏–¥–µ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ `multipart/form-data`. URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –Ω–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è.

**Content-Type:** `multipart/form-data`

**–ü–æ–ª—è —Ñ–æ—Ä–º—ã:**
- `photos_after` (file[], –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –ø–æ—Å–ª–µ —Ä–∞–±–æ—Ç—ã (–º–∏–Ω–∏–º—É–º 1 —Ñ–æ—Ç–æ)
- `completion_comment` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É—á–∞—Å—Ç–Ω–∏–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Ä–∞–±–æ—Ç—ã
- `completion_latitude` (number, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - —à–∏—Ä–æ—Ç–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –º–æ–º–µ–Ω—Ç –∑–∞–∫—Ä—ã—Ç–∏—è
- `completion_longitude` (number, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - –¥–æ–ª–≥–æ—Ç–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –º–æ–º–µ–Ω—Ç –∑–∞–∫—Ä—ã—Ç–∏—è

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–ó–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞ –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é", // –î–ª—è wasteLocation
  // –∏–ª–∏ "–†–∞–±–æ—Ç–∞ –∑–∞–∫—Ä—ã—Ç–∞, –æ–∂–∏–¥–∞–µ—Ç –æ–¥–æ–±—Ä–µ–Ω–∏—è" // –î–ª—è event
  "data": {
    "request": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "status": "pending", // –î–ª—è wasteLocation —Å—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ pending
      // –∏–ª–∏ "inProgress" // –î–ª—è event —Å—Ç–∞—Ç—É—Å –æ—Å—Ç–∞–µ—Ç—Å—è inProgress
      "participant_completions": {
        "user_id_1": {
          "status": "pending",
          "photos_after": ["https://danilagames.ru/uploads/photos/uuid1.jpg"],
          "completion_comment": "–£–±—Ä–∞–ª –≤–µ—Å—å –º—É—Å–æ—Ä",
          "completion_latitude": 56.4962847,
          "completion_longitude": 84.9802779,
          "rejection_reason": null,
          "completed_at": "2025-12-21T13:35:00.000Z"
        }
      },
      ...
    }
  }
}
```

**–û—à–∏–±–∫–∏:**
- `404` - –ó–∞—è–≤–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- `400` - –≠—Ç–æ—Ç —Ç–∏–ø –∑–∞—è–≤–∫–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ —Ä–∞–±–æ—Ç—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–º
- `400` - –ó–∞—è–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ inProgress
- `403` - –í—ã –Ω–µ —è–≤–ª—è–µ—Ç–µ—Å—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–º —ç—Ç–æ–π –∑–∞—è–≤–∫–∏
- `400` - –°–æ–±—ã—Ç–∏–µ –µ—â–µ –Ω–µ –Ω–∞—á–∞–ª–æ—Å—å (—Ç–æ–ª—å–∫–æ –¥–ª—è event)
- `400` - –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–∏–Ω–∏–º—É–º –æ–¥–Ω–æ —Ñ–æ—Ç–æ
- `400` - –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã

---

### –û–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Ä–∞–±–æ—Ç—ã —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º

**PATCH** `/requests/:requestId/participant-completion/:userId`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** (—Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ –∏–ª–∏ –∞–¥–º–∏–Ω)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ –æ–¥–æ–±—Ä—è–µ—Ç –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ —Ä–∞–±–æ—Ç—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–º. –ü—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `"approved"`, –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ - –Ω–∞ `"rejected"` —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–∏—á–∏–Ω—ã.

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –≠—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç **–ù–ï–î–û–°–¢–£–ü–ï–ù –¥–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `wasteLocation`**. –î–ª—è `wasteLocation` —Å–æ–∑–¥–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –æ–¥–æ–±—Ä—è—Ç—å/–æ—Ç–∫–ª–æ–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É —É—á–∞—Å—Ç–Ω–∏–∫–∞ - –∑–∞—è–≤–∫–∞ —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é –∞–¥–º–∏–Ω–∞–º.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –¢–∏–ø –∑–∞—è–≤–∫–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `event` (–¥–ª—è `wasteLocation` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ 403)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º –∑–∞—è–≤–∫–∏ (`created_by`) –∏–ª–∏ –∞–¥–º–∏–Ω–æ–º
- –£—á–∞—Å—Ç–Ω–∏–∫ –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Å—Ç–∞—Ç—É—Å `"pending"` –≤ `participant_completions`

**Content-Type:** `application/json`

**Body:**
```json
{
  "action": "approve" | "reject",
  "rejection_reason": "string" // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏ action="reject"
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–ó–∞–∫—Ä—ã—Ç–∏–µ —Ä–∞–±–æ—Ç—ã –æ–¥–æ–±—Ä–µ–Ω–æ",
  "data": {
    "request": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "participant_completions": {
        "user_id_1": {
          "status": "approved",
          "photos_after": ["https://danilagames.ru/uploads/photos/uuid1.jpg"],
          "completion_comment": "–£–±—Ä–∞–ª –≤–µ—Å—å –º—É—Å–æ—Ä",
          "completion_latitude": 56.4962847,
          "completion_longitude": 84.9802779,
          "rejection_reason": null,
          "completed_at": "2025-12-21T13:35:00.000Z"
        }
      },
      ...
    }
  }
}
```

**–û—à–∏–±–∫–∏:**
- `404` - –ó–∞—è–≤–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- `404` - –£—á–∞—Å—Ç–Ω–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ participant_completions
- `400` - –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å action: approve –∏–ª–∏ reject
- `400` - –ü—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å rejection_reason
- `400` - –°—Ç–∞—Ç—É—Å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å pending
- `403` - –î–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ wasteLocation –æ–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ
- `403` - –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω. –¢–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ –º–æ–∂–µ—Ç –æ–¥–æ–±—Ä—è—Ç—å/–æ—Ç–∫–ª–æ–Ω—è—Ç—å –∑–∞–∫—Ä—ã—Ç–∏–µ —Ä–∞–±–æ—Ç—ã

---

### –ó–∞–∫—Ä—ã—Ç–∏–µ –∑–∞—è–≤–∫–∏ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º

**POST** `/requests/:requestId/close-by-creator`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** (—Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –∑–∞—è–≤–∫—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ—ë –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ. –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏:
- –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `"pending"` (–¥–ª—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –≤ –∞–¥–º–∏–Ω–∫–µ)
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
- **–ö–æ–∏–Ω—ã –ù–ï –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è** - –æ–Ω–∏ –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –≠—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç **–ù–ï–î–û–°–¢–£–ü–ï–ù –¥–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `wasteLocation`**. –î–ª—è `wasteLocation` —Å–æ–∑–¥–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å –∑–∞—è–≤–∫—É - —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏ –ø—Ä–æ–¥–ª–µ–≤–∞—Ç—å. –ó–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º —á–µ—Ä–µ–∑ `/participant-completion`.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –¢–∏–ø –∑–∞—è–≤–∫–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `event` (–¥–ª—è `wasteLocation` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ 403)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º –∑–∞—è–≤–∫–∏ (`created_by`)
- **–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–≤—à–∏–π—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï –ú–û–ñ–ï–¢ –∑–∞–∫—Ä—ã—Ç—å –∑–∞—è–≤–∫—É** - —Ç–æ–ª—å–∫–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å–≤–æ—é —á–∞—Å—Ç—å —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ `/participant-completion`
- –ó–∞—è–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ `"inProgress"`

**Content-Type:** `application/json`

**Body:**
```json
{
  "completion_comment": "string" // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–ó–∞—è–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞ –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ",
  "data": {
    "request": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "status": "pending",
      "completion_comment": "–í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ —Ä–∞–±–æ—Ç—É",
      "participant_completions": {
        "user_id_1": {
          "status": "approved",
          ...
        },
        "user_id_2": {
          "status": "pending",
          ...
        }
      },
      ...
    }
  }
}
```

**–û—à–∏–±–∫–∏:**
- `404` - –ó–∞—è–≤–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- `400` - –≠—Ç–æ—Ç —Ç–∏–ø –∑–∞—è–≤–∫–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º
- `400` - –ó–∞—è–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ inProgress
- `403` - –î–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ wasteLocation —Å–æ–∑–¥–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å –∑–∞—è–≤–∫—É
- `403` - –¢–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å –∑–∞—è–≤–∫—É

**–í–∞–∂–Ω–æ –æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ –∫–æ–∏–Ω–æ–≤:**
- –ö–æ–∏–Ω—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è **—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º** (`PUT /api/requests/:id` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `approved`)
- –ü–æ–ª—É—á–∞—é—Ç –∫–æ–∏–Ω—ã:
  - –°–æ–∑–¥–∞—Ç–µ–ª—é –∑–∞—è–≤–∫–∏: 1 –∫–æ–∏–Ω
  - –î–ª—è `wasteLocation`: –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é (`joined_user_id`) - 1 –∫–æ–∏–Ω
  - –î–ª—è `event`: —Ç–æ–ª—å–∫–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `"approved"` –≤ `participant_completions` - –ø–æ 1 –∫–æ–∏–Ω—É
  - –í—Å–µ–º –¥–æ–Ω–∞—Ç–µ—Ä–∞–º: –ø–æ 1 –∫–æ–∏–Ω—É
- –ï—Å–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫ –∑–∞–∫—Ä—ã–ª —Ä–∞–±–æ—Ç—É –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –∑–∞—è–≤–∫–∏ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º (–¥–ª—è `event`), –æ–Ω –Ω–µ –ø–æ–ª—É—á–∏—Ç –∫–æ–∏–Ω—ã –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º

---

**–û—à–∏–±–∫–∞ (400):**
```json
{
  "success": false,
  "message": "–°–æ–±—ã—Ç–∏–µ –µ—â–µ –Ω–µ –Ω–∞—á–∞–ª–æ—Å—å"
}
```

---

## üí∞ –î–æ–Ω–∞—Ç—ã

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –¥–æ–Ω–∞—Ç–æ–≤

**GET** `/donations`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page`, `limit` - –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- `requestId` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∑–∞—è–≤–∫–µ
- `user_id` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "donations": [
      {
        "id": "uuid",
        "request_id": "uuid",
        "user_id": "uuid",
        "amount": 1000,
        "payment_intent_id": "pi_xxx",
        "created_at": "2024-01-01T00:00:00.000Z",
        "user_name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "user_email": "user@example.com",
        "request_name": "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 50,
      "totalPages": 3
    }
  }
}
```

---

### –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–Ω–∞—Ç–∞

**POST** `/donations`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "requestId": "uuid",
  "amount": 1000,
  "paymentIntentId": "pi_xxx"
}
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "success": true,
  "message": "–î–æ–Ω–∞—Ç —Å–æ–∑–¥–∞–Ω",
  "data": {
    "donation": {
      "id": "uuid",
      "request_id": "uuid",
      "user_id": "uuid",
      "amount": 1000,
      "payment_intent_id": "pi_xxx",
      "created_at": "2024-01-01T00:00:00.000Z"
    }
  }
}
```

---

## üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏

### –ü–æ–ª—É—á–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∑–∞—è–≤–∫–∏

**GET** `/participants?requestId=uuid`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è `event`). –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏–∑ `actual_participants` (–µ—Å–ª–∏ —Å–æ–±—ã—Ç–∏–µ —É–∂–µ –∑–∞–∫—Ä—ã—Ç–æ) –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏–∑ `registered_participants`.

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "participants": [
      {
        "id": "uuid",
        "display_name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "photo_url": "url",
        "email": "user@example.com"
      }
    ]
  }
}
```

---

### –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥—á–∏–∫–æ–≤ –∑–∞—è–≤–∫–∏

**GET** `/participants/contributors?requestId=uuid`

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "contributors": [
      {
        "user_id": "uuid",
        "amount": 1000,
        "display_name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
        "photo_url": "url",
        "email": "user@example.com"
      }
    ]
  }
}
```

---

## üí¨ –ß–∞—Ç—ã

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —á–∞—Ç–æ–≤

**GET** `/chats`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —á–∞—Ç–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –í—Å–µ —á–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–∞ —á–∞—Ç–∞ –µ–≥–æ –ø–æ–ª—è–º. –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π —Ç–∏–ø —á–∞—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è.

**–í–∞–∂–Ω–æ:**
- **–í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–∞—Ç—ã, –≥–¥–µ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ.** –ü—É—Å—Ç—ã–µ —á–∞—Ç—ã (–±–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏–π) –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è.
- –≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Ç—ã.

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `type` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É (`support`, `private`, `group`)
- `limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20, –º–∞–∫—Å–∏–º—É–º 100)
- `offset` - —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "chats": [
      {
        "id": "uuid",
        "type": "support",
        "user_id": "uuid",
        "request_id": null,
        "created_at": "2024-01-01T00:00:00.000Z",
        "last_message_at": "2024-01-01T00:00:00.000Z",
        "unread_count": 5,
        "participants_count": 3,
        "last_message": {
          "id": "uuid",
          "message": "–ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ",
          "sender_id": "uuid",
          "created_at": "2024-01-01T00:00:00.000Z"
        }
      }
    ],
    "total": 10
  }
}
```

**–í–∞–∂–Ω–æ:**
- –ü–æ–ª–µ `type` –≤—Å–µ–≥–¥–∞ —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–µ
- –ü–æ–ª–µ `participants_count` –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —á–∞—Ç–æ–≤
- –¢–∏–ø—ã —á–∞—Ç–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –∏ –∏—Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

---

### –ß–∞—Ç —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏

#### –ü–æ–ª—É—á–∏—Ç—å —á–∞—Ç —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏

**GET** `/chats/support`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–ª—É—á–∏—Ç—å —á–∞—Ç —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "type": "support",
    "user_id": "uuid",
    "request_id": null,
    "created_at": "2024-01-01T00:00:00.000Z",
    "last_message_at": "2024-01-01T00:00:00.000Z",
    "unread_count": 5,
    "participants_count": 3
  }
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –î–ª—è `support` —á–∞—Ç–∞: `request_id` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `null`, `user_id` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω
- –î–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω `support` —á–∞—Ç
- –ï—Å–ª–∏ —á–∞—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π (—Å—Ç–∞—Ç—É—Å 200, –Ω–µ 201)

#### –°–æ–∑–¥–∞—Ç—å —á–∞—Ç —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏

**POST** `/chats/support`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–æ–∑–¥–∞—Ç—å —á–∞—Ç —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç). –ï—Å–ª–∏ —á–∞—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —á–∞—Ç —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 200 (–Ω–µ 201).

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `request_id` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `null` (–Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è)
- `user_id` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ ID —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –î–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω `support` —á–∞—Ç
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤—Å–µ –∞–¥–º–∏–Ω—ã –≤ —É—á–∞—Å—Ç–Ω–∏–∫–∏

**–û—Ç–≤–µ—Ç (200):** –ï—Å–ª–∏ —á–∞—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
**–û—Ç–≤–µ—Ç (201):** –ï—Å–ª–∏ —á–∞—Ç —Å–æ–∑–¥–∞–Ω
–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ GET `/chats/support`

---

### –ü—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç

#### –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç

**GET** `/chats/private/:requestId`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç —Å —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º –∑–∞—è–≤–∫–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `requestId` - ID –∑–∞—è–≤–∫–∏

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "type": "private",
    "request_id": "uuid",
    "user_id": "uuid",
    "created_at": "2024-01-01T00:00:00.000Z",
    "last_message_at": "2024-01-01T00:00:00.000Z",
    "unread_count": 2,
    "participants_count": 2
  }
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –î–ª—è `private` —á–∞—Ç–∞: `request_id` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω, `user_id` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω
- –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–æ–≤–Ω–æ 2
- **–î–ª—è –∫–∞–∂–¥–æ–π –∑–∞—è–≤–∫–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç** (–æ–¥–∏–Ω –Ω–∞ –∑–∞—è–≤–∫—É)
- –ü–æ–∏—Å–∫ —á–∞—Ç–∞ –∏–¥–µ—Ç –ø–æ `request_id` –∏ —Ç–∏–ø—É `private`, –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

#### –°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç

**POST** `/chats/private`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç –º–µ–∂–¥—É –¥–≤—É–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏. **–î–ª—è –∫–∞–∂–¥–æ–π –∑–∞—è–≤–∫–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç.** –ï—Å–ª–∏ —á–∞—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–ª—è –¥–∞–Ω–Ω–æ–π –∑–∞—è–≤–∫–∏, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —á–∞—Ç —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 200 (–Ω–µ 201).

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `request_id` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω (–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å `null`)
- `user_id_1` –∏ `user_id_2` –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
- –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–æ–≤–Ω–æ 2
- **–î–ª—è –∫–∞–∂–¥–æ–π –∑–∞—è–≤–∫–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø—Ä–∏–≤–∞—Ç–Ω—ã–π —á–∞—Ç** (–æ–¥–∏–Ω –Ω–∞ –∑–∞—è–≤–∫—É)
- –ü–æ–∏—Å–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —á–∞—Ç–∞ –∏–¥–µ—Ç –ø–æ `request_id` –∏ —Ç–∏–ø—É `private`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "user_id_1": "uuid",
  "user_id_2": "uuid",
  "request_id": "uuid" // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `user_id_1` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - ID –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `user_id_2` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - ID –≤—Ç–æ—Ä–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `request_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) - ID –∑–∞—è–≤–∫–∏, —Å –∫–æ—Ç–æ—Ä–æ–π —Å–≤—è–∑–∞–Ω —á–∞—Ç

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏):**
```json
{
  "request_id": "uuid"
}
```
–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–∞—Ç –º–µ–∂–¥—É —Ç–µ–∫—É—â–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (–∫—Ç–æ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å) –∏ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–º –∑–∞—è–≤–∫–∏.

**–û—Ç–≤–µ—Ç (200):** –ï—Å–ª–∏ —á–∞—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
**–û—Ç–≤–µ—Ç (201):** –ï—Å–ª–∏ —á–∞—Ç —Å–æ–∑–¥–∞–Ω
–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ GET `/chats/private/:requestId`

---

### –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç

**–í–∞–∂–Ω–æ:** 
- –ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏ –ª—é–±–æ–≥–æ —Ç–∏–ø–∞ (wasteLocation, speedCleanup, event)
- **–î–ª—è –∫–∞–∂–¥–æ–π –∑–∞—è–≤–∫–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç** (–æ–¥–∏–Ω –Ω–∞ –∑–∞—è–≤–∫—É)
- **–°–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏**
- **–õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –≥—Ä—É–ø–ø–æ–≤–æ–º—É —á–∞—Ç—É, –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–∏–≤ –≤ –Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–µ** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —è–≤–Ω–æ–≥–æ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ —á–∞—Ç—É - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ

#### –ü–æ–ª—É—á–∏—Ç—å –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç

**GET** `/chats/group/:requestId`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–ª—É—á–∏—Ç—å –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç –∑–∞—è–≤–∫–∏. –ï—Å–ª–∏ —á–∞—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤–µ—Ä–Ω–µ—Ç—Å—è –æ—à–∏–±–∫–∞ 404.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `requestId` - ID –∑–∞—è–≤–∫–∏

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "type": "group",
    "request_id": "uuid",
    "created_at": "2024-01-01T00:00:00.000Z",
    "last_message_at": "2024-01-01T00:00:00.000Z",
    "unread_count": 3,
    "participants_count": 5
  }
}
```

#### –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç

**POST** `/chats/group`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç –¥–ª—è –∑–∞—è–≤–∫–∏ (–µ—Å–ª–∏ –æ–Ω –Ω–µ –±—ã–ª —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏). –ï—Å–ª–∏ —á–∞—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —á–∞—Ç —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º 200 (–Ω–µ 201). –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤:

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `request_id` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω (–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å `null`)
- `user_id` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `null` –¥–ª—è group —á–∞—Ç–æ–≤
- –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 2
- –î–ª—è –æ–¥–Ω–æ–π –∑–∞—è–≤–∫–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω `group` —á–∞—Ç
- –°–æ–∑–¥–∞—Ç–µ–ª—è –∑–∞—è–≤–∫–∏ (`created_by`)
- –¢–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç —á–∞—Ç)
- –î–ª—è waste: –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–≤—à–µ–≥–æ—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`joined_user_id`, –µ—Å–ª–∏ –µ—Å—Ç—å)
- –î–ª—è event: –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (`registered_participants`)
- –í—Å–µ—Ö –¥–æ–Ω–∞—Ç–µ—Ä–æ–≤ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `donations`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –û–±—ã—á–Ω–æ —ç—Ç–æ—Ç endpoint –Ω–µ –Ω—É–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é, —Ç–∞–∫ –∫–∞–∫ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —á–∞—Ç –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ –Ω–µ –±—ã–ª —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "request_id": "uuid"
}
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "success": true,
  "message": "–ì—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç —Å–æ–∑–¥–∞–Ω",
  "data": {
    "id": "uuid",
    "type": "group",
    "request_id": "uuid",
    "created_by": "uuid",
    "created_at": "2024-01-01T00:00:00.000Z",
    "last_message_at": "2024-01-01T00:00:00.000Z",
    "unread_count": 0,
    "participants_count": 5
  }
}
```

**–û—à–∏–±–∫–∏:**
- `400` - `request_id –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω` - –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω request_id
- `404` - `–ó–∞—è–≤–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞` - –∑–∞—è–≤–∫–∞ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º ID –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- `500` - `–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**
–ï—Å–ª–∏ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–π –∑–∞—è–≤–∫–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —á–∞—Ç (—Å—Ç–∞—Ç—É—Å 200) –≤–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ.

---

### –°–æ–æ–±—â–µ–Ω–∏—è

#### –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π

**GET** `/chats/:chatId/messages`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞. **–í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º `chatId` –∏–∑ URL.** –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–¥—É—Ç –ø–æ `chatId` –∏–∑ URL, –±–µ–∑ –ø–æ–∏—Å–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–ª–∏ –∑–∞—è–≤–∫–∞–º. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `chatId` (–≤ URL) - ID —á–∞—Ç–∞, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –ø–æ–ª—É—á–∞—é—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ —á–∞—Ç —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º `chatId` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –î–ª—è **–≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤**: –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º, –æ–Ω **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —É—á–∞—Å—Ç–Ω–∏–∫–∏** –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- –î–ª—è **–ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —á–∞—Ç–æ–≤**: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º —ç—Ç–æ–≥–æ —á–∞—Ç–∞
- –î–ª—è **—á–∞—Ç–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∫–∏**: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º —ç—Ç–æ–≥–æ —á–∞—Ç–∞
- –í–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è —Å `chat_id = chatId` –∏–∑ URL

**‚ö†Ô∏è –í–ê–ñ–ù–û –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:**
- –î–ª—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤ **–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —è–≤–Ω–æ–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ —á–∞—Ç—É (–ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∞)
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –º–æ–∂–µ—Ç —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∏–∑ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —á–∞—Ç–∞, –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—è, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–º

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50, –º–∞–∫—Å–∏–º—É–º 100)
- `offset` - —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
- `before` - –ø–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∞—Ç—ã (ISO 8601)

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "messages": [
      {
        "id": "uuid",
        "chat_id": "uuid",
        "sender_id": "uuid",
        "sender": {
          "id": "uuid",
          "display_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
          "photo_url": "url"
        },
        "message": "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è",
        "message_type": "text",
        "created_at": "2024-01-01T00:00:00.000Z",
        "read_by": ["uuid", "uuid"],
        "unread_by": ["uuid"]
      }
    ],
    "total": 100,
    "has_more": true
  }
}
```

#### –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ (HTTP API)

**POST** `/chats/:chatId/messages`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ HTTP API (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ WebSocket). **–°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —á–∞—Ç —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º `chatId` –∏–∑ URL.** –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–¥—É—Ç –ø–æ `chatId` –∏–∑ URL, –±–µ–∑ –ø–æ–∏—Å–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–ª–∏ –∑–∞—è–≤–∫–∞–º.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `chatId` (–≤ URL) - ID —á–∞—Ç–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "message": "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è",
  "message_type": "text"
}
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ —á–∞—Ç —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º `chatId` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- –î–ª—è **–≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤**: –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º, –æ–Ω **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —É—á–∞—Å—Ç–Ω–∏–∫–∏** –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –î–ª—è **–ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —á–∞—Ç–æ–≤**: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º —ç—Ç–æ–≥–æ —á–∞—Ç–∞
- –î–ª—è **—á–∞—Ç–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∫–∏**: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º —ç—Ç–æ–≥–æ —á–∞—Ç–∞
- –°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å `chat_id = chatId` –∏–∑ URL

**‚ö†Ô∏è –í–ê–ñ–ù–û –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:**
- –î–ª—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–æ–≤ **–Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —è–≤–Ω–æ–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–º –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –§—Ä–æ–Ω—Ç–µ–Ω–¥ –º–æ–∂–µ—Ç —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç, –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—è, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–º
- –î–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —á–∞—Ç–æ–≤ –∏ —á–∞—Ç–æ–≤ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–æ–º –∑–∞—Ä–∞–Ω–µ–µ

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "success": true,
  "message": "–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ",
  "data": {
    "id": "uuid",
    "chat_id": "uuid",
    "sender_id": "uuid",
    "message": "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è",
    "message_type": "text",
    "created_at": "2024-01-01T00:00:00.000Z",
    "read_by": ["uuid"],
    "unread_by": ["uuid", "uuid"]
  }
}
```

**–õ–æ–≥–∏–∫–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏—è:**
- –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `read_by`
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ —á–∞—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `unread_by`
- –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `POST /chats/:chatId/read` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–º–µ—Ç–∫–∏ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** 
- –°–æ–æ–±—â–µ–Ω–∏–µ —Ç–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ Socket.io –∏ SSE –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º —á–∞—Ç–∞
- **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:** –°–æ–æ–±—â–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —á–∞—Ç —Å `chat_id = chatId` –∏–∑ URL. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–∏—Å–∫ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–ª–∏ –∑–∞—è–≤–∫–∞–º.

#### –û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ

**POST** `/chats/:chatId/read`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞.

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "chat_id": "uuid",
    "messages_marked_read": 5,
    "read_at": "2024-01-01T00:00:00.000Z"
  }
}
```

**–õ–æ–≥–∏–∫–∞:**
- –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ `unread_by` –≤ `read_by` –¥–ª—è –≤—Å–µ—Ö –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ `all_messages_read` —á–µ—Ä–µ–∑ SSE –∏ Socket.io

#### –û—Ç–º–µ—Ç–∏—Ç—å –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ

**POST** `/chats/:chatId/messages/:messageId/read`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–û—Ç–º–µ—Ç–∏—Ç—å –æ–¥–Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏).

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "message_id": "uuid",
    "read_at": "2024-01-01T00:00:00.000Z"
  }
}
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –°–æ–±—ã—Ç–∏–µ —Ç–∞–∫–∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ Socket.io –∏ SSE –≤—Å–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–∞–º —á–∞—Ç–∞.

---

### –õ–æ–≥–∏–∫–∞ –ø—Ä–æ—á—Ç–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

**–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

1. **–ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è:**
   - –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ `read_by` (—Å–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤—Å–µ–≥–¥–∞ –ø—Ä–æ—á–∏—Ç–∞–Ω—ã)
   - –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ —á–∞—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `unread_by`
   - –ü—Ä–∏–º–µ—Ä: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A –æ—Ç–ø—Ä–∞–≤–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ [A, B, C]
     - `read_by: ["A"]`
     - `unread_by: ["B", "C"]`

2. **–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞:**
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `POST /chats/:chatId/read`
   - –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –≥–¥–µ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ `unread_by`, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –∏–∑ `unread_by` –≤ `read_by` –¥–ª—è –≤—Å–µ—Ö –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

3. **–ü–æ–¥—Å—á–µ—Ç –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö:**
   - `unread_count` —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π, –≥–¥–µ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `unread_by`
   - –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è (–æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –≤—Å–µ–≥–¥–∞ –≤ `read_by`)

4. **–î–ª—è –∞–¥–º–∏–Ω–æ–≤ –≤ support —á–∞—Ç–∞—Ö:**
   - –ê–¥–º–∏–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `chat_participants` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ support —á–∞—Ç–∞
   - –ê–¥–º–∏–Ω—ã –≤–∏–¥—è—Ç –≤—Å–µ support —á–∞—Ç—ã —á–µ—Ä–µ–∑ `GET /chats/admin/chats?type=support`
   - `unread_count` –¥–ª—è –∞–¥–º–∏–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–§–æ—Ä–º–∞—Ç –ø–æ–ª–µ–π:**
- `read_by` - –º–∞—Å—Å–∏–≤ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—á–∏—Ç–∞–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ: `["uuid1", "uuid2"]`
- `unread_by` - –º–∞—Å—Å–∏–≤ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø—Ä–æ—á–∏—Ç–∞–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ: `["uuid3", "uuid4"]`
- –û–±–∞ –ø–æ–ª—è –º–æ–≥—É—Ç –±—ã—Ç—å `null` –∏–ª–∏ –ø—É—Å—Ç—ã–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏ `[]`

---

### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

#### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —á–∞—Ç—ã

**GET** `/chats/admin/chats`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —á–∞—Ç—ã –≤ —Å–∏—Å—Ç–µ–º–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤). –ê–¥–º–∏–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ support —á–∞—Ç—ã –ø—Ä–∏ –∏—Ö —Å–æ–∑–¥–∞–Ω–∏–∏.

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `type` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É (`support`, `private`, `group`)
- `request_id` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –∑–∞—è–≤–∫–µ
- `user_id` - —Ñ–∏–ª—å—Ç—Ä –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- `limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20, –º–∞–∫—Å–∏–º—É–º 100)
- `offset` - —Å–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä—ã:**
- –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ support —á–∞—Ç—ã: `GET /chats/admin/chats?type=support`
- –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —á–∞—Ç—ã —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π: `GET /chats/admin/chats?limit=50&offset=0`

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "chats": [
      {
        "id": "uuid",
        "type": "support",
        "user_id": "uuid",
        "request_id": null,
        "created_at": "2024-01-01T00:00:00.000Z",
        "last_message_at": "2024-01-01T00:00:00.000Z",
        "participants_count": 3,
        "unread_count": 5
      }
    ],
    "total": 10
  }
}
```

**–ü–æ–ª—è:**
- `participants_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–∞—Ç–∞
- `unread_count` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –∞–¥–º–∏–Ω–∞

#### –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

**GET** `/chats/admin/chats/:chatId/messages`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ (—Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä, –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏).

**–û—Ç–≤–µ—Ç (200):**
–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ GET `/chats/:chatId/messages`

---

## üè¢ –ü–∞—Ä—Ç–Ω–µ—Ä—ã

API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º–∏. –ü–∞—Ä—Ç–Ω–µ—Ä—ã - —ç—Ç–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–∞—é—Ç —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π.

### –ú–æ–¥–µ–ª—å Partner

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|----------|
| `id` | string (UUID) | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–∞—Ä—Ç–Ω–µ—Ä–∞ |
| `name` | string | –î–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ |
| `photo_urls` | array[string] | –ù–µ—Ç | –ú–∞—Å—Å–∏–≤ URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –ø–∞—Ä—Ç–Ω–µ—Ä–∞ (JSON) |
| `latitude` | float | –ù–µ—Ç | –®–∏—Ä–æ—Ç–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è |
| `longitude` | float | –ù–µ—Ç | –î–æ–ª–≥–æ—Ç–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è |
| `address` | string | –ù–µ—Ç | –ê–¥—Ä–µ—Å –ø–∞—Ä—Ç–Ω–µ—Ä–∞ |
| `activity` | string | –ù–µ—Ç | –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞—Ä—Ç–Ω–µ—Ä–∞ |
| `website_url` | string (URL) | –ù–µ—Ç | URL —Å–∞–π—Ç–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ |
| `created_at` | datetime | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | datetime | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤

**GET** `/partners`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–ø—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç)

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page` (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
- `limit` (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20, –º–∞–∫—Å–∏–º—É–º 100)
- `latitude` (float, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —à–∏—Ä–æ—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Ä–∞–¥–∏—É—Å—É
- `longitude` (float, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¥–æ–ª–≥–æ—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Ä–∞–¥–∏—É—Å—É
- `radius` (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ä–∞–¥–∏—É—Å –ø–æ–∏—Å–∫–∞ –≤ –º–µ—Ç—Ä–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10000)

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "partners": [
      {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "name": "–≠–∫–æ–ü–∞—Ä—Ç–Ω–µ—Ä",
        "photo_urls": ["https://danilagames.ru/uploads/photos/uuid1.jpg"],
        "latitude": 56.4962847,
        "longitude": 84.9802779,
        "address": "–≥. –¢–æ–º—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
        "activity": "–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Å—Ç–∏–∫–∞",
        "website_url": "https://ecopartner.ru",
        "created_at": "2024-01-01T00:00:00.000Z",
        "updated_at": "2024-01-01T00:00:00.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 50,
      "totalPages": 3
    }
  }
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞ –ø–æ ID

**GET** `/partners/:id`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–ø—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç)

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "partner": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "name": "–≠–∫–æ–ü–∞—Ä—Ç–Ω–µ—Ä",
      "photo_urls": ["https://danilagames.ru/uploads/photos/uuid1.jpg"],
      "latitude": 56.4962847,
      "longitude": 84.9802779,
      "address": "–≥. –¢–æ–º—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
      "activity": "–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Å—Ç–∏–∫–∞",
      "website_url": "https://ecopartner.ru",
      "created_at": "2024-01-01T00:00:00.000Z",
      "updated_at": "2024-01-01T00:00:00.000Z"
    }
  }
}
```

**–û—à–∏–±–∫–∏:**
- `404` - –ü–∞—Ä—Ç–Ω–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞

**POST** `/partners`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:**

1. **JSON —Å URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π**
2. **multipart/form-data —Å —Ñ–∞–π–ª–∞–º–∏** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–°–ø–æ—Å–æ–± 1: JSON —Å URL**

**Content-Type:** `application/json`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "name": "–≠–∫–æ–ü–∞—Ä—Ç–Ω–µ—Ä",
  "latitude": 56.4962847,
  "longitude": 84.9802779,
  "address": "–≥. –¢–æ–º—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
  "activity": "–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Å—Ç–∏–∫–∞",
  "website_url": "https://ecopartner.ru",
  "photo_urls": ["https://example.com/photo1.jpg"]
}
```

**–°–ø–æ—Å–æ–± 2: multipart/form-data —Å —Ñ–∞–π–ª–∞–º–∏**

**Content-Type:** `multipart/form-data`

**–ü–æ–ª—è —Ñ–æ—Ä–º—ã:**
- `name` (string, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ) - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
- `latitude` (float, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —à–∏—Ä–æ—Ç–∞
- `longitude` (float, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¥–æ–ª–≥–æ—Ç–∞
- `address` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∞–¥—Ä–µ—Å
- `activity` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- `website_url` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - URL —Å–∞–π—Ç–∞
- `photos` (file[], –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Ñ–æ—Ç–æ (–º–∞–∫—Å–∏–º—É–º 10)

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è —Ñ–∞–π–ª–æ–≤:**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: 10MB
- –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: JPEG, PNG, GIF, WebP
- –ú–∞–∫—Å–∏–º—É–º 10 —Ñ–∞–π–ª–æ–≤

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "success": true,
  "message": "–ü–∞—Ä—Ç–Ω–µ—Ä —Å–æ–∑–¥–∞–Ω",
  "data": {
    "partner": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "name": "–≠–∫–æ–ü–∞—Ä—Ç–Ω–µ—Ä",
      "photo_urls": ["https://danilagames.ru/uploads/photos/uuid1.jpg"],
      "latitude": 56.4962847,
      "longitude": 84.9802779,
      "address": "–≥. –¢–æ–º—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 1",
      "activity": "–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Å—Ç–∏–∫–∞",
      "website_url": "https://ecopartner.ru",
      "created_at": "2024-01-01T00:00:00.000Z",
      "updated_at": "2024-01-01T00:00:00.000Z"
    }
  }
}
```

**–û—à–∏–±–∫–∏:**
- `400` - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞

**PUT** `/partners/:id`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç multipart/form-data —Å —Ñ–∞–π–ª–∞–º–∏**

**Content-Type:** `multipart/form-data` –∏–ª–∏ `application/json`

**–ü–æ–ª—è (–≤—Å–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã, –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ):**
- `name` (string) - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞
- `latitude` (float) - —à–∏—Ä–æ—Ç–∞
- `longitude` (float) - –¥–æ–ª–≥–æ—Ç–∞
- `address` (string) - –∞–¥—Ä–µ—Å
- `activity` (string) - –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- `website_url` (string) - URL —Å–∞–π—Ç–∞
- `photo_urls` (array[string] –∏–ª–∏ file[]) - —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–ü–∞—Ä—Ç–Ω–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω",
  "data": {
    "partner": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "name": "–≠–∫–æ–ü–∞—Ä—Ç–Ω–µ—Ä (–æ–±–Ω–æ–≤–ª–µ–Ω–æ)",
      ...
    }
  }
}
```

**–û—à–∏–±–∫–∏:**
- `404` - –ü–∞—Ä—Ç–Ω–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –£–¥–∞–ª–µ–Ω–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–∞

**DELETE** `/partners/:id`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–ü–∞—Ä—Ç–Ω–µ—Ä —É–¥–∞–ª–µ–Ω",
  "data": null
}
```

**–û—à–∏–±–∫–∏:**
- `404` - –ü–∞—Ä—Ç–Ω–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

---

## ‚ôªÔ∏è –°—Ç–∞–Ω—Ü–∏–∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏

API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç–∞–Ω—Ü–∏—è–º–∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏. –°—Ç–∞–Ω—Ü–∏–∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ - —ç—Ç–æ –º–µ—Å—Ç–∞, –≥–¥–µ –º–æ–∂–Ω–æ —Å–¥–∞—Ç—å –º—É—Å–æ—Ä –Ω–∞ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫—É.

### –ú–æ–¥–µ–ª—å RecyclingStation

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|----------|
| `id` | string (UUID) | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞–Ω—Ü–∏–∏ |
| `name` | string | –î–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ |
| `photo_urls` | array[string] | –ù–µ—Ç | –ú–∞—Å—Å–∏–≤ URL —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Å—Ç–∞–Ω—Ü–∏–∏ (JSON) |
| `latitude` | float | –ù–µ—Ç | –®–∏—Ä–æ—Ç–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è |
| `longitude` | float | –ù–µ—Ç | –î–æ–ª–≥–æ—Ç–∞ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è |
| `address` | string | –ù–µ—Ç | –ê–¥—Ä–µ—Å —Å—Ç–∞–Ω—Ü–∏–∏ |
| `activity` | string | –ù–µ—Ç | –î–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å/–æ–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ |
| `website_url` | string (URL) | –ù–µ—Ç | URL —Å–∞–π—Ç–∞ —Å—Ç–∞–Ω—Ü–∏–∏ |
| `accepted_waste_types` | array[object] | –ù–µ—Ç | –ú–∞—Å—Å–∏–≤ —Ç–∏–ø–æ–≤ –º—É—Å–æ—Ä–∞ –¥–ª—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ (–∫–∞–∫ –≤ requests.waste_types) |
| `created_at` | datetime | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | datetime | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

**–§–æ—Ä–º–∞—Ç `accepted_waste_types`:**
```json
[
  {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "–ü–ª–∞—Å—Ç–∏–∫",
    "danger": false
  },
  {
    "id": "550e8400-e29b-41d4-a716-446655440001",
    "name": "–°—Ç–µ–∫–ª–æ",
    "danger": false
  }
]
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å—Ç–∞–Ω—Ü–∏–π –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏

**GET** `/recycling-stations`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–ø—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç)

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page` (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
- `limit` (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20, –º–∞–∫—Å–∏–º—É–º 100)
- `latitude` (float, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —à–∏—Ä–æ—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Ä–∞–¥–∏—É—Å—É
- `longitude` (float, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¥–æ–ª–≥–æ—Ç–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ —Ä–∞–¥–∏—É—Å—É
- `radius` (int, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ä–∞–¥–∏—É—Å –ø–æ–∏—Å–∫–∞ –≤ –º–µ—Ç—Ä–∞—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10000)
- `waste_type` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–∏–ø—É –º—É—Å–æ—Ä–∞ (–ø–æ–∏—Å–∫ –≤ accepted_waste_types)

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "stations": [
      {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "name": "–°—Ç–∞–Ω—Ü–∏—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ \"–≠–∫–æ–¢–æ–º—Å–∫\"",
        "photo_urls": ["https://danilagames.ru/uploads/photos/uuid1.jpg"],
        "latitude": 56.4962847,
        "longitude": 84.9802779,
        "address": "–≥. –¢–æ–º—Å–∫, —É–ª. –≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è, –¥. 10",
        "activity": "–ü—Ä–∏–µ–º –∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Å—Ç–∏–∫–∞, —Å—Ç–µ–∫–ª–∞, –±—É–º–∞–≥–∏",
        "website_url": "https://ecotomsk.ru",
        "accepted_waste_types": [
          {
            "id": "550e8400-e29b-41d4-a716-446655440000",
            "name": "–ü–ª–∞—Å—Ç–∏–∫",
            "danger": false
          },
          {
            "id": "550e8400-e29b-41d4-a716-446655440001",
            "name": "–°—Ç–µ–∫–ª–æ",
            "danger": false
          }
        ],
        "created_at": "2024-01-01T00:00:00.000Z",
        "updated_at": "2024-01-01T00:00:00.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 50,
      "totalPages": 3
    }
  }
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –ø–æ ID

**GET** `/recycling-stations/:id`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–ø—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç)

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "station": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "name": "–°—Ç–∞–Ω—Ü–∏—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ \"–≠–∫–æ–¢–æ–º—Å–∫\"",
      "photo_urls": ["https://danilagames.ru/uploads/photos/uuid1.jpg"],
      "latitude": 56.4962847,
      "longitude": 84.9802779,
      "address": "–≥. –¢–æ–º—Å–∫, —É–ª. –≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è, –¥. 10",
      "activity": "–ü—Ä–∏–µ–º –∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Å—Ç–∏–∫–∞, —Å—Ç–µ–∫–ª–∞, –±—É–º–∞–≥–∏",
      "website_url": "https://ecotomsk.ru",
      "accepted_waste_types": [
        {
          "id": "550e8400-e29b-41d4-a716-446655440000",
          "name": "–ü–ª–∞—Å—Ç–∏–∫",
          "danger": false
        }
      ],
      "created_at": "2024-01-01T00:00:00.000Z",
      "updated_at": "2024-01-01T00:00:00.000Z"
    }
  }
}
```

**–û—à–∏–±–∫–∏:**
- `404` - –°—Ç–∞–Ω—Ü–∏—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞

### –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏

**POST** `/recycling-stations`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç multipart/form-data —Å —Ñ–∞–π–ª–∞–º–∏**

**Content-Type:** `multipart/form-data` –∏–ª–∏ `application/json`

**–ü–æ–ª—è —Ñ–æ—Ä–º—ã:**
- `name` (string, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ) - –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏
- `latitude` (float, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —à–∏—Ä–æ—Ç–∞
- `longitude` (float, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¥–æ–ª–≥–æ—Ç–∞
- `address` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –∞–¥—Ä–µ—Å
- `activity` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å/–æ–ø–∏—Å–∞–Ω–∏–µ
- `website_url` (string, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - URL —Å–∞–π—Ç–∞
- `photos` (file[], –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Ñ–æ—Ç–æ (–º–∞–∫—Å–∏–º—É–º 10)
- `accepted_waste_types` (array[object], –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - —Ç–∏–ø—ã –º—É—Å–æ—Ä–∞ –¥–ª—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏

**–ü—Ä–∏–º–µ—Ä JSON –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "name": "–°—Ç–∞–Ω—Ü–∏—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ \"–≠–∫–æ–¢–æ–º—Å–∫\"",
  "latitude": 56.4962847,
  "longitude": 84.9802779,
  "address": "–≥. –¢–æ–º—Å–∫, —É–ª. –≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è, –¥. 10",
  "activity": "–ü—Ä–∏–µ–º –∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Å—Ç–∏–∫–∞, —Å—Ç–µ–∫–ª–∞, –±—É–º–∞–≥–∏",
  "website_url": "https://ecotomsk.ru",
  "accepted_waste_types": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "name": "–ü–ª–∞—Å—Ç–∏–∫",
      "danger": false
    },
    {
      "id": "550e8400-e29b-41d4-a716-446655440001",
      "name": "–°—Ç–µ–∫–ª–æ",
      "danger": false
    }
  ]
}
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "success": true,
  "message": "–°—Ç–∞–Ω—Ü–∏—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–∑–¥–∞–Ω–∞",
  "data": {
    "station": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "name": "–°—Ç–∞–Ω—Ü–∏—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ \"–≠–∫–æ–¢–æ–º—Å–∫\"",
      ...
    }
  }
}
```

**–û—à–∏–±–∫–∏:**
- `400` - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏

**PUT** `/recycling-stations/:id`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç multipart/form-data —Å —Ñ–∞–π–ª–∞–º–∏**

**Content-Type:** `multipart/form-data` –∏–ª–∏ `application/json`

**–ü–æ–ª—è (–≤—Å–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã, –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ):**
- `name` (string) - –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏
- `latitude` (float) - —à–∏—Ä–æ—Ç–∞
- `longitude` (float) - –¥–æ–ª–≥–æ—Ç–∞
- `address` (string) - –∞–¥—Ä–µ—Å
- `activity` (string) - –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- `website_url` (string) - URL —Å–∞–π—Ç–∞
- `photo_urls` (array[string] –∏–ª–∏ file[]) - —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
- `accepted_waste_types` (array[object]) - —Ç–∏–ø—ã –º—É—Å–æ—Ä–∞

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–°—Ç–∞–Ω—Ü–∏—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∞",
  "data": {
    "station": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      ...
    }
  }
}
```

**–û—à–∏–±–∫–∏:**
- `404` - –°—Ç–∞–Ω—Ü–∏—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏

**DELETE** `/recycling-stations/:id`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–°—Ç–∞–Ω—Ü–∏—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ —É–¥–∞–ª–µ–Ω–∞",
  "data": null
}
```

**–û—à–∏–±–∫–∏:**
- `404` - –°—Ç–∞–Ω—Ü–∏—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

---

## üóëÔ∏è –¢–∏–ø—ã –æ—Ç—Ö–æ–¥–æ–≤ (Waste Types)

API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∏–ø–∞–º–∏ –æ—Ç—Ö–æ–¥–æ–≤. –¢–∏–ø—ã –æ—Ç—Ö–æ–¥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∑–∞—è–≤–∫–∞—Ö –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –º—É—Å–æ—Ä–∞.

**–í–∞–∂–Ω–æ:** –í –∑–∞—è–≤–∫–∞—Ö –ø–æ–ª–µ `waste_types` —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ JSON-–º–∞—Å—Å–∏–≤ –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–∏–ø–æ–≤ –æ—Ç—Ö–æ–¥–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `["plastic", "glass"]`). –¢–∞–±–ª–∏—Ü–∞ `waste_types` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –¥–ª—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –Ω–µ —Å–≤—è–∑–∞–Ω–∞ —Å –∑–∞—è–≤–∫–∞–º–∏ —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏.

### –ú–æ–¥–µ–ª—å WasteType

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|----------|
| `id` | string (UUID) | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤ |
| `name` | string | –î–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤ (–≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ, —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ) |
| `danger` | boolean | –ù–µ—Ç | –§–ª–∞–≥ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (true - –æ–ø–∞—Å–Ω—ã–π, false - –æ–±—ã—á–Ω—ã–π, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false) |
| `created_at` | datetime | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |
| `updated_at` | datetime | –ù–µ—Ç (–∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è |

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –æ—Ç—Ö–æ–¥–æ–≤

**GET** `/waste-types`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–ø—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:** –ù–µ—Ç

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**

```json
{
  "success": true,
  "data": [
    {
      "id": "uuid-1",
      "name": "plastic",
      "danger": false,
      "created_at": "2024-01-01T00:00:00.000Z",
      "updated_at": "2024-01-01T00:00:00.000Z"
    },
    {
      "id": "uuid-2",
      "name": "toxic",
      "danger": true,
      "created_at": "2024-01-01T00:00:00.000Z",
      "updated_at": "2024-01-01T00:00:00.000Z"
    }
  ]
}
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (Flutter):**

```dart
Future<List<Map<String, dynamic>>> getWasteTypes() async {
  final response = await http.get(
    Uri.parse('$baseUrl/waste-types'),
    headers: {'Content-Type': 'application/json'},
  );

  if (response.statusCode == 200) {
    final data = jsonDecode(response.body);
    return List<Map<String, dynamic>>.from(data['data']);
  } else {
    throw Exception('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–∏–ø–æ–≤ –æ—Ç—Ö–æ–¥–æ–≤: ${response.body}');
  }
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤ –ø–æ ID

**GET** `/waste-types/:id`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏:**
- `id` (UUID) - ID —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**

```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "name": "plastic",
    "danger": false,
    "created_at": "2024-01-01T00:00:00.000Z",
    "updated_at": "2024-01-01T00:00:00.000Z"
  }
}
```

**–û—à–∏–±–∫–∞ (404):**

```json
{
  "success": false,
  "message": "–¢–∏–ø –æ—Ç—Ö–æ–¥–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤

**POST** `/waste-types`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –¢—Ä–µ–±—É–µ—Ç—Å—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "name": "plastic",
  "danger": false
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `name` | string | –î–∞ | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤ (–±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–æ –≤ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä) |
| `danger` | boolean | –ù–µ—Ç | –§–ª–∞–≥ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false) |

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (201):**

```json
{
  "success": true,
  "message": "–¢–∏–ø –æ—Ç—Ö–æ–¥–æ–≤ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω",
  "data": {
    "id": "uuid",
    "name": "plastic",
    "danger": false,
    "created_at": "2024-01-01T00:00:00.000Z",
    "updated_at": "2024-01-01T00:00:00.000Z"
  }
}
```

**–û—à–∏–±–∫–∞ (400):**

```json
{
  "success": false,
  "message": "–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏",
  "errors": [
    {
      "field": "name",
      "message": "–ù–∞–∑–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ"
    }
  ],
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

**–û—à–∏–±–∫–∞ (409):**

```json
{
  "success": false,
  "message": "–¢–∏–ø –æ—Ç—Ö–æ–¥–æ–≤ —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (Flutter):**

```dart
Future<Map<String, dynamic>> createWasteType({
  required String name,
  bool danger = false,
}) async {
  final token = await getToken();
  final response = await http.post(
    Uri.parse('$baseUrl/waste-types'),
    headers: {
      'Content-Type': 'application/json',
      'Authorization': 'Bearer $token',
    },
    body: jsonEncode({
      'name': name,
      'danger': danger,
    }),
  );

  if (response.statusCode == 201) {
    final data = jsonDecode(response.body);
    return data['data'];
  } else {
    throw Exception('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤: ${response.body}');
  }
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤

**PUT** `/waste-types/:id`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –¢—Ä–µ–±—É–µ—Ç—Å—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏:**
- `id` (UUID) - ID —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "name": "plastic",
  "danger": true
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `name` | string | –ù–µ—Ç | –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤ (–±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–æ –≤ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä) |
| `danger` | boolean | –ù–µ—Ç | –§–ª–∞–≥ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**

```json
{
  "success": true,
  "message": "–¢–∏–ø –æ—Ç—Ö–æ–¥–æ–≤ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω",
  "data": {
    "id": "uuid",
    "name": "plastic",
    "danger": true,
    "created_at": "2024-01-01T00:00:00.000Z",
    "updated_at": "2024-01-01T00:01:00.000Z"
  }
}
```

**–û—à–∏–±–∫–∞ (404):**

```json
{
  "success": false,
  "message": "–¢–∏–ø –æ—Ç—Ö–æ–¥–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

**–û—à–∏–±–∫–∞ (409):**

```json
{
  "success": false,
  "message": "–¢–∏–ø –æ—Ç—Ö–æ–¥–æ–≤ —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### –£–¥–∞–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤

**DELETE** `/waste-types/:id`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** –¢—Ä–µ–±—É–µ—Ç—Å—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏:**
- `id` (UUID) - ID —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**

```json
{
  "success": true,
  "message": "–¢–∏–ø –æ—Ç—Ö–æ–¥–æ–≤ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω"
}
```

**–û—à–∏–±–∫–∞ (400):**

```json
{
  "success": false,
  "message": "–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ç–∏–ø –æ—Ç—Ö–æ–¥–æ–≤, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∑–∞—è–≤–∫–∞—Ö",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

**–û—à–∏–±–∫–∞ (404):**

```json
{
  "success": false,
  "message": "–¢–∏–ø –æ—Ç—Ö–æ–¥–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (Flutter):**

```dart
Future<void> deleteWasteType(String id) async {
  final token = await getToken();
  final response = await http.delete(
    Uri.parse('$baseUrl/waste-types/$id'),
    headers: {
      'Content-Type': 'application/json',
      'Authorization': 'Bearer $token',
    },
  );

  if (response.statusCode != 200) {
    throw Exception('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤: ${response.body}');
  }
}
```

### –ù–∞—á–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã –æ—Ç—Ö–æ–¥–æ–≤

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã –æ—Ç—Ö–æ–¥–æ–≤:

**–û–±—ã—á–Ω—ã–µ —Ç–∏–ø—ã (danger: false):**
- `plastic` - –ü–ª–∞—Å—Ç–∏–∫
- `glass` - –°—Ç–µ–∫–ª–æ
- `paper` - –ë—É–º–∞–≥–∞
- `cardboard` - –ö–∞—Ä—Ç–æ–Ω
- `metal` - –ú–µ—Ç–∞–ª–ª
- `organic` - –û—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–µ –æ—Ç—Ö–æ–¥—ã
- `tires` - –®–∏–Ω—ã
- `liquid` - –ñ–∏–¥–∫–∏–µ –æ—Ç—Ö–æ–¥—ã
- `furniture` - –ú–µ–±–µ–ª—å
- `construction` - –°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –æ—Ç—Ö–æ–¥—ã
- `household waste` - –ë—ã—Ç–æ–≤—ã–µ –æ—Ç—Ö–æ–¥—ã
- `bottles and cans` - –ë—É—Ç—ã–ª–∫–∏ –∏ –±–∞–Ω–∫–∏

**–û–ø–∞—Å–Ω—ã–µ —Ç–∏–ø—ã (danger: true):**
- `electronic` - –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞
- `toxic` - –¢–æ–∫—Å–∏—á–Ω—ã–µ –æ—Ç—Ö–æ–¥—ã
- `dead animals` - –ú–µ—Ä—Ç–≤—ã–µ –∂–∏–≤–æ—Ç–Ω—ã–µ

### –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø:** GET —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ —Ç–∏–ø—ã –æ—Ç—Ö–æ–¥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ö —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–æ–∫.

2. **–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø:** POST, PUT, DELETE —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º.

3. **–í–∞–ª–∏–¥–∞—Ü–∏—è:** 
   - `name` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º
   - `name` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
   - `danger` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false

4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∏—è:** –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏ –æ–Ω –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞—è–≤–∫–∞—Ö. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è - —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ.

5. **–§–æ—Ä–º–∞—Ç –¥–∞—Ç:** –í—Å–µ –¥–∞—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO 8601: `2024-01-01T00:00:00.000Z`

---

## üîî Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ Firebase Cloud Messaging (FCM) –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏. –í—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Ç–≤–µ—Ç—ã API.

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

#### 1. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –∑–∞—è–≤–∫—É —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏, —Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤ —Ä–∞–¥–∏—É—Å–µ **10 –∫–º** –æ—Ç –º–µ—Å—Ç–∞ –∑–∞—è–≤–∫–∏.

**–¢—Ä–∏–≥–≥–µ—Ä:** `POST /api/requests` (—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏ —Å `latitude` –∏ `longitude`)

**–ü–æ–ª—É—á–∞—Ç–µ–ª–∏:** –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ —Ä–∞–¥–∏—É—Å–µ 10 –∫–º (–∫—Ä–æ–º–µ —Å–æ–∑–¥–∞—Ç–µ–ª—è –∑–∞—è–≤–∫–∏)

**–§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
- **–ó–∞–≥–æ–ª–æ–≤–æ–∫:** `New {Category}` (–Ω–∞–ø—Ä–∏–º–µ—Ä, "New Waste Location", "New Speed Clean-up", "New Event")
- **–¢–µ–∫—Å—Ç:** `{–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏}\nCreated by: {–ò–º—è —Å–æ–∑–¥–∞—Ç–µ–ª—è}`
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:** –ü–µ—Ä–≤–æ–µ —Ñ–æ—Ç–æ –∑–∞—è–≤–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- **Deeplink:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–µ—Ç–∞–ª–µ–π –∑–∞—è–≤–∫–∏

**–ü—Ä–∏–º–µ—Ä:**
```
Title: New Waste Location
Body: –£–±–æ—Ä–∫–∞ –ø–∞—Ä–∫–∞
Created by: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
```

#### 2. –ü—Ä–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ –∫ –∑–∞—è–≤–∫–µ

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è –∫ –∑–∞—è–≤–∫–µ —Ç–∏–ø–∞ `wasteLocation`, —Å–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

**–¢—Ä–∏–≥–≥–µ—Ä:** `POST /api/requests/:id/join`

**–ü–æ–ª—É—á–∞—Ç–µ–ª—å:** –°–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ (–µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–æ—Ç –∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

**–§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
- **–ó–∞–≥–æ–ª–æ–≤–æ–∫:** `Someone joined your request`
- **–¢–µ–∫—Å—Ç:** `{–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è} joined your request "{–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏}"`
- **Deeplink:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–µ—Ç–∞–ª–µ–π –∑–∞—è–≤–∫–∏

**–ü—Ä–∏–º–µ—Ä:**
```
Title: Someone joined your request
Body: –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤ joined your request "–£–±–æ—Ä–∫–∞ –ø–∞—Ä–∫–∞"
```

#### 3. –ü—Ä–∏ —É—á–∞—Å—Ç–∏–∏ –≤ —Å–æ–±—ã—Ç–∏–∏

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è –∫ —Å–æ–±—ã—Ç–∏—é (event), —Å–æ–∑–¥–∞—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

**–¢—Ä–∏–≥–≥–µ—Ä:** `POST /api/requests/:id/participate`

**–ü–æ–ª—É—á–∞—Ç–µ–ª—å:** –°–æ–∑–¥–∞—Ç–µ–ª—å —Å–æ–±—ã—Ç–∏—è (–µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–æ—Ç –∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

**–§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
- **–ó–∞–≥–æ–ª–æ–≤–æ–∫:** `Someone joined your event`
- **–¢–µ–∫—Å—Ç:** `{–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è} joined your event "{–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è}"`
- **Deeplink:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–µ—Ç–∞–ª–µ–π —Å–æ–±—ã—Ç–∏—è

**–ü—Ä–∏–º–µ—Ä:**
```
Title: Someone joined your event
Body: –ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞ joined your event "–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—É–±–±–æ—Ç–Ω–∏–∫"
```

#### 4. –ü—Ä–∏ –¥–æ–Ω–∞—Ç–µ

–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–µ–ª–∞–µ—Ç –¥–æ–Ω–∞—Ç –Ω–∞ –∑–∞—è–≤–∫—É, —Å–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å—É–º–º–µ –∏ –¥–æ–Ω–∞—Ç–æ—Ä–µ.

**–¢—Ä–∏–≥–≥–µ—Ä:** `POST /api/donations`

**–ü–æ–ª—É—á–∞—Ç–µ–ª—å:** –°–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ (–µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–æ—Ç –∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

**–§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
- **–ó–∞–≥–æ–ª–æ–≤–æ–∫:** `Someone donated to your request`
- **–¢–µ–∫—Å—Ç:** `{–ò–º—è –¥–æ–Ω–∞—Ç–æ—Ä–∞} donated ${–°—É–º–º–∞} to your request "{–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏}"`
- **Deeplink:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–µ—Ç–∞–ª–µ–π –∑–∞—è–≤–∫–∏

**–ü—Ä–∏–º–µ—Ä:**
```
Title: Someone donated to your request
Body: –ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤ donated $25.00 to your request "–£–±–æ—Ä–∫–∞ –ø–∞—Ä–∫–∞"
```

#### 5. –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–∫–∏ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é

–ö–æ–≥–¥–∞ –∑–∞—è–≤–∫–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Å—Ç–∞—Ç—É—Å `pending` (–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ), –≤—Å–µ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—ã (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã) –ø–æ–ª—É—á–∞—é—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.

**–¢—Ä–∏–≥–≥–µ—Ä:** `PUT /api/requests/:id` (–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ `pending`) - **–ù–ï –¥–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `event` –∏ `wasteLocation`** (–¥–ª—è –Ω–∏—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `POST /api/requests/:requestId/close-by-creator`)

**–ü–æ–ª—É—á–∞—Ç–µ–ª–∏:** –í—Å–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å `admin = TRUE` –∏ –≤–∞–ª–∏–¥–Ω—ã–º FCM —Ç–æ–∫–µ–Ω–æ–º)

**–§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
- **–ó–∞–≥–æ–ª–æ–≤–æ–∫:** `New Request for Moderation`
- **–¢–µ–∫—Å—Ç:** `{–ö–∞—Ç–µ–≥–æ—Ä–∏—è}: "{–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏}"\nCreated by: {–ò–º—è —Å–æ–∑–¥–∞—Ç–µ–ª—è}`
- **Deeplink:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞—è–≤–∫–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

**–ü—Ä–∏–º–µ—Ä:**
```
Title: New Request for Moderation
Body: Waste Location: "–£–±–æ—Ä–∫–∞ –ø–∞—Ä–∫–∞"
Created by: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
```

**Deeplink —Ñ–æ—Ä–º–∞—Ç:**
```
https://garbagedev-9c240.web.app/admin/requests/{requestId}
```

**–í–∞–∂–Ω–æ:**
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∏–∑ –¥—Ä—É–≥–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ –≤ `pending` (–Ω–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending`)
- Deeplink –≤–µ–¥–µ—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞—è–≤–∫–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏, –≥–¥–µ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –æ–¥–æ–±—Ä–∏—Ç—å –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞—è–≤–∫—É
- –ï—Å–ª–∏ —É –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –Ω–µ—Ç FCM —Ç–æ–∫–µ–Ω–∞, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

### –†—É—á–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç.

#### –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /api/notifications/send`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: –î–∞ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã)
- –ú–µ—Ç–æ–¥: `POST`
- Content-Type: `application/json`

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "title": "–ó–∞–≥–æ–ª–æ–≤–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",
  "body": "–¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",
  "user_ids": [
    "353f958d-8796-44c7-a877-3e376eca6784",
    "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
  ],
  "image_url": "https://example.com/image.jpg",  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  "sound": "default",  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "default"
  "data": {  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    "initialPageName": "SomePage",
    "parameterData": "{\"key\":\"value\"}",
    "deeplink": "https://garbagedev-9c240.web.app/some/page"
  }
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `title` | string | –î–∞ | –ó–∞–≥–æ–ª–æ–≤–æ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |
| `body` | string | –î–∞ | –¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |
| `user_ids` | array[string] | –î–∞ | –ú–∞—Å—Å–∏–≤ UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π-–ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π (–º–∏–Ω–∏–º—É–º 1) |
| `image_url` | string | –ù–µ—Ç | URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |
| `sound` | string | –ù–µ—Ç | –ó–≤—É–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "default") |
| `data` | object | –ù–µ—Ç | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ |

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**

```json
{
  "success": true,
  "message": "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ 2 –∏–∑ 2 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π",
  "data": {
    "sent": 2,
    "failed": 0,
    "total": 2
  },
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

**–û—Ç–≤–µ—Ç —Å —á–∞—Å—Ç–∏—á–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–æ–π (200):**

–ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–æ—Å—å —É—Å–ø–µ—à–Ω–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `200`:

```json
{
  "success": true,
  "message": "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ 1 –∏–∑ 2 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π",
  "data": {
    "sent": 1,
    "failed": 1,
    "total": 2
  },
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

**–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ (400):**

–ï—Å–ª–∏ **–Ω–∏ –æ–¥–Ω–æ** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–æ—Å—å, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ `400`:

```json
{
  "success": false,
  "message": "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ—Ç FCM —Ç–æ–∫–µ–Ω–æ–≤",
  "data": {
    "sent": 0,
    "failed": 1,
    "total": 1,
    "reason": "–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç FCM —Ç–æ–∫–µ–Ω—ã. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ —Ç–æ–∫–µ–Ω–æ–≤: user@example.com"
  },
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

**–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∏—á–∏–Ω –æ—à–∏–±–æ–∫ –≤ –ø–æ–ª–µ `reason`:**

- `"–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç FCM —Ç–æ–∫–µ–Ω—ã. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ —Ç–æ–∫–µ–Ω–æ–≤: user@example.com"` - —É —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ—Ç FCM —Ç–æ–∫–µ–Ω–æ–≤
- `"–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç FCM —Ç–æ–∫–µ–Ω—ã. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã: uuid1, uuid2"` - —É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –ë–î
- `"–¢–æ–∫–µ–Ω abc123...: messaging/invalid-registration-token - Invalid registration token"` - —Ç–æ–∫–µ–Ω –Ω–µ–≤–∞–ª–∏–¥–µ–Ω
- `"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —á–µ—Ä–µ–∑ FCM: Network error"` - –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ

**–û—à–∏–±–∫–∏:**

- `400` - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–Ω–µ–≤–µ—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã) –∏–ª–∏ –æ—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
  - –ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ—Ç FCM —Ç–æ–∫–µ–Ω–æ–≤ –∏–ª–∏ –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–∏—Å—å, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `400` —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:
  ```json
  {
    "success": false,
    "message": "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ—Ç FCM —Ç–æ–∫–µ–Ω–æ–≤",
    "data": {
      "sent": 0,
      "failed": 1,
      "total": 1,
      "reason": "–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç FCM —Ç–æ–∫–µ–Ω—ã. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ —Ç–æ–∫–µ–Ω–æ–≤: user@example.com"
    }
  }
  ```
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω (–Ω–µ –∞–¥–º–∏–Ω)
- `500` - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

**–í–∞–∂–Ω–æ:**
- –ï—Å–ª–∏ **–Ω–∏ –æ–¥–Ω–æ** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–æ—Å—å (`sent: 0`), API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É **400** (–Ω–µ 200)
- –í –ø–æ–ª–µ `reason` —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏—á–∏–Ω–µ –æ—à–∏–±–∫–∏:
  - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –ë–î
  - –ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç FCM —Ç–æ–∫–µ–Ω—ã (—Å —É–∫–∞–∑–∞–Ω–∏–µ–º email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
  - –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω—ã –Ω–µ–≤–∞–ª–∏–¥–Ω—ã (—Å –∫–æ–¥–∞–º–∏ –æ—à–∏–±–æ–∫ FCM)
- –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–æ—Å—å —É—Å–ø–µ—à–Ω–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `200` —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∏ –Ω–µ—É–¥–∞—á–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (Flutter):**

```dart
Future<Map<String, dynamic>> sendNotificationToUsers({
  required String title,
  required String body,
  required List<String> userIds,
  String? imageUrl,
  Map<String, dynamic>? data,
}) async {
  final token = await getToken();
  final response = await http.post(
    Uri.parse('$baseUrl/notifications/send'),
    headers: {
      'Content-Type': 'application/json',
      'Authorization': 'Bearer $token',
    },
    body: jsonEncode({
      'title': title,
      'body': body,
      'user_ids': userIds,
      if (imageUrl != null) 'image_url': imageUrl,
      if (data != null) 'data': data,
    }),
  );

  final data = jsonDecode(response.body);
  
  if (response.statusCode == 200) {
    return data;
  } else if (response.statusCode == 400) {
    // –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ
    final reason = data['data']?['reason'] ?? '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';
    throw Exception('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: ${data['message']}. –ü—Ä–∏—á–∏–Ω–∞: $reason');
  } else {
    throw Exception('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: ${response.body}');
  }
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–í—Å–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–≤–æ–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ API.

#### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `GET /api/notifications`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: –î–∞
- –ú–µ—Ç–æ–¥: `GET`

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|----------|
| `page` | integer | –ù–µ—Ç | –ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1) |
| `limit` | integer | –ù–µ—Ç | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 20, –º–∞–∫—Å–∏–º—É–º: 100) |
| `read` | boolean | –ù–µ—Ç | –§–∏–ª—å—Ç—Ä –ø–æ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ—Å—Ç–∏ (`true` - —Ç–æ–ª—å–∫–æ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ, `false` - —Ç–æ–ª—å–∫–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ) |

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**

```json
{
  "success": true,
  "data": {
    "notifications": [
      {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "user_id": "353f958d-8796-44c7-a877-3e376eca6784",
        "title": "Thank you!",
        "body": "You've earned a coin for your cleanup work!",
        "data": {
          "type": "speedCleanup",
          "earnedCoin": true,
          "requestId": "660e8400-e29b-41d4-a716-446655440000"
        },
        "read": false,
        "created_at": "2024-01-01T10:00:00.000Z",
        "updated_at": "2024-01-01T10:00:00.000Z"
      },
      {
        "id": "550e8400-e29b-41d4-a716-446655440001",
        "user_id": "353f958d-8796-44c7-a877-3e376eca6784",
        "title": "Someone joined your request",
        "body": "–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤ joined your request \"–£–±–æ—Ä–∫–∞ –ø–∞—Ä–∫–∞\"",
        "data": {
          "type": "join",
          "requestId": "660e8400-e29b-41d4-a716-446655440001",
          "actionType": "joined"
        },
        "read": true,
        "created_at": "2024-01-01T09:00:00.000Z",
        "updated_at": "2024-01-01T09:05:00.000Z"
      }
    ],
    "pagination": {
      "page": 1,
      "limit": 20,
      "total": 45,
      "totalPages": 3
    }
  }
}
```

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**

```
GET /api/notifications
GET /api/notifications?page=2&limit=10
GET /api/notifications?read=false
GET /api/notifications?read=true&page=1&limit=50
```

#### –û—Ç–º–µ—Ç–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ

**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `PUT /api/notifications/:id/read`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: –î–∞
- –ú–µ—Ç–æ–¥: `PUT`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—É—Ç–∏:**
- `id` (UUID) - ID —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**

```json
{
  "success": true,
  "message": "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–º–µ—á–µ–Ω–æ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ"
}
```

**–û—à–∏–±–∫–∞ (404):**

```json
{
  "success": false,
  "message": "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
}
```

#### –û—Ç–º–µ—Ç–∏—Ç—å –≤—Å–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ

**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `PUT /api/notifications/read-all`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: –î–∞
- –ú–µ—Ç–æ–¥: `PUT`

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**

```json
{
  "success": true,
  "message": "–û—Ç–º–µ—á–µ–Ω–æ 5 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö",
  "data": {
    "updated": 5
  }
}
```

#### –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `GET /api/notifications/unread-count`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è: –î–∞
- –ú–µ—Ç–æ–¥: `GET`

**–£—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç (200):**

```json
{
  "success": true,
  "data": {
    "unreadCount": 3
  }
}
```

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (Flutter):**

```dart
Future<List<Map<String, dynamic>>> getNotifications({
  int page = 1,
  int limit = 20,
  bool? read,
}) async {
  final token = await getToken();
  final queryParams = {
    'page': page.toString(),
    'limit': limit.toString(),
    if (read != null) 'read': read.toString(),
  };
  
  final uri = Uri.parse('$baseUrl/notifications').replace(
    queryParameters: queryParams,
  );
  
  final response = await http.get(
    uri,
    headers: {
      'Authorization': 'Bearer $token',
    },
  );
  
  if (response.statusCode == 200) {
    final data = jsonDecode(response.body);
    return List<Map<String, dynamic>>.from(data['data']['notifications']);
  } else {
    throw Exception('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: ${response.body}');
  }
}

Future<void> markNotificationAsRead(String notificationId) async {
  final token = await getToken();
  final response = await http.put(
    Uri.parse('$baseUrl/notifications/$notificationId/read'),
    headers: {
      'Authorization': 'Bearer $token',
    },
  );
  
  if (response.statusCode != 200) {
    throw Exception('–û—à–∏–±–∫–∞ –æ—Ç–º–µ—Ç–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: ${response.body}');
  }
}

Future<void> markAllNotificationsAsRead() async {
  final token = await getToken();
  final response = await http.put(
    Uri.parse('$baseUrl/notifications/read-all'),
    headers: {
      'Authorization': 'Bearer $token',
    },
  );
  
  if (response.statusCode != 200) {
    throw Exception('–û—à–∏–±–∫–∞ –æ—Ç–º–µ—Ç–∫–∏ –≤—Å–µ—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: ${response.body}');
  }
}

Future<int> getUnreadCount() async {
  final token = await getToken();
  final response = await http.get(
    Uri.parse('$baseUrl/notifications/unread-count'),
    headers: {
      'Authorization': 'Bearer $token',
    },
  );
  
  if (response.statusCode == 200) {
    final data = jsonDecode(response.body);
    return data['data']['unreadCount'] as int;
  } else {
    throw Exception('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: ${response.body}');
  }
}
```

**–í–∞–∂–Ω–æ:**
- –í—Å–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–∞–∂–µ –µ—Å–ª–∏ FCM –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å (–¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏)
- –ü–æ–ª–µ `data` —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ (type, requestId –∏ —Ç.–¥.)
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è (–Ω–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

#### FCM —Ç–æ–∫–µ–Ω—ã

- FCM —Ç–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–æ–ª–µ `fcm_token` —Ç–∞–±–ª–∏—Ü—ã `users`
- –¢–æ–∫–µ–Ω—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ `PUT /api/users/:id`
- –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è (–≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)

#### –û—Ç–ø—Ä–∞–≤–∫–∞ –±–∞—Ç—á–∞–º–∏

- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –±–∞—Ç—á–∞–º–∏ –ø–æ **500 —Ç–æ–∫–µ–Ω–æ–≤** (–ª–∏–º–∏—Ç FCM)
- –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- **–î–ª—è —Ä—É—á–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ (`POST /api/notifications/send`):**
  - –ï—Å–ª–∏ **–Ω–∏ –æ–¥–Ω–æ** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–æ—Å—å, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ **400** (–Ω–µ 200)
  - –í –æ—Ç–≤–µ—Ç–µ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏—á–∏–Ω–µ –æ—à–∏–±–∫–∏ –≤ –ø–æ–ª–µ `reason`:
    - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ –ë–î - —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∏—Ö ID
    - –ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ—Ç FCM —Ç–æ–∫–µ–Ω–æ–≤ - —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ —Ç–æ–∫–µ–Ω–æ–≤
    - –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω—ã –Ω–µ–≤–∞–ª–∏–¥–Ω—ã - —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–æ–¥—ã –æ—à–∏–±–æ–∫ FCM (–Ω–∞–ø—Ä–∏–º–µ—Ä: `messaging/invalid-registration-token`)
  - –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∏–ª–æ—Å—å —É—Å–ø–µ—à–Ω–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `200` —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∏ –Ω–µ—É–¥–∞—á–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

- **–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**
  - –í—Å–µ –æ—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å
  - –ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç FCM —Ç–æ–∫–µ–Ω–∞, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
  - –ù–µ–≤–∞–ª–∏–¥–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ—á–∏—Å—Ç–∫–∏

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–æ–≤

–ü—Ä–∏ —Ä—É—á–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
1. –°—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ –ë–î
2. –ï—Å—Ç—å –ª–∏ —É –Ω–∏—Ö FCM —Ç–æ–∫–µ–Ω—ã
3. –í–∞–ª–∏–¥–Ω—ã –ª–∏ —Ç–æ–∫–µ–Ω—ã –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —á–µ—Ä–µ–∑ FCM

–ï—Å–ª–∏ —Ç–æ–∫–µ–Ω—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–ª–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã, –≤ –æ—Ç–≤–µ—Ç–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ª—É—á–∞—è.

#### Deeplink —Ñ–æ—Ä–º–∞—Ç

–í—Å–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç deeplink –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É:

```
https://garbagedev-9c240.web.app/request/{category_path}/{request_id}
```

–ì–¥–µ `category_path`:
- `waste_location` - –¥–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `wasteLocation`
- `speed_cleanup` - –¥–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `speedCleanup`
- `event` - –¥–ª—è –∑–∞—è–≤–æ–∫ —Ç–∏–ø–∞ `event`

#### –†–∞–¥–∏—É—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤ —Ä–∞–¥–∏—É—Å–µ **10 –∫–º**
- –†–∞–¥–∏—É—Å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ Haversine (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –ø–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –ó–µ–º–ª–∏)
- –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (`latitude`, `longitude`)

### –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:** –í—Å–µ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Ç–≤–µ—Ç—ã API
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å–∞–º–æ–º—É —Å–µ–±–µ (—Å–æ–∑–¥–∞—Ç–µ–ª—å –∑–∞—è–≤–∫–∏ –Ω–µ –ø–æ–ª—É—á–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–≤–æ–µ–º –¥–æ–Ω–∞—Ç–µ/–ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏)
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–æ–∫–µ–Ω–æ–≤:** –ï—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç FCM —Ç–æ–∫–µ–Ω–∞, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
5. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Ç—ã—Å—è—á–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

---

## üì± –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è Flutter

### –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API

```dart
import 'dart:convert';
import 'package:http/http.dart' as http;
import 'package:flutter_secure_storage/flutter_secure_storage.dart';

class ApiService {
  final String baseUrl = 'https://danilagames.ru/api';
  final FlutterSecureStorage _storage = FlutterSecureStorage();

  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
  Future<String?> getToken() async {
    return await _storage.read(key: 'auth_token');
  }

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
  Future<void> saveToken(String token) async {
    await _storage.write(key: 'auth_token', value: token);
  }

  // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
  Future<void> deleteToken() async {
    await _storage.delete(key: 'auth_token');
  }

  // –ë–∞–∑–æ–≤—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
  Future<Map<String, dynamic>> _request(
    String method,
    String endpoint, {
    Map<String, dynamic>? body,
    bool requiresAuth = false,
  }) async {
    final uri = Uri.parse('$baseUrl$endpoint');
    final headers = {
      'Content-Type': 'application/json',
    };

    if (requiresAuth) {
      final token = await getToken();
      if (token != null) {
        headers['Authorization'] = 'Bearer $token';
      }
    }

    http.Response response;
    switch (method.toUpperCase()) {
      case 'GET':
        response = await http.get(uri, headers: headers);
        break;
      case 'POST':
        response = await http.post(
          uri,
          headers: headers,
          body: body != null ? jsonEncode(body) : null,
        );
        break;
      case 'PUT':
        response = await http.put(
          uri,
          headers: headers,
          body: body != null ? jsonEncode(body) : null,
        );
        break;
      case 'DELETE':
        response = await http.delete(uri, headers: headers);
        break;
      default:
        throw Exception('Unsupported method: $method');
    }

    final data = jsonDecode(response.body);
    
    if (response.statusCode >= 200 && response.statusCode < 300) {
      return data;
    } else {
      throw Exception(data['message'] ?? '–û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞');
    }
  }

  // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
  Future<Map<String, dynamic>> register({
    required String email,
    required String password,
    String? display_name,
  }) async {
    final response = await _request('POST', '/auth/register', body: {
      'email': email,
      'password': password,
      'display_name': display_name,
    });
    
    if (response['success'] == true) {
      final token = response['data']['token'];
      await saveToken(token);
    }
    
    return response;
  }

  // –í—Ö–æ–¥
  Future<Map<String, dynamic>> login({
    required String email,
    required String password,
  }) async {
    final response = await _request('POST', '/auth/login', body: {
      'email': email,
      'password': password,
    });
    
    if (response['success'] == true) {
      final token = response['data']['token'];
      await saveToken(token);
    }
    
    return response;
  }

  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  Future<Map<String, dynamic>> getCurrentUser() async {
    return await _request('GET', '/auth/me', requiresAuth: true);
  }

  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞—è–≤–æ–∫
  Future<Map<String, dynamic>> getRequests({
    int page = 1,
    int limit = 20,
    String? category,
    String? city,
    double? latitude,
    double? longitude,
    int? radius,
  }) async {
    final queryParams = <String, String>{
      'page': page.toString(),
      'limit': limit.toString(),
    };
    
    if (category != null) queryParams['category'] = category;
    if (city != null) queryParams['city'] = city;
    if (latitude != null) queryParams['latitude'] = latitude.toString();
    if (longitude != null) queryParams['longitude'] = longitude.toString();
    if (radius != null) queryParams['radius'] = radius.toString();

    final queryString = Uri(queryParameters: queryParams).query;
    return await _request('GET', '/requests?$queryString');
  }

  // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
  Future<Map<String, dynamic>> createRequest({
    required String category,
    required String name,
    String? description,
    double? latitude,
    double? longitude,
    String? city,
    List<String>? photos,
    List<String>? waste_types,
  }) async {
    return await _request('POST', '/requests', body: {
      'category': category,
      'name': name,
      'description': description,
      'latitude': latitude,
      'longitude': longitude,
      'city': city,
      'photos': photos ?? [],
      'waste_types': waste_types ?? [],
    }, requiresAuth: true);
  }

  // –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ –∑–∞—è–≤–∫–µ
  Future<Map<String, dynamic>> joinRequest(String requestId) async {
    return await _request('POST', '/requests/$requestId/join', requiresAuth: true);
  }

  // –£—á–∞—Å—Ç–∏–µ –≤ —Å–æ–±—ã—Ç–∏–∏
  Future<Map<String, dynamic>> participateInEvent(String requestId) async {
    return await _request('POST', '/requests/$requestId/participate', requiresAuth: true);
  }

  // –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–Ω–∞—Ç–∞
  Future<Map<String, dynamic>> createDonation({
    required String requestId,
    required int amount,
    required String paymentIntentId,
  }) async {
    return await _request('POST', '/donations', body: {
      'requestId': requestId,
      'amount': amount,
      'paymentIntentId': paymentIntentId,
    }, requiresAuth: true);
  }
}
```

---

## ‚è∞ Cron –∑–∞–¥–∞—á–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

Cron –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `node-cron` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å—Ç–∞—Ç—É—Å –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –∑–∞–¥–∞—á–∏ –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ API.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ cron –∑–∞–¥–∞—á

**GET** `/api/cron/status`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "status": "running",
    "isRunning": true,
    "lastRun": "2025-11-28T14:11:20.278Z",
    "hoursSinceLastRun": 0.5,
    "lastRunInfo": {
      "lastRun": "2025-11-28T14:11:20.278Z",
      "results": {
        "autoCompleteSpeedCleanup": {
          "processed": 0,
          "errors": 0
        }
      },
      "status": "success"
    },
    "fileExists": true,
    "message": "Cron –∑–∞–¥–∞—á–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ"
  }
}
```

**–°—Ç–∞—Ç—É—Å—ã:**
- `running` - –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—É—Å–∫ –±—ã–ª –º–µ–Ω–µ–µ 2 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥ (cron —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
- `warning` - –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—É—Å–∫ –±—ã–ª 2-24 —á–∞—Å–∞ –Ω–∞–∑–∞–¥ (–≤–æ–∑–º–æ–∂–Ω–æ, cron –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- `stopped` - –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—É—Å–∫ –±—ã–ª –±–æ–ª–µ–µ 24 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥ (cron –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- `never_run` - cron –∑–∞–¥–∞—á–∏ –µ—â–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–ª–∏—Å—å

**–û—à–∏–±–∫–∞ (403):**
```json
{
  "success": false,
  "message": "–î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω"
}
```

---

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ cron –∑–∞–¥–∞—á

**POST** `/api/cron/run`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "message": "Cron –∑–∞–¥–∞—á–∏ –∑–∞–ø—É—â–µ–Ω—ã",
    "note": "–ó–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —á–µ—Ä–µ–∑ /api/cron/status"
  }
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "message": "Cron –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã",
    "results": {
      "autoCompleteSpeedCleanup": {
        "processed": 2,
        "errors": 0,
        "total": 2
      },
      "checkWasteReminders": {
        "processed": 1,
        "errors": 0,
        "total": 1
      },
      "checkExpiredWasteJoins": {
        "processed": 0,
        "errors": 0,
        "total": 0
      },
      "checkEventTimes": {
        "processed": 3,
        "errors": 0,
        "total": 3
      },
      "deleteInactiveRequests": {
        "processed": 0,
        "errors": 0,
        "skipped": true
      }
    }
  }
}
```

**–û—à–∏–±–∫–∞ (500):**
```json
{
  "success": false,
  "message": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ cron –∑–∞–¥–∞—á: [–¥–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏]",
  "error": "[—Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ]",
  "errorName": "Error",
  "stack": "[stack trace]"
}
```

---

### –ü–æ–ª—É—á–µ–Ω–∏–µ –±–ª–∏–∂–∞–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ –∑–∞—è–≤–∫–∞–º

**GET** `/api/cron/actions`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç 10 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏ 10 –±–ª–∏–∂–∞–π—à–∏—Ö –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –ø–æ –∑–∞—è–≤–∫–∞–º.

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "data": {
    "completed": [
      {
        "id": "uuid",
        "action_type": "autoCompleteSpeedCleanup",
        "request_id": "request-uuid",
        "request_category": "speedCleanup",
        "action_description": "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ [id] —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è",
        "status": "completed",
        "executed_at": "2025-12-01T10:30:00.000Z",
        "metadata": {
          "donorCount": 5,
          "coinsAwarded": 1
        }
      },
      {
        "id": "uuid",
        "action_type": "checkWasteReminders",
        "request_id": "request-uuid",
        "request_category": "wasteLocation",
        "action_description": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –¥–ª—è –∑–∞—è–≤–∫–∏ [id]: Connection timeout",
        "status": "error",
        "executed_at": "2025-12-01T10:25:00.000Z",
        "metadata": {
          "error": "Connection timeout",
          "errorName": "Error",
          "errorStack": "Error: Connection timeout\n    at ...",
          "requestId": "request-uuid"
        }
      }
    ],
    "scheduled": [
      {
        "action_type": "autoCompleteSpeedCleanup",
        "request_id": "request-uuid",
        "request_category": "speedCleanup",
        "request_name": "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏",
        "action_description": "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ \"–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏\" —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è",
        "scheduled_at": "2025-12-02T10:30:00.000Z",
        "time_until": 24.0
      },
      {
        "action_type": "checkWasteReminders",
        "request_id": "request-uuid",
        "request_category": "wasteLocation",
        "request_name": "–£–±–æ—Ä–∫–∞ –º—É—Å–æ—Ä–∞",
        "action_description": "–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é –∑–∞—è–≤–∫–∏ \"–£–±–æ—Ä–∫–∞ –º—É—Å–æ—Ä–∞\" –∑–∞ 2 —á–∞—Å–∞ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å—Ä–æ–∫–∞",
        "scheduled_at": "2025-12-01T20:00:00.000Z",
        "time_until": 2.5
      },
      {
        "action_type": "checkEventTimes",
        "request_id": "request-uuid",
        "request_category": "event",
        "request_name": "–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ",
        "action_description": "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º —Å–æ–±—ã—Ç–∏—è \"–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ\" –∑–∞ 24 —á–∞—Å–∞ –¥–æ –Ω–∞—á–∞–ª–∞",
        "scheduled_at": "2025-12-02T12:00:00.000Z",
        "time_until": 25.5
      }
    ],
    "total_completed": 10,
    "total_scheduled": 10
  }
}
```

**–¢–∏–ø—ã –¥–µ–π—Å—Ç–≤–∏–π:**

1. **autoCompleteSpeedCleanup** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ `speedCleanup` –∑–∞—è–≤–æ–∫ —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è
2. **checkWasteReminders** - –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é `wasteLocation` –∑–∞—è–≤–∫–∏ –∑–∞ 2 —á–∞—Å–∞ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å—Ä–æ–∫–∞
3. **checkExpiredWasteJoins** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å—Ä–æ–∫–∞ –¥–ª—è `wasteLocation` –∑–∞—è–≤–æ–∫ (24 —á–∞—Å–∞ –ø–æ—Å–ª–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)
4. **checkEventTimes** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è `event` –∑–∞—è–≤–æ–∫:
   - –ó–∞ 24 —á–∞—Å–∞ –¥–æ –Ω–∞—á–∞–ª–∞
   - –ó–∞ 2 —á–∞—Å–∞ –¥–æ –Ω–∞—á–∞–ª–∞
   - –ù–∞—á–∞–ª–æ —Å–æ–±—ã—Ç–∏—è
5. **deleteInactiveRequests** - —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫ (7 –¥–Ω–µ–π –±–µ–∑ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)

**–ü–æ–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π:**
- `id` - ID –¥–µ–π—Å—Ç–≤–∏—è
- `action_type` - —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—è
- `request_id` - ID –∑–∞—è–≤–∫–∏ (–º–æ–∂–µ—Ç –±—ã—Ç—å null –¥–ª—è –æ–±—â–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π)
- `request_category` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∑–∞—è–≤–∫–∏
- `action_description` - –æ–ø–∏—Å–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
- `status` - —Å—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: `"completed"` –∏–ª–∏ `"error"`
- `executed_at` - –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (ISO 8601)
- `metadata` - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (JSON):
  - –î–ª—è —É—Å–ø–µ—à–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π: `{ donorCount, coinsAwarded, processed, errors, total, ... }`
  - –î–ª—è –æ—à–∏–±–æ–∫: `{ error, errorName, errorStack, requestId }` - **–ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ**

**–ü–æ–ª—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π:**
- `action_type` - —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—è
- `request_id` - ID –∑–∞—è–≤–∫–∏
- `request_category` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∑–∞—è–≤–∫–∏
- `request_name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
- `action_description` - –æ–ø–∏—Å–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
- `scheduled_at` - –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (ISO 8601)
- `time_until` - –≤—Ä–µ–º—è –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–≤ —á–∞—Å–∞—Ö –∏–ª–∏ –¥–Ω—è—Ö, —Å –æ–¥–Ω–∏–º –∑–Ω–∞–∫–æ–º –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π)

**–í–∞–∂–Ω–æ:** –ï—Å–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π (`status: "error"`), –≤ –ø–æ–ª–µ `metadata` —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ:
- `error` - —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
- `errorName` - —Ç–∏–ø –æ—à–∏–±–∫–∏ (Error, TypeError, etc.)
- `errorStack` - –ø–æ–ª–Ω—ã–π stack trace –æ—à–∏–±–∫–∏
- `requestId` - ID –∑–∞—è–≤–∫–∏, –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞

**–û—à–∏–±–∫–∞ (500):**
```json
{
  "success": false,
  "message": "–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–µ–π—Å—Ç–≤–∏–π cron",
  "error": "[—Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ]",
  "errorName": "Error",
  "stack": "[stack trace]"
}
```

---

### –¢–µ–∫—É—â–∏–µ cron –∑–∞–¥–∞—á–∏

1. **autoCompleteSpeedCleanup** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–≤–æ–¥ `speedCleanup` –∑–∞—è–≤–æ–∫ –≤ `completed` —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –ø–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è (`updated_at`)
   - –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–∏–Ω–æ–≤ –¥–æ–Ω–∞—Ç–µ—Ä–∞–º (–ø–æ 1 –∫–æ–∏–Ω—É –∫–∞–∂–¥–æ–º—É)
   - –û—Ç–ø—Ä–∞–≤–∫–∞ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–æ–Ω–∞—Ç–µ—Ä–∞–º
   - –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–Ω–∞—Ç–µ—Ä–æ–≤ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `donations`

2. **checkWasteReminders** - –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é `wasteLocation` –∑–∞—è–≤–∫–∏ –∑–∞ 2 —á–∞—Å–∞ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å—Ä–æ–∫–∞
   - –ù–∞—Ö–æ–¥–∏—Ç –∑–∞—è–≤–∫–∏, –≥–¥–µ `join_date + 22 —á–∞—Å–∞ ‚âà —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è`
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é

3. **checkExpiredWasteJoins** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è `wasteLocation` –∑–∞—è–≤–æ–∫
   - –ù–∞—Ö–æ–¥–∏—Ç –∑–∞—è–≤–∫–∏, –≥–¥–µ `join_date + 24 —á–∞—Å–∞ < —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è`
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é –∏ —Å–æ–∑–¥–∞—Ç–µ–ª—é
   - –ú–µ–Ω—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ `new` –∏ –æ–±–Ω—É–ª—è–µ—Ç `joined_user_id` –∏ `join_date`

4. **checkEventTimes** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ —Å–æ–±—ã—Ç–∏—è –¥–ª—è `event` –∑–∞—è–≤–æ–∫
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∑–∞ 24 —á–∞—Å–∞ –¥–æ –Ω–∞—á–∞–ª–∞ (–≤—Å–µ–º –∏–∑ `registered_participants`)
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∑–∞ 2 —á–∞—Å–∞ –¥–æ –Ω–∞—á–∞–ª–∞ (–≤—Å–µ–º –∏–∑ `registered_participants`)
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–∞—á–∞–ª–µ —Å–æ–±—ã—Ç–∏—è (—Å–æ–∑–¥–∞—Ç–µ–ª—é)

5. **deleteInactiveRequests** - —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫
   - –ù–∞—Ö–æ–¥–∏—Ç –∑–∞—è–≤–∫–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `new`, –≥–¥–µ `created_at + 7 –¥–Ω–µ–π < —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è`
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ–∑–¥–∞—Ç–µ–ª—é –∏ –¥–æ–Ω–∞—Ç–µ—Ä–∞–º
   - –£–¥–∞–ª—è–µ—Ç –∑–∞—è–≤–∫—É –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ø–æ–ª–Ω–æ—á—å (00:00)

**–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `CRON_SCHEDULE` –≤ `.env`:
```env
CRON_SCHEDULE=0 * * * *  # –ö–∞–∂–¥—ã–π —á–∞—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
```

**–ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π:** –í—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `cron_actions` –∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `GET /api/cron/actions`.

---

## –ö–æ–¥—ã –æ—à–∏–±–æ–∫

- `200` - –£—Å–ø–µ—à–Ω–æ
- `201` - –°–æ–∑–¥–∞–Ω–æ
- `400` - –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `403` - –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω
- `404` - –ù–µ –Ω–∞–π–¥–µ–Ω–æ
- `409` - –ö–æ–Ω—Ñ–ª–∏–∫—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
- `500` - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

---

## –§–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫

–í—Å–µ –æ—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –¥–ª—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã.

### –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (400)

```json
{
  "success": false,
  "message": "–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "errors": [
    {
      "msg": "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email",
      "param": "email",
      "location": "body"
    },
    {
      "msg": "–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤",
      "param": "password",
      "location": "body"
    }
  ]
}
```

### –û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (400/500)

```json
{
  "success": false,
  "message": "–û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: Duplicate entry 'user@example.com' for key 'email'",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "errorDetails": {
    "code": "ER_DUP_ENTRY",
    "sqlMessage": "Duplicate entry 'user@example.com' for key 'email'",
    "sql": "INSERT INTO users ...",
    "message": "–ó–∞–ø–∏—Å—å —Å —Ç–∞–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
  }
}
```

### –û–±—â–∞—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (500)

**–í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (NODE_ENV !== 'production'):**
```json
{
  "success": false,
  "message": "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: Cannot read property 'id' of undefined",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "error": "Cannot read property 'id' of undefined",
  "name": "TypeError",
  "errorDetails": {
    "code": undefined,
    "name": "TypeError",
    "sql": null,
    "sqlMessage": null,
    "message": "Cannot read property 'id' of undefined"
  },
  "stack": "TypeError: Cannot read property 'id' of undefined\n    at ..."
}
```

**–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:**
```json
{
  "success": false,
  "message": "–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "error": "Cannot read property 'id' of undefined",
  "name": "TypeError",
  "errorDetails": {
    "message": "–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"
  }
}
```

### –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (401)

```json
{
  "success": false,
  "message": "–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### –û—à–∏–±–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞ (401)

```json
{
  "success": false,
  "message": "–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

–∏–ª–∏

```json
{
  "success": false,
  "message": "–¢–æ–∫–µ–Ω –∏—Å—Ç—ë–∫",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### –û—à–∏–±–∫–∞ 404 (–ú–∞—Ä—à—Ä—É—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω)

```json
{
  "success": false,
  "message": "–ú–∞—Ä—à—Ä—É—Ç POST /api/auth/invalid –Ω–µ –Ω–∞–π–¥–µ–Ω",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª–µ–π –æ—à–∏–±–∫–∏

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `success` | boolean | –í—Å–µ–≥–¥–∞ `false` –¥–ª—è –æ—à–∏–±–æ–∫ |
| `message` | string | –ü–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ |
| `timestamp` | string | ISO 8601 —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏ –æ—à–∏–±–∫–∏ |
| `errors` | array | –ú–∞—Å—Å–∏–≤ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è 400) |
| `errorDetails` | object | –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ (–∫–æ–¥, SQL –∏ —Ç.–¥.) |
| `error` | string | –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏) |
| `name` | string | –¢–∏–ø –æ—à–∏–±–∫–∏ (TypeError, Error –∏ —Ç.–¥.) |
| `stack` | string | Stack trace (—Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏) |

### –ö–æ–¥—ã –æ—à–∏–±–æ–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

| –ö–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | HTTP –∫–æ–¥ |
|-----|----------|----------|
| `ER_DUP_ENTRY` | –î—É–±–ª–∏—Ä—É—é—â–∞—è—Å—è –∑–∞–ø–∏—Å—å (—É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ) | 409 |
| `ER_NO_REFERENCED_ROW_2` | –°—Å—ã–ª–∫–∞ –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å (FOREIGN KEY) | 400 |
| `ER_ROW_IS_REFERENCED_2` | –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å, –µ—Å—Ç—å —Å—Å—ã–ª–∫–∏ | 400 |
| `ER_BAD_FIELD_ERROR` | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –ø–æ–ª–µ –≤ —Ç–∞–±–ª–∏—Ü–µ | 400 |
| `ER_NO_SUCH_TABLE` | –¢–∞–±–ª–∏—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç | 500 |
| `ER_PARSE_ERROR` | –û—à–∏–±–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ SQL | 500 |

### –ü—Ä–∏–º–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –Ω–∞ Flutter

```dart
try {
  final response = await dio.post(
    '$baseUrl/auth/register',
    data: {'email': email, 'password': password},
  );
  
  if (response.data['success'] == true) {
    // –£—Å–ø–µ—Ö
    return response.data['data'];
  } else {
    // –û—à–∏–±–∫–∞
    throw Exception(response.data['message']);
  }
} on DioException catch (e) {
  if (e.response != null) {
    final errorData = e.response!.data;
    
    // –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    if (e.response!.statusCode == 400 && errorData['errors'] != null) {
      final errors = errorData['errors'] as List;
      final errorMessages = errors.map((e) => e['msg']).join(', ');
      throw Exception('–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏: $errorMessages');
    }
    
    // –û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    if (errorData['errorDetails'] != null) {
      final details = errorData['errorDetails'];
      final code = details['code'];
      final sqlMessage = details['sqlMessage'];
      
      if (code == 'ER_DUP_ENTRY') {
        throw Exception('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
      }
      
      // –õ–æ–≥–∏—Ä—É–µ–º –¥–µ—Ç–∞–ª–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
      print('‚ùå DB Error: $code - $sqlMessage');
      throw Exception(errorData['message'] ?? '–û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö');
    }
    
    // –û–±—â–∞—è –æ—à–∏–±–∫–∞
    throw Exception(errorData['message'] ?? '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞');
  } else {
    throw Exception('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: ${e.message}');
  }
}
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:

```
‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ER_BAD_FIELD_ERROR: Unknown column 'email_verified' in 'field list'
‚ùå Stack trace: Error: ER_BAD_FIELD_ERROR: Unknown column 'email_verified' in 'field list'
    at PoolConnection.query ...
```

–≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –±—ã—Å—Ç—Ä–æ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ.

---

## üè• –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–µ—Ä–∞

### –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞

**GET** `/health`

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

### –°—Ç–∞—Ç—É—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**GET** `/api/health/db`

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "database": "connected",
  "databaseVersion": "8.0.0"
}
```

**–û—à–∏–±–∫–∞ (500):**
```json
{
  "success": false,
  "database": "disconnected",
  "error": "Error message"
}
```

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Email

–î–ª—è —Ä–∞–±–æ—Ç—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ email –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É email. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ —Å–ø–æ—Å–æ–±—ã:

### –°–ø–æ—Å–æ–± 1: SMTP (Gmail, Outlook, Yandex –∏ —Ç.–¥.)

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:
```env
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
EMAIL_FROM=your-email@gmail.com
APP_NAME=Joy Pick
```

**–î–ª—è Gmail:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "–ü–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è" –≤–º–µ—Å—Ç–æ –æ–±—ã—á–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è
- –í–∫–ª—é—á–∏—Ç–µ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- –°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: https://myaccount.google.com/apppasswords

### –°–ø–æ—Å–æ–± 2: Gmail OAuth2

```env
GMAIL_USER=your-email@gmail.com
GMAIL_CLIENT_ID=your-client-id
GMAIL_CLIENT_SECRET=your-client-secret
GMAIL_REFRESH_TOKEN=your-refresh-token
EMAIL_FROM=your-email@gmail.com
APP_NAME=Joy Pick
```

### –°–ø–æ—Å–æ–± 3: SendGrid

```env
SENDGRID_API_KEY=your-sendgrid-api-key
EMAIL_FROM=noreply@yourdomain.com
APP_NAME=Joy Pick
```

### –°–ø–æ—Å–æ–± 4: Mailgun

```env
MAILGUN_SMTP_USER=your-mailgun-smtp-user
MAILGUN_SMTP_PASS=your-mailgun-smtp-password
EMAIL_FROM=noreply@yourdomain.com
APP_NAME=Joy Pick
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ï—Å–ª–∏ email –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ –∫–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å–µ —Ä–∞–≤–Ω–æ —Å–º–æ–∂–µ—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è, –Ω–æ `email_verified` –æ—Å—Ç–∞–Ω–µ—Ç—Å—è `false`.

---

---

## üí¨ Real-time API (Server-Sent Events)

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

**–í–∞–∂–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—Ç –∂–µ –¥–æ–º–µ–Ω, —á—Ç–æ –∏ –¥–ª—è HTTP API, –ë–ï–ó —É–∫–∞–∑–∞–Ω–∏—è –ø–æ—Ä—Ç–∞!

- **Production URL:** `https://danilagames.ru` –∏–ª–∏ `https://autogie1.bget.ru`
- **Development URL:** `http://localhost:3000` (—Ç–æ–ª—å–∫–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ö–ª–∏–µ–Ω—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ–ª–≥–∏–π HTTP GET –∑–∞–ø—Ä–æ—Å –∫ `/api/chats/:chatId/events`
- –°–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è —á–µ—Ä–µ–∑ SSE –ø–æ—Ç–æ–∫ (–æ–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ: —Å–µ—Ä–≤–µ—Ä ‚Üí –∫–ª–∏–µ–Ω—Ç)
- –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—ã—á–Ω—ã–π POST –∑–∞–ø—Ä–æ—Å –∫ `/api/chats/:chatId/messages`

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

JWT —Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>` (–∫–∞–∫ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤).

### Endpoint –¥–ª—è SSE –ø–æ—Ç–æ–∫–∞

**GET** `/api/chats/:chatId/events`

–û—Ç–∫—Ä—ã–≤–∞–µ—Ç Server-Sent Events (SSE) –ø–æ—Ç–æ–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

**–ó–∞–≥–æ–ª–æ–≤–∫–∏:**
```
Authorization: Bearer <jwt_token>
```

**–û—Ç–≤–µ—Ç (200):**
SSE –ø–æ—Ç–æ–∫ —Å —Å–æ–±—ã—Ç–∏—è–º–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
data: {"type":"connected","message":"–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ —á–∞—Ç—É","chatId":"uuid","timestamp":"2024-01-01T00:00:00.000Z"}

data: {"type":"new_message","id":"uuid","chat_id":"uuid","sender_id":"uuid","message":"–¢–µ–∫—Å—Ç","message_type":"text","created_at":"2024-01-01T00:00:00.000Z"}

data: {"type":"message_read","messageId":"uuid","userId":"uuid","readAt":"2024-01-01T00:00:00.000Z"}

data: {"type":"ping","timestamp":"2024-01-01T00:00:00.000Z"}
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è JavaScript/TypeScript:**
```javascript
const eventSource = new EventSource('https://danilagames.ru/api/chats/chat-uuid/events', {
  headers: {
    'Authorization': 'Bearer your_jwt_token'
  }
});

eventSource.onmessage = (event) => {
  const data = JSON.parse(event.data);
  
  if (data.type === 'new_message') {
    console.log('–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:', data.message);
  } else if (data.type === 'message_read') {
    console.log('–°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ:', data.messageId);
  } else if (data.type === 'connected') {
    console.log('–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ —á–∞—Ç—É');
  } else if (data.type === 'ping') {
    // Ping –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
  }
};

eventSource.onerror = (error) => {
  console.error('–û—à–∏–±–∫–∞ SSE:', error);
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è
};
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Flutter/Dart:**
```dart
import 'package:eventsource/eventsource.dart';

// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SSE –ø–æ—Ç–æ–∫—É
final eventSource = EventSource.connect(
  'https://danilagames.ru/api/chats/$chatId/events',
  headers: {
    'Authorization': 'Bearer $jwtToken',
  },
);

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
eventSource.listen((event) {
  final data = jsonDecode(event.data);
  
  if (data['type'] == 'new_message') {
    print('–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: ${data['message']}');
    // –û–±–Ω–æ–≤–∏—Ç—å UI —Å –Ω–æ–≤—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
  } else if (data['type'] == 'message_read') {
    print('–°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ: ${data['messageId']}');
    // –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø—Ä–æ—á—Ç–µ–Ω–∏—è
  } else if (data['type'] == 'connected') {
    print('–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ —á–∞—Ç—É');
  }
});

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
eventSource.onError = (error) {
  print('–û—à–∏–±–∫–∞ SSE: $error');
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è
};
```

**–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (—á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–π POST):**
```dart
// POST /api/chats/:chatId/messages
final response = await http.post(
  Uri.parse('https://danilagames.ru/api/chats/$chatId/messages'),
  headers: {
    'Authorization': 'Bearer $jwtToken',
    'Content-Type': 'application/json',
  },
  body: jsonEncode({
    'message': '–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è',
    'message_type': 'text',
  }),
);
```

### –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π SSE

#### `connected` - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
```json
{
  "type": "connected",
  "message": "–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ —á–∞—Ç—É",
  "chatId": "uuid",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```

#### `new_message` - –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
```json
{
  "type": "new_message",
  "success": true,
  "id": "uuid",
  "chat_id": "uuid",
  "sender_id": "uuid",
  "message": "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è",
  "message_type": "text",
  "created_at": "2024-01-01T00:00:00.000Z",
  "read_by": ["uuid"],
  "unread_by": ["uuid", "uuid"]
}
```
**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í–∫–ª—é—á–∞–µ—Ç –º–∞—Å—Å–∏–≤—ã `read_by` –∏ `unread_by` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ—á—Ç–µ–Ω–∏—è.

#### `message_read` - –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–æ
```json
{
  "type": "message_read",
  "success": true,
  "messageId": "uuid",
  "userId": "uuid",
  "readAt": "2024-01-01T00:00:00.000Z"
}
```

#### `all_messages_read` - –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–º–µ—á–µ–Ω—ã –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ
```json
{
  "type": "all_messages_read",
  "success": true,
  "userId": "uuid",
  "chatId": "uuid",
  "messagesCount": 5,
  "readAt": "2024-01-01T00:00:00.000Z"
}
```
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `POST /chats/:chatId/read` (–ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–∞—Ç–∞).

#### `ping` - –ü–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
```json
{
  "type": "ping",
  "timestamp": "2024-01-01T00:00:00.000Z"
}
```
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

**POST** `/api/chats/:chatId/messages`

–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ –æ–±—ã—á–Ω—ã–π HTTP POST –∑–∞–ø—Ä–æ—Å. –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤—Å–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º —á–µ—Ä–µ–∑ SSE.

**–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
```json
{
  "message": "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è",
  "message_type": "text"
}
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "success": true,
  "message": "–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ",
  "data": {
    "id": "uuid",
    "chat_id": "uuid",
    "sender_id": "uuid",
    "message": "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è",
    "message_type": "text",
    "created_at": "2024-01-01T00:00:00.000Z"
  }
}
```

### –û—Ç–º–µ—Ç–∫–∞ –æ –ø—Ä–æ—á—Ç–µ–Ω–∏–∏

**POST** `/api/chats/:chatId/messages/:messageId/read`

–û—Ç–º–µ—Ç–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ. –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤—Å–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º —á–µ—Ä–µ–∑ SSE.

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "success": true,
  "message": "–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–º–µ—á–µ–Ω–æ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ",
  "data": {
    "messageId": "uuid",
    "userId": "uuid",
    "readAt": "2024-01-01T00:00:00.000Z"
  }
}
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ SSE

- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ª—é–±–æ–º —Ö–æ—Å—Ç–∏–Ω–≥–µ (–≤–∫–ª—é—á–∞—è Beget)
- ‚úÖ –ü—Ä–æ—â–µ, —á–µ–º Socket.io
- ‚úÖ –ú–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤, —á–µ–º long polling
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç WebSocket

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ SSE –ø–æ—Ç–æ–∫—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ–±—ã—á–Ω—ã–π HTTP –æ—Ç–≤–µ—Ç —Å –æ—à–∏–±–∫–æ–π:
```json
{
  "success": false,
  "message": "–ß–∞—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞",
  "error": "–ß–∞—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞"
}
```

**–í–∞–∂–Ω–æ:** –í—Å–µ –æ—à–∏–±–∫–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ. –ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —Ñ–∞–π–ª—ã - –≤—Å–µ –æ—à–∏–±–∫–∏ –≤–∏–¥–Ω—ã –∫–ª–∏–µ–Ω—Ç—É.

---

## üí≥ Stripe Integration

### –û–±–∑–æ—Ä

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ Stripe –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ —á–µ—Ä–µ–∑ API. –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (—Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏) –∏ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—É—é –ª–æ–≥–∏–∫—É.

### –ö–æ–º–∏—Å—Å–∏–∏

- **–ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:** 7% (–≤—ã—á–∏—Ç–∞–µ—Ç—Å—è –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–π —Å—É–º–º—ã)
- **–ö–æ–º–∏—Å—Å–∏—è Stripe:** 10.9% + $0.33 (–≤—ã—á–∏—Ç–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ capture)
- **–í–æ–ª–æ–Ω—Ç—ë—Ä –ø–æ–ª—É—á–∞–µ—Ç:** –ò—Å—Ö–æ–¥–Ω–∞—è —Å—É–º–º–∞ - –ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (7%) - –ö–æ–º–∏—Å—Å–∏—è Stripe (10.9% + $0.33)

**–ü—Ä–∏–º–µ—Ä:** –ü–ª–∞—Ç–µ–∂ $100
- –ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã: $7.00
- –ö–æ–º–∏—Å—Å–∏—è Stripe: $11.23
- –í–æ–ª–æ–Ω—Ç—ë—Ä –ø–æ–ª—É—á–∞–µ—Ç: $81.77

---

### –°–æ–∑–¥–∞–Ω–∏–µ Stripe Express Account

**POST** `/stripe/create-account`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–æ–∑–¥–∞–µ—Ç Express Account –¥–ª—è –≤–æ–ª–æ–Ω—Ç—ë—Ä–∞ —Å –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º Stripe Support.

**Request Body:**
```json
{
  "user_id": "uuid-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
  "email": "user@example.com",
  "first_name": "John",
  "last_name": "Doe",
  "phone": "+1234567890",
  "city": "New York",
  "country": "US"
}
```

**Response (200):**
```json
{
  "success": true,
  "message": "Account created successfully",
  "data": {
    "account_id": "acct_xxxxx",
    "account_link_url": "https://connect.stripe.com/setup/s/xxxxx",
    "message": "Account created successfully"
  }
}
```

**–û—à–∏–±–∫–∞ (400):**
```json
{
  "success": false,
  "message": "–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏",
  "errors": [...]
}
```

**–û—à–∏–±–∫–∞ (500):**
```json
{
  "success": false,
  "message": "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ Stripe –∞–∫–∫–∞—É–Ω—Ç–∞",
  "error": "..."
}
```

**–í–∞–∂–Ω–æ:**
- –ï—Å–ª–∏ –∞–∫–∫–∞—É–Ω—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `account_id` –∏ –Ω–æ–≤—ã–π `account_link_url` –¥–ª—è –¥–æ–æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
- –ï—Å–ª–∏ `country` –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `US`

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Stripe –∞–∫–∫–∞—É–Ω—Ç–∞

**GET** `/stripe/account-status?user_id=<uuid>`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å Stripe –∞–∫–∫–∞—É–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ Stripe API.

**Response (200):**
```json
{
  "success": true,
  "message": "Account status retrieved",
  "data": {
    "account_id": "acct_xxxxx",
    "charges_enabled": true,
    "payouts_enabled": true,
    "details_submitted": true,
    "onboarding_complete": true,
    "account_link_url": "https://connect.stripe.com/setup/s/xxxxx"
  }
}
```

**–ï—Å–ª–∏ –∞–∫–∫–∞—É–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω:**
```json
{
  "success": true,
  "message": "Account status retrieved",
  "data": {
    "account_id": null,
    "charges_enabled": false,
    "payouts_enabled": false,
    "details_submitted": false,
    "onboarding_complete": false
  }
}
```

**–í–∞–∂–Ω–æ:**
- `account_link_url` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `onboarding_complete = false`
- –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏–∑ Stripe API –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ

---

### Webhooks –æ—Ç Stripe

**POST** `/stripe/webhooks`

**–ù–ï —Ç—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏** (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ Stripe)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
Endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è webhooks –æ—Ç Stripe. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è:
- `account.updated` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞
- `payment_intent.succeeded` - —É—Å–ø–µ—à–Ω—ã–π –ø–ª–∞—Ç–µ–∂
- `payment_intent.payment_failed` - –Ω–µ—É–¥–∞—á–Ω—ã–π –ø–ª–∞—Ç–µ–∂
- `transfer.created` - —Å–æ–∑–¥–∞–Ω transfer
- `transfer.paid` - transfer –≤—ã–ø–ª–∞—á–µ–Ω
- `transfer.failed` - transfer –Ω–µ —É–¥–∞–ª—Å—è

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL/HTTPS:**

Stripe **—Ç—Ä–µ–±—É–µ—Ç HTTPS** –¥–ª—è webhooks –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ. –ù–∞ Beget SSL –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

1. **–í–æ–π–¥–∏—Ç–µ –≤ –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Beget**
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–î–æ–º–µ–Ω—ã" ‚Üí "SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã"**
3. **–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–º–µ–Ω** `danilagames.ru`
4. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç:**
   - –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **Let's Encrypt** (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
   - –ò–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
5. **–í–∫–ª—é—á–∏—Ç–µ "–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTTP ‚Üí HTTPS"** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSL:**
- Webhook URL –≤ Stripe Dashboard –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å: `https://danilagames.ru/api/stripe/webhooks`
- –°–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ Stripe Dashboard:**

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Stripe Dashboard** ‚Üí **Developers** ‚Üí **Webhooks**
2. –ù–∞–∂–º–∏—Ç–µ **"Add endpoint"**
3. –£–∫–∞–∂–∏—Ç–µ URL: `https://danilagames.ru/api/stripe/webhooks`
4. –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏:
   - `account.updated`
   - `payment_intent.succeeded`
   - `payment_intent.payment_failed`
   - `transfer.created`
   - `transfer.paid`
   - `transfer.failed`
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Signing secret** (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `whsec_`)
6. –î–æ–±–∞–≤—å—Ç–µ –≤ `.env` —Ñ–∞–π–ª:
   ```
   STRIPE_WEBHOOK_SECRET=whsec_xxxxx
   ```

**–í–∞–∂–Ω–æ:**
- Webhook secret –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (`STRIPE_WEBHOOK_SECRET`)
- –ü–æ–¥–ø–∏—Å—å webhook –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –í—Å–µ —Å–æ–±—ã—Ç–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏ –æ–±–Ω–æ–≤–ª—è—é—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ endpoint –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ HTTPS

---

## üí∞ –ü–ª–∞—Ç–µ–∂–∏ (Payments)

### –°–æ–∑–¥–∞–Ω–∏–µ –¥–æ–Ω–∞—Ç–∞

**POST** `/payments/create-donation`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–æ–∑–¥–∞–µ—Ç PaymentIntent –¥–ª—è –¥–æ–Ω–∞—Ç–∞ –∫ –∑–∞—è–≤–∫–µ. –°—Ä–µ–¥—Å—Ç–≤–∞ —Ö–æ–ª–¥–∏—Ä—É—é—Ç—Å—è –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞—è–≤–∫–∏.

**Request Body:**
```json
{
  "request_id": "uuid-–∑–∞—è–≤–∫–∏",
  "user_id": "uuid-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
  "amount": 10.00,
  "request_category": "event"
}
```

**Response (200):**
```json
{
  "success": true,
  "message": "Payment intent created",
  "data": {
    "payment_intent_id": "pi_xxxxx",
    "client_secret": "pi_xxxxx_secret_xxxxx",
    "message": "Payment intent created"
  }
}
```

**–û—à–∏–±–∫–∞ (400):**
```json
{
  "success": false,
  "message": "–û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏",
  "errors": [...]
}
```

**–í–∞–∂–Ω–æ:**
- –ú–∏–Ω–∏–º—É–º 50 —Ü–µ–Ω—Ç–æ–≤ (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ Stripe)
- `client_secret` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è PaymentSheet –≤ –º–æ–±–∏–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- PaymentIntent —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å `capture_method: manual` (—Å—Ä–µ–¥—Å—Ç–≤–∞ —Ö–æ–ª–¥–∏—Ä—É—é—Ç—Å—è)
- –î–æ–Ω–∞—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `donations`

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏:**
- –û—à–∏–±–∫–∞ 500: "–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ PaymentIntent –¥–ª—è –¥–æ–Ω–∞—Ç–∞" - —Å–º. –¥–µ—Ç–∞–ª–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ "–ê—Ç–æ–º–∞—Ä–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏ —Å –ø–ª–∞—Ç–µ–∂–æ–º"
- –í—Å–µ –æ—à–∏–±–∫–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –ø–æ–ª–µ `errorDetails`
- –ï—Å–ª–∏ `client_secret` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞, –Ω—É–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É

---

### ~~–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –∑–∞ –∑–∞—è–≤–∫—É (cost)~~ [–£–î–ê–õ–ï–ù]

**POST** `/payments/create-request-payment`

**‚ùå –≠–ù–î–ü–û–ò–ù–¢ –£–î–ê–õ–ï–ù**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–≠–Ω–¥–ø–æ–∏–Ω—Ç —É–¥–∞–ª–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö —É–ø—Ä–æ—â–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–ª–∞—Ç–µ–∂–µ–π. –¢–µ–ø–µ—Ä—å –≤—Å–µ –ø–ª–∞—Ç–µ–∂–∏ –∏–¥—É—Ç —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –¥–æ–Ω–∞—Ç—ã.

**–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:**
- `POST /api/payments/create-donation` - –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–Ω–∞—Ç–∞ –æ—Ç –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤–∫–ª—é—á–∞—è —Å–æ–∑–¥–∞—Ç–µ–ª—è –∑–∞—è–≤–∫–∏)

**Response (410 Gone):**
```json
{
  "success": false,
  "message": "–≠–Ω–¥–ø–æ–∏–Ω—Ç —É–¥–∞–ª–µ–Ω. –ü–ª–∞—Ç–Ω—ã–µ –∑–∞—è–≤–∫–∏ –±–æ–ª—å—à–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ POST /api/payments/create-donation –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–Ω–∞—Ç–∞ –æ—Ç —Å–æ–∑–¥–∞—Ç–µ–ª—è –∑–∞—è–≤–∫–∏.",
  "statusCode": 410
}
```

---

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ –∏ –≤—ã–ø–ª–∞—Ç–∞ –≤–æ–ª–æ–Ω—Ç—ë—Ä—É

**POST** `/payments/complete-request`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–í—ã–ø–æ–ª–Ω—è–µ—Ç capture –≤—Å–µ—Ö PaymentIntent –∏ —Å–æ–∑–¥–∞–µ—Ç transfer –≤–æ–ª–æ–Ω—Ç—ë—Ä—É. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∏—Å—Å–∏–∏ –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Å—Ä–µ–¥—Å—Ç–≤–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é.

**Request Body:**
```json
{
  "request_id": "uuid-–∑–∞—è–≤–∫–∏",
  "performer_user_id": "uuid-–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è"
}
```

**Response (200):**
```json
{
  "success": true,
  "message": "Request completed and transfer created",
  "data": {
    "captured_payment_intents": ["pi_xxxxx", "pi_yyyyy"],
    "transfer_id": "tr_xxxxx",
    "transfer_amount_cents": 8177,
    "platform_fee_cents": 700,
    "stripe_fee_cents": 1123,
    "message": "Request completed and transfer created"
  }
}
```

**–û—à–∏–±–∫–∞ (404):**
```json
{
  "success": false,
  "message": "Stripe –∞–∫–∫–∞—É–Ω—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω"
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ PaymentIntent –¥–ª—è –∑–∞—è–≤–∫–∏ (—Ç–æ–ª—å–∫–æ –¥–æ–Ω–∞—Ç—ã)
2. –í—ã–ø–æ–ª–Ω—è–µ—Ç capture –≤—Å–µ—Ö PaymentIntent
3. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å—É–º–º—É –¥–ª—è transfer:
   - `total_amount = sum(donations)` (–≤–∫–ª—é—á–∞—è –¥–æ–Ω–∞—Ç —Å–æ–∑–¥–∞—Ç–µ–ª—è, –µ—Å–ª–∏ –æ–Ω –¥–µ–ª–∞–ª)
   - `platform_fee = total_amount * 0.07`
   - `stripe_fee = (total_amount * 0.109) + 33`
   - `transfer_amount = total_amount - platform_fee - stripe_fee`
4. –°–æ–∑–¥–∞–µ—Ç Transfer –≤ Stripe –Ω–∞ –∞–∫–∫–∞—É–Ω—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
5. –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –Ω–∞ `archived`

**–í–∞–∂–Ω–æ:**
- –ï—Å–ª–∏ capture –Ω–µ —É–¥–∞–ª—Å—è –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö PaymentIntent, –æ–Ω–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ `capture_errors`
- –ó–∞—è–≤–∫–∞ –≤—Å–µ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö Stripe
- Transfer —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –µ—Å—Ç—å Stripe –∞–∫–∫–∞—É–Ω—Ç

---

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π

**GET** `/payments/history?user_id=<uuid>&page=1&limit=20`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–æ–Ω–∞—Ç—ã –∏ –ø–ª–∞—Ç–µ–∂–∏ –∑–∞ –∑–∞—è–≤–∫–∏).

**Response (200):**
```json
{
  "success": true,
  "message": "Payment history retrieved",
  "data": {
    "payments": [
      {
        "id": "pi_xxxxx",
        "type": "donation",
        "amount": 10.00,
        "status": "succeeded",
        "request_id": "uuid-–∑–∞—è–≤–∫–∏",
        "request_name": "Clean up park",
        "created_at": "2024-01-15T10:30:00.000Z"
      }
    ],
    "total": 50,
    "page": 1,
    "limit": 20
  }
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `user_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `page` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1) - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `limit` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20, –º–∞–∫—Å–∏–º—É–º 100) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

---

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –≤—ã–ø–ª–∞—Ç

**GET** `/payments/payouts?user_id=<uuid>&page=1&limit=20`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –≤—ã–ø–ª–∞—Ç –≤–æ–ª–æ–Ω—Ç—ë—Ä—É (transfers).

**Response (200):**
```json
{
  "success": true,
  "message": "Payout history retrieved",
  "data": {
    "payouts": [
      {
        "id": "tr_xxxxx",
        "amount_cents": 8177,
        "status": "paid",
        "request_id": "uuid-–∑–∞—è–≤–∫–∏",
        "request_name": "Clean up park",
        "platform_fee_cents": 700,
        "stripe_fee_cents": 1123,
        "created_at": "2024-01-15T10:30:00.000Z"
      }
    ],
    "total": 10,
    "page": 1,
    "limit": 20
  }
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `user_id` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `page` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1) - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `limit` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20, –º–∞–∫—Å–∏–º—É–º 100) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

**–°—Ç–∞—Ç—É—Å—ã transfer:**
- `pending` - –æ–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `paid` - –≤—ã–ø–ª–∞—á–µ–Ω
- `failed` - –Ω–µ —É–¥–∞–ª—Å—è
- `canceled` - –æ—Ç–º–µ–Ω–µ–Ω

---

## Stripe Admin API

**–¢—Ä–µ–±—É–µ—Ç —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω—Å–∫–∏—Ö –ø—Ä–∞–≤**

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫ —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏

**GET** `/stripe-admin/requests/active`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫ (new, inProgress, pending), –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –ø–ª–∞—Ç–Ω—ã–º–∏ –∏–ª–∏ –∏–º–µ—é—Ç –¥–æ–Ω–∞—Ç—ã.

**Response (200):**
```json
{
  "success": true,
  "data": {
    "requests": [
      {
        "id": "uuid-–∑–∞—è–≤–∫–∏",
        "name": "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏",
        "category": "wasteLocation",
        "status": "inProgress",
        "created_at": "2024-01-15T10:30:00.000Z",
        "updated_at": "2024-01-15T12:30:00.000Z",
        "donations": [
          {
            "user_id": "uuid-—Å–æ–∑–¥–∞—Ç–µ–ª—è",
            "email": "creator@example.com",
            "name": "–ò–º—è —Å–æ–∑–¥–∞—Ç–µ–ª—è",
            "amount": 50.00,
            "payment_intent_id": "pi_xxxxx",
            "stripe_status": "succeeded",
            "capture_method": "automatic",
            "amount_captured": 50.00,
            "amount_received": 50.00,
            "is_captured": true
          },
          {
            "user_id": "uuid-–¥–æ–Ω–∞—Ç–µ—Ä–∞",
            "email": "donor@example.com",
            "name": "–ò–º—è –¥–æ–Ω–∞—Ç–µ—Ä–∞",
            "amount": 25.00,
            "payment_intent_id": "pi_yyyyy",
            "stripe_status": "succeeded",
            "capture_method": "automatic",
            "amount_captured": 25.00,
            "amount_received": 25.00,
            "is_captured": true
          }
        ],
        "donations_count": 2,
        "total_donations": 75.00
      }
    ],
    "total": 1
  }
}
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç—ã—Ö/–∞—Ä—Ö–∏–≤–Ω—ã—Ö –∑–∞—è–≤–æ–∫ —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏

**GET** `/stripe-admin/requests/closed`

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–∞–∫—Ä—ã—Ç—ã—Ö –∑–∞—è–≤–æ–∫ (approved, rejected, completed), –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –ø–ª–∞—Ç–Ω—ã–º–∏ –∏–ª–∏ –∏–º–µ—é—Ç –¥–æ–Ω–∞—Ç—ã.

**Response (200):**
```json
{
  "success": true,
  "data": {
    "requests": [
      {
        "id": "uuid-–∑–∞—è–≤–∫–∏",
        "name": "–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏",
        "category": "wasteLocation",
        "status": "completed",
        "created_at": "2024-01-15T10:30:00.000Z",
        "updated_at": "2024-01-15T16:30:00.000Z",
        "donations": [
          {
            "user_id": "uuid-—Å–æ–∑–¥–∞—Ç–µ–ª—è",
            "email": "creator@example.com",
            "name": "–ò–º—è —Å–æ–∑–¥–∞—Ç–µ–ª—è",
            "amount": 50.00,
            "payment_intent_id": "pi_xxxxx",
            "stripe_status": "succeeded",
            "capture_method": "automatic",
            "amount_captured": 50.00,
            "amount_received": 50.00,
            "is_captured": true
          },
          {
            "user_id": "uuid-–¥–æ–Ω–∞—Ç–µ—Ä–∞",
            "email": "donor@example.com",
            "name": "–ò–º—è –¥–æ–Ω–∞—Ç–µ—Ä–∞",
            "amount": 25.00,
            "payment_intent_id": "pi_yyyyy",
            "stripe_status": "succeeded",
            "capture_method": "automatic",
            "amount_captured": 25.00,
            "amount_received": 25.00,
            "is_captured": true
          }
        ],
        "donations_count": 2,
        "total_donations": 75.00,
        "transfers": [
          {
            "to_user_id": "uuid-–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è",
            "amount": 68.50,
            "transfer_id": "tr_zzzzz",
            "status": "paid",
            "created": 1705316400,
            "error": null
          }
        ],
        "request_balance": 6.50,
        "total_captured": 75.00,
        "total_transferred": 68.50
      }
    ],
    "total": 1
  }
}
```

**–ü–æ–ª—è –æ—Ç–≤–µ—Ç–∞:**
- `donations` - –º–∞—Å—Å–∏–≤ –¥–æ–Ω–∞—Ç–æ–≤ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å—Ç–∞—Ç—É—Å–µ –∑–∞—Ö–≤–∞—Ç–∞ (–≤–∫–ª—é—á–∞—è –¥–æ–Ω–∞—Ç —Å–æ–∑–¥–∞—Ç–µ–ª—è, –µ—Å–ª–∏ –æ–Ω –¥–µ–ª–∞–ª)
- `transfers` - –º–∞—Å—Å–∏–≤ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–∫—Ä—ã—Ç—ã—Ö –∑–∞—è–≤–æ–∫)
- `request_balance` - –æ—Å—Ç–∞—Ç–æ–∫ —Å—Ä–µ–¥—Å—Ç–≤ –ø–æ –∑–∞—è–≤–∫–µ (–∑–∞—Ö–≤–∞—á–µ–Ω–æ - –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–æ)
- `total_captured` - –æ–±—â–∞—è —Å—É–º–º–∞ –∑–∞—Ö–≤–∞—á–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤
- `total_transferred` - –æ–±—â–∞—è —Å—É–º–º–∞ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤

**–°—Ç–∞—Ç—É—Å—ã Stripe:**
- `requires_capture` - —Å—Ä–µ–¥—Å—Ç–≤–∞ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã, –Ω–æ –Ω–µ –∑–∞—Ö–≤–∞—á–µ–Ω—ã
- `succeeded` - —Å—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞—Ö–≤–∞—á–µ–Ω—ã
- `canceled` - –æ—Ç–º–µ–Ω–µ–Ω
- `refunded` - –≤–æ–∑–≤—Ä–∞—â–µ–Ω

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. –í—Å–µ –¥–∞—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO 8601: `2024-01-01T00:00:00.000Z`
2. –°—É–º–º—ã –¥–µ–Ω–µ–≥ –≤ —Ü–µ–Ω—Ç–∞—Ö (1000 = 10.00 USD)
3. –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: `latitude` (—à–∏—Ä–æ—Ç–∞), `longitude` (–¥–æ–ª–≥–æ—Ç–∞)
4. –†–∞–¥–∏—É—Å –ø–æ–∏—Å–∫–∞ –≤ –º–µ—Ç—Ä–∞—Ö
5. –¢–æ–∫–µ–Ω JWT –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 7 –¥–Ω–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
6. –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–∞ –ø–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–π —á–µ—Ä–µ–∑ `/auth/refresh`
7. –ë–∞–∑–æ–≤—ã–π URL: `https://danilagames.ru`
8. **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è email:** –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ (6 —Ü–∏—Ñ—Ä), –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 10 –º–∏–Ω—É—Ç
9. **Real-time —á–∞—Ç—ã:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Server-Sent Events (SSE) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ `GET /api/chats/:chatId/events`

---

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Payout –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–º–∏ –≤—ã–ø–ª–∞—Ç–∞–º–∏

### –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**GET** `/stripe/balance/:user_id`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–π –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –≤—ã–ø–ª–∞—Ç –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö.

**Response (200):**
```json
{
  "success": true,
  "data": {
    "account_id": "acct_xxxxx",
    "payouts_enabled": true,
    "balance": {
      "available": [
        {
          "amount": 5000,
          "amount_dollars": "50.00",
          "currency": "usd"
        }
      ],
      "pending": [
        {
          "amount": 2500,
          "amount_dollars": "25.00", 
          "currency": "usd"
        }
      ]
    },
    "payout_schedule": {
      "interval": "daily",
      "delay_days": 2
    },
    "recent_payouts": [
      {
        "id": "uuid",
        "amount_dollars": "30.00",
        "status": "paid",
        "created_at": "2025-01-22T10:30:00Z"
      }
    ],
    "can_instant_payout": true
  }
}
```

---

### –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –≤—ã–ø–ª–∞—Ç

**GET** `/stripe/payout-methods/:user_id`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ü–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤—ã–ø–ª–∞—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤–∫–ª—é—á–∞—è –±–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Å—á–µ—Ç–∞ –∏ –¥–µ–±–µ—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã.

**Response (200):**
```json
{
  "success": true,
  "data": {
    "account_id": "acct_xxxxx",
    "instant_payout_available": true,
    "payout_settings": {
      "schedule": {
        "interval": "daily",
        "delay_days": 2
      },
      "statement_descriptor": null,
      "debit_negative_balances": false
    },
    "external_accounts": [
      {
        "id": "ba_xxxxx",
        "object": "bank_account",
        "type": "bank_account",
        "last4": "6789",
        "brand": null,
        "bank_name": "STRIPE TEST BANK",
        "currency": "usd",
        "country": "US",
        "default_for_currency": true,
        "status": "verified"
      },
      {
        "id": "card_xxxxx", 
        "object": "card",
        "type": "debit_card",
        "last4": "4242",
        "brand": "visa",
        "bank_name": null,
        "currency": "usd",
        "country": "US",
        "default_for_currency": false,
        "status": "verified"
      }
    ],
    "can_add_debit_card": true,
    "onboarding_complete": true
  }
}
```

---

### –°–æ–∑–¥–∞–Ω–∏–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π –≤—ã–ø–ª–∞—Ç—ã

**POST** `/stripe/instant-payout`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–°–æ–∑–¥–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—É—é –≤—ã–ø–ª–∞—Ç—É –Ω–∞ –¥–µ–±–µ—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É (–ø–æ—Å—Ç—É–ø–∞–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç).

**Request Body:**
```json
{
  "user_id": "uuid-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
  "amount": 50.00,
  "external_account_id": "card_xxxxx"
}
```

**Response (200):**
```json
{
  "success": true,
  "message": "Instant payout created successfully",
  "data": {
    "payout_id": "po_xxxxx",
    "amount_cents": 5000,
    "amount_dollars": "50.00",
    "status": "in_transit",
    "arrival_date": 1737123456,
    "method": "instant",
    "external_account_id": "card_xxxxx"
  }
}
```

**–í–∞–∂–Ω–æ:**
- –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è US –¥–µ–±–µ—Ç–æ–≤—ã—Ö –∫–∞—Ä—Ç Visa/MasterCard
- –ö–æ–º–∏—Å—Å–∏—è Stripe: 1.5% –æ—Ç —Å—É–º–º—ã
- –ú–∏–Ω–∏–º—É–º: $1.00, –º–∞–∫—Å–∏–º—É–º –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—Ä—Ç—ã
- –°—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ—Å—Ç—É–ø–∞—é—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç

---

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≤—ã–ø–ª–∞—Ç

**PUT** `/stripe/payout-schedule/:user_id`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**Request Body:**
```json
{
  "interval": "daily",
  "delay_days": 2
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `interval`: `"manual"`, `"daily"`, `"weekly"`, `"monthly"`
- `delay_days`: –æ—Ç 0 –¥–æ 365 –¥–Ω–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã–ø–ª–∞—Ç)

**Response (200):**
```json
{
  "success": true,
  "message": "Payout schedule updated successfully",
  "data": {
    "account_id": "acct_xxxxx",
    "payout_schedule": {
      "interval": "daily",
      "delay_days": 2
    }
  }
}
```

---

### –ò—Å—Ç–æ—Ä–∏—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö –≤—ã–ø–ª–∞—Ç

**GET** `/stripe/instant-payouts/:user_id`

**–¢—Ä–µ–±—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `page` - –Ω–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
- `limit` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 20, –º–∞–∫—Å–∏–º—É–º 100)

**Response (200):**
```json
{
  "success": true,
  "data": {
    "payouts": [
      {
        "id": "uuid",
        "payout_id": "po_xxxxx",
        "amount_cents": 5000,
        "amount_dollars": "50.00",
        "currency": "usd",
        "status": "paid",
        "method": "instant",
        "external_account_id": "card_xxxxx",
        "failure_code": null,
        "failure_message": null,
        "arrival_date": 1737123456,
        "created_at": "2025-01-22T10:30:00Z",
        "stripe_data": {
          "automatic": false,
          "balance_transaction": "txn_xxxxx",
          "description": "Instant payout"
        }
      }
    ],
    "total": 5,
    "page": 1,
    "limit": 20,
    "has_more": false
  }
}
```

**–°—Ç–∞—Ç—É—Å—ã payout:**
- `pending` - –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ
- `in_transit` - –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω, –æ–∂–∏–¥–∞–µ—Ç –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è
- `paid` - —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–ª–∞—á–µ–Ω
- `failed` - –æ—à–∏–±–∫–∞ –≤—ã–ø–ª–∞—Ç—ã
- `canceled` - –æ—Ç–º–µ–Ω–µ–Ω

